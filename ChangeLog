2005-08-15  Martin Baulig  <martin@ximian.com>

	* backends/Debugger.cs
	(DebuggerBackend.TargetExited): Removed this event.
	(DebuggerBackend.DebuggerExitedEvent): New event; this is called
	from Dispose() when everything is disposed.

2005-08-11  Martin Baulig  <martin@ximian.com>

	* backends/remoting/DebuggerClient.cs
	(DebuggerClient.CreateConnection): Register a lease sponsor and
	always renew the lease for another 5 minutes.

2005-08-11  Martin Baulig  <martin@ximian.com>

	* backends/remoting/mono-debugger-remoting.[ch]: Renamed to
	backends/server/remoting.[ch] and include it in the
	libmonodebuggerserver.la.	

2005-08-11  Martin Baulig  <martin@ximian.com>

	* backends/ThreadManager.cs
	(ThreadManager.OnTargetExitedEvent): Call `backend.Dispose()' here.

	* frontend/Interpreter.cs
	(Interpreter.TargetExited): Don't call `backend.Dispose()' here.

	* classes/Threading.cs
	(DebuggerWaitHandle.CurrentThread): Include the pid.

	* backends/server/library.c
	(mono_debugger_server_get_current_pid): New function.

2005-08-11  Martin Baulig  <martin@ximian.com>

	* classes/ProcessStart.cs (DebuggerOptions.IsRemote): New option.

	* frontend/Main.cs
	(CommandLineInterpreter.ParseOption): Added `-remote' option.

	* frontend/Interpreter.cs
	(Interpreter): Make this a MarshalByRefObject.
	(Interpreter.InterpreterEventSink): New protected class; moved all
	the event handling in here.
	(Interpreter.Initialize): Use `DebuggerClient.CreateConnection ()'
	if `options.IsRemote' is set.

	* frontend/ScriptingContext.cs
	(FrameHandle, BacktraceHandle, ProcessHandle, ScriptingContext):
	Make them MarshalByRefObject's.

	* backends/remoting/: New directory.

	* wrapper/Makefile.am: Create `Mono.Debugger.Remoting.Dll' and
	`mdb-server.exe'.	

2005-08-11  Martin Baulig  <martin@ximian.com>

	* backends/mono/MonoLanguageBackend.cs
	(MonoLanguageBackend): Make this a MarshalByRefObject.

	* arch/Architecture_I386.cs
	(Architecture_I386): Make this a MarshalByRefObject.

	* arch/Architecture_X86_64.cs
	(Architecture_X86_64): Make this a MarshalByRefObject.

2005-08-11  Martin Baulig  <martin@ximian.com>

	* classes/SourceBuffer.cs (SourceBuffer): Mark [Serializable].
	* classes/AssemblerMethod.cs (AssemblerLine): Mark [Serializable].
	* classes/ThreadGroup.cs (ThreadGroup): Mark [Serializable].
	* classes/TargetException.cs (TargetException): Mark [Serializable].

	* classes/Module.cs (Module): Make this a MarshalByRefObject.

2005-07-28  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs
	(OperationWrapper.TrampolineHandler): Allow `DelegateInvocation'
	wrappers inside the wrapper.

2005-07-28  Martin Baulig  <martin@ximian.com>

	* interfaces/IMethod.cs (WrapperType): New public enum.
	(IMethod.IsWrapper, IMethod.WrapperAddress): Removed.
	(IMethod.WrapperType): New property.

	* classes/Module.cs
	(Module.DebuggerBackend): New public abstract property.

	* backends/SingleSteppingEngine.cs
	(SingleSteppingEngine.TrampolineHandler): New internal delegate.
	(SingleSteppingEngine.method_has_source): Renamed to `MethodHasSource'
	and made it static and protected.
	(SingleSteppingEngine.do_trampoline): Added `TrampolineHandler'
	argument; this callback tells us whether or not we should enter
	the trampoline.
	(OperationStepBase.CheckTrampoline): Moved here from OperationStep.
	(OperationWrapper): New operation.

2005-07-27  Martin Baulig  <martin@ximian.com>

	* classes/MethodSource.cs (MethodSource.Lookup): Improved this;
	don't check `address >= method_end' anymore since the JIT may put
	code after the `ret' instruction.

2005-07-26  Martin Baulig  <martin@ximian.com>

	Added support for stepping into interncalls and wrappers (like
	delegate invocations, for example).

	* classes/MethodSource.cs
	(MethodSource.Module): New public property.
	(MethodSource.Lookup): Make this work for methods with just one
	single source line.

	* classes/SourceAddress.cs (SourceAddress.Location): This is now
	also supported for dynamic methods.

	* classes/SourceLocation.cs
	(SourceLocation.HasSourceFile): New public property.
	(SourceLocation.SourceBuffer): New public property.
	(SourceLocation.ctor): Added a .ctor taking a `Module', an
	`ISourceBuffer' and an `int' for dynamic methods.

	* backends/Debugger.cs
	(DebuggerBackend.MonoLanguage): Removed.
	(DebuggerBackend.AddLanguage): New public function.
	(DebuggerBackend.Languages): New public property.

	* arch/BfdContainer.cs
	(BfdContainer.AddFile): Call `backend.AddLanguage (bfd)' to
	register the language with the backend.

	* wrapper/mono-debugger-jit-wrapper.h
	(MonoDebuggerInfo): Replaced the `guint8
	**generic_trampoline_code' with `guint8 ***mono_trampoline_code' -
	which is pointing to the new `mono_trampoline_address' array.

	* backends/mono/MonoSymbolFile.cs
	(MonoSymbolFile.AddWrapperEntry): New public method.
	(MonoSymbolFile.WrapperEntry): New private class; deal with
	wrappers here.

	* backends/mono/MonoLanguageBackend.cs
	(MonoDebuggerInfo.GenericTrampolineCode): Replaced with
	`MonoTrampolineCode', which is now pointing to the new
	`mono_trampoline_address' array.

	* backends/ILanguageBackend.cs
	(ILanguageBackend): Implement `IDisposable'.

	* backends/SingleSteppingEngine.cs
	(OperationStep.CheckTrampoline): New protected method; check for
	trampolines here.  We now check in all registered languages for
	trampolines.

	* frontend/ScriptingContext.cs (ScriptingContext.ListSourceCode):
	Support dynamic source locations.

2005-07-26  Martin Baulig  <martin@ximian.com>

	* arch/Architecture_X86_64.cs
	(Architecture_X86_64.GetCallTarget): Added support for the new
	call opcodes.

2005-07-23  Martin Baulig  <martin@ximian.com>

	* frontend/Main.cs (CommandLineInterpreter.ReadInput): Don't use
	readline if we're executing a script.

2005-07-23  Martin Baulig  <martin@ximian.com>

	* glue/mono-debugger-readline.[ch]: Moved to frontend/libedit/.

	* configure.in: Don't check for readline anymore; we now use the
	included libedit.  Only check for termcap.

2005-07-23  Martin Baulig  <martin@ximian.com>

	* frontend/libedit/: Imported libedit from NetBSD 2.0.2.

	* configure.in: Added `termcap.h' and `termcap/termcap.h' checks.

2005-07-23  Martin Baulig  <martin@ximian.com>

	* arch/opcodes/Makefile.am (arch_cflags): Add `-DBFD64' on x86_64.

2005-07-22  Martin Baulig  <martin@ximian.com>

	* backends/mono/MonoLanguageBackend.cs
	(MonoLanguageBackend.GetTrampoline): Implemented.

2005-07-22  Martin Baulig  <martin@ximian.com>

	* backends/ThreadManager.cs
	(ThreadManager.start_wait_thread): Reap all children before exiting.
	(ThreadManager.NextProcessID): New internal property.
	(Process.ctor): Set the process ID on a per-thread manager basis,
	so we start counting at 1 after restarting the target.

2005-07-22  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetNotification.cs
	(ITargetNotification): Remove the `TargetExited' event.

	* backends/SingleSteppingEngine.cs (SingleSteppingEngine.Dispose):
	Don't set `process = null'.

2005-07-21  Martin Baulig  <martin@ximian.com>

	* classes/TargetLocation.cs
	(TargetLocation.Print): New public abstract method; provides a
	human-readable description of the location.

	* frontend/Command.cs
	(Show.ShowLocationCommand): Added `show location' command to
	display the location of an expression.

	* frontend/Expression.cs
	(AddressOfExpression.DoEvaluateVariable): Check whether we
	actually have an address before trying to use it.
	(AddressOfExpression.EvaluateAddress): Allow address-less
	expressions here.

2005-07-21  Martin Baulig  <martin@ximian.com>

	* backends/mono/MonoArrayTypeInfo.cs (MonoArrayTypeInfo.ctor): Use
	`4 x TargetAddressSize' to get proper alignment.

2005-07-19  Martin Baulig  <martin@ximian.com>

	* backends/server/x86-ptrace.c
	(io_thread): Don't abort if we get an EINTR.

2005-07-19  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs (handle_exception): Correctly
	step over exceptions; check all catchpoints, not just the first one.

	* classes/ExceptionCatchPoint.cs
	(ExceptionCatchPoint.CheckBreakpointHit): Call `exception.GetTypeInfo()'
	before trying to create the object.

	* tests/TestException.cs: New tests.
	* tests/mono-debugger.tests/TestException.exp: Added testcase.

	* tests/mdb.exp (mdb_expect_catchpoint): New proc.
	(mdb_expect_exception): New proc.

2005-07-19  Martin Baulig  <martin@ximian.com>

	* backends/server/x86_64-arch.c
	(server_ptrace_call_method_invoke): Correctly marshal the
	parameters.

	* backends/server/i386-arch.c (server_ptrace_call_method_invoke):
	Don't leak memory here.

2005-07-19  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs (Operation): Make this class
	abstract and nest it inside the `SingleSteppingEngine'.
	(SingleSteppingEngine.Operation): We're now an abstract class.
	(SingleSteppingEngine.OperationStepOverBreakpoint): Move the "step
	over breakpoint" code here; clean it up and check for trampolines.
	(SingleSteppingEngine.step_over_breakpoint): Check whether the
	breakpoint is actually enabled.
	(SingleSteppingEngine.DoStep): Moved into `OperationStep.Step()'.
	(OperationType): Removed.

	* backends/StepFrame.cs (StepMode): Added `NativeInstruction',
	`SourceLine' and `NextLine'.

	* backends/BreakpointManager.cs
	(BreakpointManager.LookupBreakpoint): Added `out bool is_enabled'.

	* backends/server/breakpoints.c
	(mono_debugger_breakpoint_info_get_is_enabled): New public function.

2005-07-19  Martin Baulig  <martin@ximian.com>

	* classes/ObjectCache.cs (ObjectCache.Shutdown): New method; this
	is some kind of a "static finalizer", it kills the timer just
	before exiting.

	* backends/Debugger.cs
	(DebuggerBackend.Dispose): Call ObjectCache.Shutdown().	

2005-07-18  Martin Baulig  <martin@ximian.com>

	* frontend/Expression.cs (NumberExpression.Value): Allow `val' to
	be `uint' or `ulong'.

2005-07-18  Martin Baulig  <martin@ximian.com>

	* ThreadManager.cs
	(ThreadManager.Kill): New private method; kill all threads here.
	(ThreadManager.HandleChildEvent): Call Kill() before
	OnTargetExitedEvent().
	(ThreadManager.ctor): Use `DebugFlags.Wait' for the `command_mutex'.

2005-07-15  Chris Toshok  <toshok@ximian.com>

	* classes/StackFrame.cs (Register, Registers, StackFrame):
	subclass from MarshalByRefObject.
	(SimpleStackFrame): make [Serializable]

	* classes/TargetEvent.cs classes/AddressDomain.cs
	classes/MethodBase.cs classes/SourceAddress.cs
	classes/MethodSource.cs classes/ProcessStart,
	classes/Backtrace.cs, classes/SourceInfo.cs,
	backends/mono/MonoObject.cs, backends/mono/MonoType.cs,
	backends/mono/MonoTypeInfo.cs, backends/mono/MonoVariable.cs,
	backends/ThreadManager.cs, backends/Debugger.cs: subclass from
	MarshalByRefObject.

	* classes/TargetAddress: make [Serializable]
	
	* backends/mono/MonoSymbolFile.cs (MonoSymbolFile.Dispose): only
	dispose File if it's non-null.

	* backends/SingleSteppingEngine.cs
	(SingleSteppingEngine.send_target_event): only send the target
	event if the proc != null.

	* backends/Process.cs: subclass from MarshalByRefObject.

2005-07-14  Martin Baulig  <martin@ximian.com>

	* frontend/Expression.cs
	(MemberAccessExpression.ResolveMemberAccess): If `left' resolves
	to a type, use it as a type.

	* backends/mono/MonoClassType.cs: Correctly index the methods and
	static methods if we have a parent class.

	* backends/mono/MonoClassInfo.cs
	(MonoClassInfo.GetParentObject): New internal method.

	* backends/mono/MonoClassObject.cs
	(MonoClassObject.Parent): Implement this again, using
	MonoClassInfo.GetParentObject().	

2005-07-13  Martin Baulig  <martin@ximian.com>

	* backends/server/x86-ptrace.c
	(server_ptrace_finalize): Don't call do_wait() here.
	(server_ptrace_kill): Add error checking; note that this function
	must only be called from the inferior thread, it is in no way
	different from the other ptrace() functions.
	(io_thread): exit on error.

	* backends/ThreadManager.cs (ThreadManager.Kill): Removed.
	(engine_thread_main): Call `the_engine.Kill' on `abort_requested';
	this'll actually kill the target and also make the wait thread
	wake up from waitpid().
	(ThreadManager.Dispose): Don't actually kill any processes here;
	just set the `abort_requested' flag and join the `inferior_thread'
	and the `wait_thread' - after they exited, the target is gone and
	we can Dispose() everything.

2005-07-12  Martin Baulig  <martin@ximian.com>

	* wrapper/Makefile.am: Install the `mono-debugger-mini-wrapper' in
	the same directory than the `Mono.Debugger.dll'
	($(prefix)/lib/mono/1.0).

	* classes/ProcessStart.cs: Assume that the wrapper is in the same
	directory than the Mono.Debugger.dll.

2005-07-07  Chris Toshok  <toshok@ximian.com>

	* configure.in, acinclude.m4: remove the optional nature of the
	readline dep.  you must either have readline or libedit.

2005-07-07  Chris Toshok  <toshok@ximian.com>

	* backends/SingleSteppingEngine.cs: switch a few things from
	referencing the ThreadManager directly.  Also, dispose of the
	Process in our Dispose() method.

	* backends/ThreadManager.cs (Dispose): let's just dispose of the
	BreakpointManager and SingleSteppingEngine while we're at it,
	shall we?

2005-07-07  Chris Toshok  <toshok@ximian.com>

	* backends/native/NativeStructType.cs (NativeStructMember.Handle):
	remove.

	* backends/mono/MonoMember.cs (MonoMember.Handle): remove.

	* interfaces/ITargetStructType.cs (ITargetMemberInfo): Remove the
	abstraction breaking Handle property.

2005-07-07  Chris Toshok  <toshok@ximian.com>

	* backends/mono/MonoLanguageBackend.cs (TryFindImage): Rename
	FindImage to this, return true if loading the assembly was
	successful.

	* backends/Debugger.cs: push anything dealing with Assembly
	loading down into MonoLanguageBackend.

2005-07-06  Chris Toshok  <toshok@ximian.com>

	* backends/Debugger.cs (DebuggerBackend.Dispose): dispose of all
	our ILanguages.

	* backends/mono/MonoLanguageBackend.cs (MonoLanguageBackend): add
	IDisposable implementation, specifically disposing of the
	MonoSymbolFile's, which fixes bug #75201.

	* backends/native/NativeLanguage.cs (NativeLanguage): add
	IDisposable implementation.

	* interfaces/ILanguage.cs (ILanguage): languages must implement
	IDisposable.

2005-07-06  Chris Toshok  <toshok@ximian.com>

	* interfaces/ITargetStructType.cs (ITargetFieldInfo): add
	HasConstValue property and GetConstValue method to fix the build.

2005-07-05  Chris Toshok  <toshok@ximian.com>

	* backends/mono/MonoMember.cs (MonoFieldInfo): add implementations
	of HasConstValue and GetConstValue from ITargetFieldInfo.

	* backends/native/NativeEnumType.cs (NativeEnumType..ctor): use
	the new NativeFieldInfo ctor.

	* backends/native/NativeStructType.cs (NativeFieldInfo): add a new
	ctor for fields that have constant values (right now only used by
	enums), and add the ITargetFieldInfo "HasConstValue" and
	"GetConstValue" implementations.

	* frontend/Style.cs (StyleBase): make interpreter protected.
	(StyleNative.FormatEnumMember): make this code work for both
	native and managed enum types (although the native backend doesn't
	provide the needed hooks as yet.)

2005-07-05  Chris Toshok  <toshok@ximian.com>

	* backends/native/Makefile.am (EXTRA_DIST): add
	NativeEnum{Object,Type}.cs

	* backends/native/NativeEnumObject.cs,
	backends/native/NativeEnumType.cs: barebones native support for
	enumerated types.

	* arch/DwarfReader.cs: add support for enumerator and
	enumeration_type DIE's.

2005-07-05  Chris Toshok  <toshok@ximian.com>

	* backends/mono/MonoArrayTypeInfo.cs: remove unused using.

	* backends/mono/MonoClassInfo.cs: remove the MonoClassType. prefix
	from MonoFieldInfo, MonoMethodInfo, and MonoPropertyInfo.

	* backends/mono/MonoClassType.cs: split out all the
	Member/Field/Property/Event classes from here.

	* backends/mono/MonoMember.cs: and put them here.  Also,
	MonoStructMember -> MonoMember, and make MonoMember not depend on
	a MonoStructType, since it's also used for enums.

	* backends/mono/MonoSymbolFile.cs: return a MonoEnumType if
	type.IsEnum == true.

	* backends/mono/Makefile.am (EXTRA_DIST): add the new Enum files
	and MonoMember.cs.

	* backends/mono/MonoEnumTypeInfo.cs,
	backends/mono/MonoEnumType.cs, backends/mono/MonoEnumObject.cs:
	add new enum support.

2005-07-05  Chris Toshok  <toshok@ximian.com>

	* frontend/Style.cs (StyleNative.FormatObject): add (obj is
	ITargetEnumType) block, which calls FormatEnumType.
	(StyleNative.FormatEnumMember): new function, give both the
	symbolic and numeric value.
	(StyleNative.FormatType): add TargetObjectKind.Enum case.
	(StyleNative.FormatEnumType): just print "enum <etype.Name>"
	(StyleNative.DoFormatObject): add TargetObjectKind.Enum case.

	* interfaces/TargetObjectKind.cs (enum TargetObjectKind): add
	Enum.

	* interfaces/ITargetEnum{Type,Object}.cs: new interfaces for
	enumerated types/objects.

	* interfaces/Makefile.am (EXTRA_DIST): Add
	ITargetEnum{Type,Object}.cs

2005-07-05  Wade Berrier <wberrier@novell.com>

	* DllImport: (merged up r46954)
	Copy what gtk-sharp does for importing glib-2.0:
	- add dllmap to Mono.Debugger.dll.config
	Remove dllmap for monodebuggerderver since it will be located by 
	ldconfig's cache or LD_LIBRARY_PATH

2005-07-01  Chris Toshok  <toshok@ximian.com>

	* backends/classes/Utils.cs: rewrite this to remove the dep on
	g_file_get_contents.

2005-06-28  Chris Toshok  <toshok@ximian.com>

	* backends/mono/MonoFundamentalObjectBase.cs
	(MonoFundamentalObjectBase.SetObject): remove workaround for
	75270.

	* backends/mono/MonoStringObject.cs (MonoStringObject.SetObject):
	remove workaround for 75270.
	
2005-06-25  Chris Toshok  <toshok@ximian.com>

	* frontend/Expression.cs (SimpleNameExpression.DoResolve): use a
	gdb message here since it's a little clearer (and doesn't contain
	a typo, to boot).

	* frontend/Style.cs (StyleNative.DoFormatObject): clean up the
	array formatting a bit so it doesn't look so jammed together.

2005-06-22  Chris Toshok  <toshok@ximian.com>

	* backends/native/Makefile.am (EXTRA_DIST): add NativeArrayType.cs
	/ NativeArrayObject.cs

	* arch/DwarfReader.cs (DwarfReader.DwarfTag): add the rest of the
	DWARF tags.
	(DwarfReader.DwarfInline): add this enum.
	(DwarfReader+LineNumberEngine.GetSource): change the type of the
	first arg to DieSubprogram.
	(DwarfReader+Die.CreateDie): add support for array_type and
	subrange_type.
	(DwarfReader+DieSubrangeType): new class.
	(DwarfReader+DieArrayType): new class.
	(backends/native/NativeArrayType,
	backends/native/NativeArrayObject): add support for native arrays.
	
2005-06-20  Chris Toshok  <toshok@ximian.com>

	* backends/mono/MonoSymbolFile.cs: Add IDisposable interface so we
	can explicitly deallocate things.  Dispose of the
	CompilerServices.MonoSymbolFile in the implementation.

2005-06-20  Chris Toshok  <toshok@ximian.com>

	* backends/mono/MonoStringObject.cs (MonoStringObject.SetObject):
	fix bug #75272 by extending the workaround for #75270.  Cut and
	paste the implementation from MonoObject here, as the empty NYI
	implementation in MonoFundamentalObjectBase (which is the
	workaround for 75270) overrides the MonoObject impl.

2005-06-14  Chris Toshok  <toshok@ximian.com>

	* arch/DwarfReader.cs (DwarfReader.DwarfAttributes): flesh out the
	rest of the attributes from the spec.

2005-06-14  Chris Toshok  <toshok@ximian.com>

	* backends/mono/MonoFundamentalObjectBase.cs
	(MonoFundamentalObjectBase.SetObject): new method, here only as a
	workaround for bug #75270.

	* interfaces/ITargetFundamentalObject.cs
	(ITargetFundamentalObject.SetObject): new method.

	* frontend/Expression.cs (StructAccessExpression.SetStaticField,
	StructAccessExpression.SetField): setters for fields (fundamental
	types only for now.)
	(StructAccessExpression.DoAssign): implement for fields.
	(ArrayAccessExpression.DoAssign): implement for array[int].

2005-06-11  Chris Toshok  <toshok@ximian.com>

	* backends/native/NativeFundamentalObject.cs:
	(NativeFundamentalObject.SetObject): implement using RawContents,
	ala the mono backend.

	* arch/DwarfReader.cs (TargetVariable.CanWrite): return true if
	the variable is of a fundamental type.
	(TargetVariable.SetObject): assuming a fundamental type, set the
	variable.

2005-06-09  Chris Toshok  <toshok@ximian.com>

	* backends/Debugger.cs (DebuggerBackend..ctor): clean up this and
	DoInitialize/Initialize.  There's no need for the complex
	initialization stuff that was here before.  Put it all in the
	.ctor.
	(DebuggerBackend.CreateDebuggerHandler): comment on the awful name
	of this function.

2005-06-09  Chris Toshok  <toshok@ximian.com>

	* frontend/Makefile.am, arch/Makefile.am, interfaces/Makefile.am,
	test/Makefile.am, wrapper/Makefile.am, jay/Makefile.am,
	classes/Makefile.am, Makefile.am, backends/server/Makefile.am,
	backends/mono/Makefile.am: make dist work.

2005-06-09  Chris Toshok  <toshok@ximian.com>

	* classes/TargetBinaryReader.cs (TargetBinaryReader.PeekAddress,
	TargetBinaryReader.ReadAddress): Patch from Hans Kratz
	<kratz@omnicore.com>.  Use unsigned 32 bit numbers for addresses,
	so sign extension doesn't break things when the addresses are >
	2**31.

2005-05-31  Peter Williams  <peter@newton.cx>

	* frontend/CSharpTokenizer.cs (ReadDigit): Return Token.ERROR on
	parse errors to actually get the parse error reported. Add new
	code to parse hex numbers as unsigned ints always; it's illegal to
	try and parse a double with hex digits as we were trying before.

	* configure.in (AC_OUTPUT): Reflect the rename of backends/mono
	from backends/mono-csharp.

	* backends/Makefile.am (SUBDIRS): Same here.

	* frontend/Interpreter.cs (Initialize): Compile fix for removal
	of TargetOutputEvent from ThreadManager

	* frontend/Main.cs (SetupEngine): Add 'k' as an alias for
	'kill' a la gdb.

2005-05-31  Raja R Harinath  <rharinath@novell.com>

	* test/mdb.exp (mdb_start): Find the 'start-mdb.sh' script in
	$srcdir.

	* configure.in (pkg_config_path): Rename from PKG_PATH, so as to
	work with newer versions of pkg-config.
	* frontend/Makefile.am (CSharpExpressionParser.cs): Pick
	'skeleton' from $(srcdir).
	* wrapper/Makefile.am (LANGUAGE_SPECIFIC_FILES): Look for
	CSharpExpressionParser in $(top_builddir).

2005-05-27  Chris Toshok  <toshok@ximian.com>

	* backends/server/breakpoints.c
	(mono_debugger_breakpoint_manager_insert): use GSIZE_TO_POINTER
	instead of GUINT_TO_POINTER.
	(mono_debugger_breakpoint_manager_lookup): same.
	(mono_debugger_breakpoint_manager_lookup_by_id): same.
	(mono_debugger_breakpoint_manager_remove): same.

	* backends/server/i386-arch.c (x86_arch_child_stopped): use
	GPOINTER_TO_SIZE instead of a guint32 cast (which is wrong anyway
	- the function takes a guint64).

	* backends/server/x86_64-arch.c (x86_arch_child_stopped): same.

	* backends/server/x86-ptrace.c (server_ptrace_peek_word): make
	retval gsize* instead of guint64*.
	(server_ptrace_write_memory): use GSIZE_TO_POINTER instead of a
	naked gpointer cast.  Also, in the case of the calls to
	server_ptrace_read_memory, just pass addr uncasted (since the
	method takes a guint64 anyway.  This change thanks to
	peter@newton.cx).

2005-05-27  Chris Toshok  <toshok@ximian.com>

	* backends/ThreadManager.cs: remove some dead code.

2005-05-27  Chris Toshok  <toshok@ximian.com>

	* backends/Process.cs (Process.ReadLongInteger): fix c&p error.
	(Process.ReadAddress): same.
	(Process.ReadGlobalAddress): same.
	
2005-05-23  Martin Baulig  <martin@ximian.com>

	* arch/Architecture_I386.cs (Architecture_I386.unwind_method):
	Consider %esi and %edi as valid if they're not saved.

	* backends/classes/MonoVariableLocation.cs
	(MonoVariableLocation.GetAddress): Check whether a register is
	valid before trying to access it.

2005-05-21  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs
	(SingleSteppingEngine.ProcessChildEvent): Use `arch.UnwindStack()'
	to compute the `main_method_retaddr'.

	* backends/Inferior.cs
	(Inferior.GetBacktrace): Removed; this wasn't used anymore since a
	couple of months.
	(Inferior.GetReturnAddress): Removed.

	* backends/server/library.c
	(mono_debugger_server_get_backtrace): Removed; we don't need this
	anymore since we have the new stack unwinding code.
	(mono_debugger_server_get_ret_address): Removed.

	* backends/server/x86-arch.h (x86_arch_get_frame): Removed.

2005-05-21  Martin Baulig  <martin@ximian.com>

	* arch/Architecture_X86_64.cs: Implemented stack unwinding.

2005-05-17  Chris Toshok  <toshok@ximian.com>

	* backends/SingleSteppingEngine.cs
	(SingleSteppingEngine.check_method_operation): remove unnecessary
	cast.
	(SingleSteppingEngine.CreateStepFrame, both overloads): pass an
	ILanguageBackend.
	

	* backends/StepFrame.cs: all uses of this class pass it valid
	ILanguageBackend's at the proper spot, so make that explicit in
	the ctors and stop casting.

2005-05-17  Chris Toshok  <toshok@ximian.com>

	* arch/DwarfReader.cs: fix the annoying exception about not
	finding DWARF 2 debugging info, and add (ifdefed for now) language
	support.

	* classes/Report.cs (DebugFlags): add DwarfReader.

2005-05-17  Chris Toshok  <toshok@ximian.com>

	* backends/MonoThreadManager.cs: add a few comments, and add
	constants for the thread index magic numbers.

2005-05-17  Chris Toshok  <toshok@ximian.com>

	* backends/ThreadManager.cs: a little cleanup.

2005-05-17  Chris Toshok  <toshok@ximian.com>

	* frontend/Expression.cs (NumberExpression.DoEvaluateVariable):
	throw an exception with a reasonable message instead of returning
	null here (causing a much more cryptic message to be printed.)
	(StringExpression.DoEvaluateVariable): same.
	(BoolExpression.DoEvaluateVariable): same.
	(ConditionalExpression.DoEvaluate,
	ConditionalExpression.DoEvaluateVariable): reindent.

	* frontend/CSharpTokenizer.cs (Tokenizer.InitTokens): add "True"
	and "False" to the list of tokens.

2005-05-13  Martin Baulig  <martin@ximian.com>

	* backends/server/i386-arch.c (x86_arch_child_stopped): Don't
	return 64-bit values; were on 32-bit here.

2005-05-11  Martin Baulig  <martin@ximian.com>

	* classes/TargetAddress.cs (TargetAddress.ctor): Removed the ugly
	trim-to-32-bit hack.

2005-05-11  Martin Baulig  <martin@ximian.com>

	* backends/server/x86-ptrace.c (server_ptrace_peek_word): Make
	this 64-bit safe.

	* backends/server/x86_64-arch.c: Implemented the missing bits.

2005-05-11  Martin Baulig  <martin@ximian.com>

	* wrapper/mono-debugger-jit-wrapper.h
	(MonoDebuggerInfo, MonoDebuggerManager): Changed the order of some
	fields to get proper alignment on 64-bit machines.

	* backends/mono/MonoSymbolFile.cs: Reflect latest JIT changes.
	* backends/mono/MonoLanguageBackend.cs: Likewise.

2005-05-10  Chris Toshok  <toshok@ximian.com>

	* frontend/GnuReadLine.cs: remove the Instance stuff.

	* frontend/Command.cs (RunCommand.DoResolve): if there's no
	executable file specified, error out and tell the user to use the
	"file" command, ala gdb.

2005-05-10  Chris Toshok  <toshok@ximian.com>

	* backends/ThreadManager.cs: track change to SingleSteppingEngine.

	* backends/Process.cs: track StepFrame -> FinishFrame, and use
	#regions instead of header comments for interface implementations.

	* backends/SingleSteppingEngine.cs: general clean-up.  move code
	around, rename some methods to make their purpose more apparent
	(i.e. get rid of some overloads), rename Operation.StepFrame to
	Operation.FinishFrame to make it more apparent what it's doing.

	* glue/mono-debugger-readline.c
	(mono_debugger_readline_static_init): set rl_readline_name and
	rl_terminal_name.

	* interfaces/ITargetMemoryAccess.cs: move ITargetMemoryInfo so
	it's more "in order" with the rest of the file.

2005-05-08  Chris Toshok  <toshok@ximian.com>

	* frontend/Command.cs (EventHandleCommand.DoResolve): allow zero
	arguments.
	(BreakpointEnableCommand.DoExecute): if we have no handle, enable
	all breakpoints/catchpoints.
	(BreakpointDisableCommand.DoExecute): if we have no handle,
	disable all breakpoints/catchpoints.
	(BreakpointDeleteCommand.DoExecute): if we have no handle, delete
	all breakpoints/catchpoints (after prompting the user).
	(BreakCommand.DoExecute): change message printed from "Inserted
	breakpoint..." to "Breakpoint..."

	* frontend/Interpreter.cs (Interpreter.ShowBreakpoints): display
	"No breakpoints or catchpoints." if there are non registered.
	(Interpreter.get_Events): provide a way to get at a list (in this
	case an array) of all breakpoints/catchpoints.  used by the bulk
	disable/enable/delete commands.

	* frontend/Main.cs (CommandLineInterpreter.SetupEngine): add "fin"
	as an alias for "finish".
	(CommandLineInterpreter.ParseOption): fix handling of "-script",
	which shouldn't have an argument.

2005-05-08  Chris Toshok  <toshok@ximian.com>

	* backends/mono/MonoClassObject.cs (MonoClassObject.PrintObjcet):
	fix unitialized use of "func".

	* frontend/Expression.cs
	(MemberAccessExpression.ResolveMemberAccess): try to resolve left
	as a regular expression first, falling back to treating it as a
	type if that fails (reverse the way the code worked previously).
	This allows things like "print foo.a" when you've defined foo as
	"struct foo foo" in C.  This also points out that type names (in C
	at least), should include the "struct ".

2005-05-02  Chris Toshok  <toshok@ximian.com>

	* wrapper/Makefile.am: more mcs quieting.
	
2005-05-02  Chris Toshok  <toshok@ximian.com>

	* classes/TargetAddress.cs: provide Equals/GetHasCode
	implementations to quiet mcs.

2005-05-02  Chris Toshok  <toshok@ximian.com>

	* backends/mono/MonoVariable.cs (MonoVariable.SetObject): Never
	accept rewrites of large portions of functionality without proper
	testing.  Implement this method again so it, oh, I dunno, actually
	*does* something?

	* backends/classes/MonoVariableLocation.cs
	(MonoVariableLocation.WriteBuffer): handle some more interesting
	value-in-register cases: 1. the buffer size is larger than the
	size we can stuff in a register (currently maxed at sizeof(long)?
	ugh.) 2. the buffer size is *smaller* than the TargetIntegerSize,
	as it is with things like booleans.  This makes "set ok = true"
	work while debugging mcs.

2005-05-02  Chris Toshok  <toshok@ximian.com>

	* backends/ThreadManager.cs (ThreadManager.Dispose): fix bug
	disposing of main_process.

2005-05-02  Chris Toshok  <toshok@ximian.com>

	* wrapper/Makefile.am (MCS_FLAGS): use -debug instead of -g, and
	turn off warnings about private things that are never used.

2005-05-02  Chris Toshok  <toshok@ximian.com>

	* frontend/ScriptingContext.cs (FrameHandle.GetRegister): Resolve
	-> GetTypeInfo.

	* frontend/Main.cs (CommandLineInterpreter.SetupEngine): register
	"l" as an alias for "list".

	* frontend/Expression.cs
	(PointerDereferenceExpression.DoEvaluateVariable): remove
	CurrentObject stuff.
	(ArrayAccessExpression.DoEvaluateVariable): Resolve ->
	GetTypeInfo.
	(CastExpression.TryCurrentCast): same.
	(CastExpression.DoEvaluateVariable): fix an error msg.

	* frontend/Command.cs (PrintExpressionCommand.Execute): nuke
	CurrentObject stuff.
	(PrintTypeCommand): nuke CurrentObject stuff.
	(CatchCommand): make sure to get the TypeInfo for the exception
	type.

	* backends/mono/MonoSymbolFile.cs (VariableInfo..ctor): use
	Report.Debug instead of Console.WriteLine.
	(MonoSymbolFile.AddCoreType): Resolve -> GetTypeInfo.

	* backends/mono/MonoLanguageBackend.cs
	(MonoBuiltinTypeInfo..ctor): Resolve -> GetTypeInfo.
	(MonoLanguageBackend.CreateObject): reimplement.

	* backends/mono/MonoType.cs: Resolve -> GetTypeInfo.
	
	* backends/mono/MonoClassInfo.cs (MonoClassInfo.GetField): Resolve
	-> GetTypeInfo.
	(MonoClassInfo.GetStaticField): same.
	(MonoClassInfo.GetMethod): same.

	* backends/mono/MonoArrayType.cs (MonoArrayType.DoGetTypeInfo):
	Resolve -> GetTypeInfo.

	* backends/mono/MonoStringType.cs
	(MonoStringObject.DoGetTypeInfo): Resolve -> GetTypeInfo.

	* backends/mono/MonoObjectType.cs (MonoObjectType.DoGetTypeInfo):
	Resolve -> GetTypeInfo.

	* backends/mono/MonoClassType.cs (MonoClassType.GetStaticField):
	Resolve -> GetTypeInfo.
	(.GetStaticMethod): same.
	(.DoGetTypeInfo): same.
	(MonoMethodInfo.Get): same.
	(MonoPropertyInfo.Get): same.

	* backends/mono/MonoFunctionTypeInfo.cs
	(MonoFunctionTypeInfo.Invoke): Resolve -> GetTypeInfo.

	* backends/mono/MonoFundamentalType.cs
	(MonoFundamentalType.DoGetTypeInfo): Resolve -> GetTypeInfo.

	* backends/mono/MonoObjectObject.cs
	(MonoObjectObject.GetCurrentType): Resolve -> GetTypeInfo.

	* backends/mono/MonoOpaqueType.cs (MonoOpaqueType.DoGetTypeInfo):
	Resolve -> GetTypeInfo.

	* backends/mono/MonoClassObject.cs: nuke .CurrentObject and
	.GetCurrentObject().

	* backends/mono/MonoFunctionType.cs (MonoFunctionType..ctor):
	remove redundant klass assignment.
	(MonoFunctionType.InvokeStatic): Resolve -> GetTypeInfo.
	(MonoFunctionType.DoGetTypeInfo): same.

	* backends/mono/MonoVariable.cs (MonoVariable.GetObject): Resolve
	-> GetTypeInfo.

	* backends/native/NativeType.cs (NativeType.Resolve): rename
	GetTypeInfo.

	* classes/ExceptionCatchPoint.cs
	(ExceptionCatchPoint.CheckBreakpointHit): track removal of
	ITargetClassObject.CurrentObject.

	* interfaces/ITargetType.cs: rename "Resolve" to "GetTypeInfo".
	I'm sick of "Resolve" being used to mean about 50 different things
	in the debugger code.

	* interfaces/ITargetClassObject.cs: remove CurrentObject.  I'll
	put it back in if someone can tell me what the purpose of it was -
	it's broken currently and removing code that uses it fixes the
	problem.

2005-04-27  Chris Toshok  <toshok@ximian.com>

	* classes/Threading.cs: remove the Debugger events - just use the
	stuff in corlib.

	* backends/server/mutex.c: remove the debugger event stuff.

	* backends/server/mutex.h: same.

	* backends/SingleSteppingEngine.cs: track change from Debugger
	events to corlib threading events.

	* backends/ThreadManager.cs: same.

	* classes/SymbolTableManager.cs: same.
	
2005-04-26  Chris Toshok  <toshok@ximian.com>

	* backends/Inferior.cs (Inferior.Dispose): don't call Kill here.

	* backends/ThreadManager.cs (ThreadManager.Dispose): use a
	two-stage method.  first we Kill all the processes, then we
	Dispose of them.

	* backends/SingleSteppingEngine.cs (SingleSteppingEngine.Dispose):
	don't Kill the inferior here, only Dispose of it.

	* backends/server/x86-ptrace.c (server_ptrace_finalize): only kill
	the pid in server_ptrace_kill.  in finalize we do_wait.
	(server_ptrace_kill): PT_KILL here as well, although i'm sure
	that's unnecessary.

	* backends/server/x86-freebsd-ptrace.[ch]: rename
	i386-freebsd-ptrace.[ch].

2005-04-26  Chris Toshok  <toshok@ximian.com>

	[ fixes bug #61196 ]
	* classes/SymbolTableManager.cs: rework the Dispose stuff so that
	it doesn't use Thread.Abort.

	* backends/ThreadManager.cs: same.

2005-04-24  Chris Toshok  <toshok@ximian.com>

	* frontend/Command.cs (SetCommand): override DoResolve and
	DoExecute so we can both handle debugger settings as well as
	expressions representing assignments ("set lang auto" and "set x =
	3", respectively).

2005-04-22  Chris Toshok  <toshok@ximian.com>

	* backends/MonoThreadManager.cs (MonoThreadManager.ThreadCreated):
	fix for use with the new io-layer, which appears to create an
	additional thread at runtime startup.  This change is evil, and
	this code is also evil.  There has to be a better way for the
	debugger to figure out which is the main managed thread.

2005-04-19  Chris Toshok  <toshok@ximian.com>

	* frontend/Command.cs (CdCommand.DoExecute): special handling for
	"." and "..", and use DirectoryInfo to make sure paths exist.
	Fixes bug #73247.

2005-04-19  Chris Toshok  <toshok@ximian.com>

	* frontend/CL.cs (LineParser.GetCommand): change the way commands
	are parsed so that "_" on the line is assumed to be a command
	(which doesn't exist, of course).  Fixes bug #73244.

2005-04-18  Chris Toshok  <toshok@ximian.com>

	* configure.in: fix BFD_TARGET_X86_64 AM_CONDITIONAL.  Thanks to
	Marvin Taylor for this one.

2005-04-13  Chris Toshok  <toshok@ximian.com>

	* backends/mono/MonoLanguageBackend.cs: rather broken fix for
	74391.  call MonoDebuggerInfo.LookupType before looking up the
	type.

2005-04-13  Chris Toshok  <toshok@ximian.com>

	* interfaces/IMethod.cs: Add some docs.

	* interfaces/IArchitecture.cs: same.

2005-04-12  Martin Willemoes Hansen  <mwh@sysrq.dk>

	* autogen.sh: Corrected error messages to print Mono-debugger 
	  instead of Gtk#

2005-04-12  Chris Toshok  <toshok@ximian.com>

	* frontend/Interpreter.cs (Interpreter.ShowModules): clean up the
	module list.

2005-04-11  Chris Toshok  <toshok@ximian.com>

	* backends/Debugger.cs (DebuggerBackend.LoadLibrary): if the
	library we're loading is a managed assembly, call
	mono_language.FindImage on it.

	* backends/mono/MonoLanguageBackend.cs
	(MonoLanguageBackend.get_DebuggerBackend): nuke.
	(MonoLanguageBackend.get_SourceFileFactory): new property.
	(MonoLanguageBackend.FindImage): new function.  actually cause the
	assembly to be loaded by the inferior.
	
	* backends/mono/MonoSymbolFile.cs (MonoMethod.Load): pass the
	SourceFileFactory to MonoMethodSource..ctor instead of the
	DebuggerBackend, since the SourceFileFactory is all that's used
	anyway.
	(MonoMethod.get_DeclaringType): don't return null, return
	decl_type.
	(MonoMethodSource..ctor): take SourceFileFactory instead of
	DebuggerBackend.

2005-04-11  Chris Toshok  <toshok@ximian.com>

	* frontend/Command.cs (EventHandleCommand): split out this
	behavior from BreakpointEnableCommand, since it really annoys me
	to have BreakpointDisableCommand subclassing from
	BreakpointEnableCommand.
	(BreakpointDisableCommand): subclass from EventHandleCommand.
	(BreakpointEnableCommand): same.
	(BreakpointDeleteCommand): same.

2005-04-11  Chris Toshok  <toshok@ximian.com>

	* configure.in: fix the AM_CONDITIONAL for BFD_TARGET_X86_64,
	which (for some unknown reason) was causing the debugger to
	configure in support for x86_64 on ubuntu 5.04 (on a p4).

2005-04-11  Chris Toshok  <toshok@ximian.com>

	* classes/TargetBinaryAccess.cs: new file, move the base class
	stuff out of TargetBinaryReader here, as well as TargetBlob.

	* classes/TargetBinaryReader.cs: inherit from TargetBinaryAccess.
	
	* classes/TargetBinaryWriter.cs: same.  stop inheriting from
	Reader.
	
2005-04-11  Chris Toshok  <toshok@ximian.com>

	* frontend/Expression.cs: clean up warnings.

	* frontend/CSharpTokenizer.cs: same.

	* frontend/GnuReadLine.cs: same.

	* frontend/Command.cs: same.

	* arch/DwarfFrameReader.cs: same.

	* arch/StabsReader.cs: same.

	* backends/Debugger.cs: same.

	* classes/ExceptionCatchPoint.cs: same.

	* classes/ProcessStart.cs: same.

	* classes/Module.cs: same.

2005-04-11  Martin Baulig  <martin@ximian.com>

	* arch/DwarfReader.cs: Add support for x86_64.

	* arch/Bfd.cs (Bfd.GetTrampoline): Move arch-specific code into
	IArchitecture.

	* interface/IArchitecture.cs
	(IArchitecture.GetJumpTarget): New method.
	(IArchitecture.RegisterMap): New property.

	* backends/mono/MonoSymbolFile.cs (MonoVariable.register_map):
	Moved into IArchitecture.RegisterMap since it's arch-specific.	

2005-04-08  Chris Toshok  <toshok@ximian.com>

	* frontend/Command.cs (UpCommand, DownCommand): oops, fix these so
	they continue to work with no arguments.

2005-04-08  Martin Baulig  <martin@ximian.com>

	* backends/Inferior.cs (Inferior.InsertHardwareBreakpoint): Allow
	TargetError.NotImplemented in addition to DebugRegisterOccupied.

2005-04-08  Martin Baulig  <martin@ximian.com>

	* arch/ArchitectureI386.cs: Renamed to Architecture_I386.cs.
	* arch/ArchitecturePowerPC.cs: Renamed to Architecture_PowerPC.cs.
	* arch/Architecture_X86_64.cs: New file.

2005-04-08  Martin Baulig  <martin@ximian.com>

	* backends/server/x86_arch.[ch]: New files.

2005-04-08  Martin Baulig  <martin@ximian.com>

	* backends/server/x86-linux-ptrace.h: Moved `INFERIOR_REGS_TYPE'
	and the `INFERIOR_REG_*' macros into i386-arch.h.

2005-04-08  Martin Baulig  <martin@ximian.com>

	* configure.in: Support x86_86 in the bfd.

	* arch/bfd: Added include/elf/x86-64.h, elf64-gen.c,
	elf64-target.h and elf64.c from Binutils 2.14.

2005-04-08  Martin Baulig  <martin@ximian.com>

	* backends/server/i386-ptrace.c: Renamed to x86-ptrace.c.
	* backends/server/i386-linux-ptrace.c: Renamed to x86-linux-ptrace.c.
	* backends/server/i386-linux-ptrace.h: Renamed to x86-linux-ptrace.h.
	* backends/server/i386-arch.h: Renamed to x86-arch.h and moved the
	architecture-specific stuff to a new i386-arch.h.

	* backends/server/x86-arch.h: Renamed `I386BreakpointInfo' to
	`X86BreakpointInfo' and all the `i386_arch_*' functions to `x86_arch_*'.

2005-04-07  Chris Toshok  <toshok@ximian.com>

	* arch/StabsReader.cs (MyVariable..ctor): remove spew.

2005-04-07  Chris Toshok  <toshok@ximian.com>

	* frontend/Command.cs (DownCommand, UpComand): add support for an
	argument.  in the up case, it increments
	process.CurrentFrameIndex.  In the down case, it decrements.

2005-04-06  Chris Toshok  <toshok@ximian.com>

	* backends/ThreadManager.cs (ThreadManager.wait_thread_main):
	remove the label 'again', as it's never used.

2005-04-06  Chris Toshok  <toshok@ximian.com>

	* backends/SingleSteppingEngine.cs
	(SingleSteppingEngine.Interrupt): let's be a little less flowery,
	shall we?

2005-04-06  Chris Toshok  <toshok@ximian.com>

	* classes/StackFrame.cs (StackFrame.check_disposed): let's be a
	little less flowery, shall we?

2005-04-06  Chris Toshok  <toshok@ximian.com>

	[ fixes bug #74469 ]
	* frontend/Command.cs (HelpCommand.Execute): if there are no
	commands in a family, say that and return.  don't crash.
	(LibraryCommand.Complete): do arg/filename completion.

2005-04-04  Chris Toshok  <toshok@ximian.com>

	* backends/mono/MonoFundamentalType.cs: use the protected
	"type_info" field instead of CreateTypeInfo, since the latter
	gives us hashtable assertions about duplicate key insertion.  This
	fixes passing fundamental objects (ints, floats, shorts, etc) to
	methods using the "call" command.

2005-04-02  Chris Toshok  <toshok@ximian.com>

	* backends/mono/MonoLanguageBackend.cs
	(MonoLanguageBackend.CanCreateInstance): we can create an instance
	of any type we can lookup (really only fundamental types at the
	moment).
	(MonoLanguageBackend.CreateInstance): flesh out this method.

	* backends/mono/MonoFundamentalType.cs (.CreateInstance):
	reimplement this to create instances of fundamental types in the
	inferior from within the debugger.

	* backends/mono/MonoStringTypeInfo.cs: remove the CreateString
	stuff from here, and move it to MonoStringType.cs

	* backends/mono/MonoStringType.cs (.CreateObject,
	.CreateInstance): reimplement these, so that we can create string
	objects in the inferior process from inside the debugger.

2005-03-31  Chris Toshok  <toshok@ximian.com>

	* backends/mono/MonoSymbolFile.cs (MonoMethod.get_variables): we
	need to attach liveness ranges to MonoVariables if they're defined
	in nested blocks regardless of whether or not local names are
	ambiguous.  This is so MonoDevelop can update the variable display
	and not show variables that aren't in scope.
	(MonoSymbolFile.GetMethod): remove spew.

	* backends/mono/MonoClassObject.cs (MonoClassObject.PrintObject):
	80% implementation.  still needs some more type checking on the
	method invoked.

	* backends/mono/MonoLanguageBackend.cs
	(MonoBuiltinTypeInfo..ctor): read in the Exception type from
	mono_defaults.
	(MonoLanguageBackend.get_ExceptionType): implement.

	* frontend/Command.cs (BreakpointEnableCommand,
	BreakpointDisableCommand, BreakpointDeleteCommand): switch from
	BreakpointHandle to IEventHandle and track api change in
	Interpreter, so we can deal with both catchpoints and breakpoints.

	* frontend/Interpreter.cs (Interpreter.ShowBreakpoints): loop over
	all IEventHandles now, and clean up the display a bit.
	(Interpreter.GetEvent): rename GetBreakpoint to this, so it can
	refer to both catchpoints and breakpoints.
	(Interpreter.DeleteEvent): rename DeleteBreakpoint to this, so it
	can refer to both catchpoints and breakpoints.
	(Interpreter.InsertExceptionCatchPoint): EventHandle ->
	CatchpointHandle.

	* classes/SourceLocation.cs (SourceLocation.InsertBreakpoint):
	track change to BreakpointHandle.

	* classes/CatchpointHandle.cs: the majority of the old code from
	EventHandle.cs, reorganized/renamed so as to implement
	IEventHandle.
	
	* classes/BreakpointHandle.cs: reorganize/rename things a bit so
	we implement IEventHandle.

	* interfaces/IEventHandle.cs: move classes/EventHandle.cs here,
	and make it a general interface, implemented by both
	classes/CatchpointHandle and classes/BreakpointHandle.

2005-03-24  Chris Toshok  <toshok@ximian.com>

	* configure.in (AC_OUTPUT): remove cslex/Makefile.

2005-03-23  Chris Toshok  <toshok@ximian.com>

	* cslex/ remove.
	
	* Makefile.am (SUBDIRS): remove cslex

	* frontend/Expression.cs (NumberExpression..ctor): add ctors for
	uint, long, ulong, float, double, and decimal.
	(PropertyGroupExpression): cut and paste job of
	MethodGroupExpression, for use in finding overloaded properties -
	i.e. indexers.
	(ArrayAccessExpression): allow multiple index expressions, and
	deal with indexers properly.

	* frontend/CSharpExpressionParser.jay: add many, many tokens.
	(constant): add more productions.
	(expression): make the array (foo[...]) production take multiple
	expressions, and pass them as an array to ArrayIndexExpression.

	* frontend/Makefile.am (noinst_DATA): remove CSharpTokenizer_lex.cs 
	(MAINTAINERCLEANFILES): same.
	(EXTRA_DIST): same.

	* frontend/CSharpTokenizer.lex: nuke this, cslex generated lexers
	can't deal with unicode.  which sucks.  hard.
	
	* frontend/CSharpTokenizer.cs: ressurect this, and make lots of
	improvements.  we can now deal with floats (courtesy of code
	ripped off of monodevelop), and lots of operator tokens were
	added.

2005-03-13  Chris Toshok  <toshok@ximian.com>

	* frontend/Makefile.am (MAINTAINERCLEANFILES): add
	CSharpTokenizer_lex.cs
	(CSharpTokenizer_lex.cs): add cslex rule to build this file.
	(EXTRA_DIST): add CSharpTokenizer_lex.cs/CSharpTokenizer.lex

	* frontend/ (svn:ignore): ignore CSharpTokenizer_lex.cs
	
	* frontend/CSharpTokenizer.lex: new file, lexer specification that
	implements the proper ifaces/properties that
	CSharpExpressionParser.jay expects.

	* frontend/CSharpExpressionParser.jay: clean up a little bit and
	make it work with the cslex generated lexer.

	* frontend/Expression.cs (NumberExpression..ctor): add a
	constructor for floats.  might not be the right place to put it,
	but it works.
	(BoolExpression): add a new type to represent boolean
	expressions. at the moment it can only deal with constant bool
	expressions like "true" and "false".
	(ConditionalExpression): add a new type to represent "a ? b : c".

	* Makefile.am (SUBDIRS): add cslex

	* configure.in (AC_OUTPUT): add cslex/Makefile

2005-03-09  Chris Toshok  <toshok@ximian.com>

	* acinclude.m4 (READLINE_TRYLINK): supply a function body calling
	a libreadline function.  This way, if libreadline is static, we'll
	pull in the archive and get undefined symbols if there are any.

2005-03-10  Martin Baulig  <martin@ximian.com>

	* interfaces/IVariable.cs (IVariable.GetLocation): New method.

	* frontend/Expression.cs (VariableAccessExpression): Derive from
	PointerExpression, not just Expression.
	(AddressOfExpression.EvaluateAddress): If `expr' is a
	PointerExpression, call EvaluateAddress() on it.

2005-03-09  Martin Baulig  <martin@ximian.com>

	* backends/mono/MonoLanguageBackend.cs (MonoLanguageBackend):
	Actually implement the ILanguage's type properties.

2005-03-02  Chris Toshok  <toshok@ximian.com>

	* backends/mono/MonoClassType.cs (MonoClassType.get_events): new
	function.
	(MonoClassType.get_Events, MonoClassType.get_StaticEvents):
	implement.
	(MonoClassType.get_constructors): new function.
	(MonoClassType.get_Constructors,
	MonoClassType.get_StaticConstructors): implement.
	(MonoMethodInfo.Get): new function, returns the
	ITargetFunctionObject corresponding to this MonoMethodInfo.
	(MonoEventInfo): new class, more or less a c&p job from
	MonoPropertyInfo.
	
2005-03-02  Chris Toshok  <toshok@ximian.com>

	* backends/server/Makefile.am: clean this up substantially, since
	we're no longer building the orbit stuff.

	* backends/server/library.c (mono_debugger_server_initialize):
	remove the MARTIN_HACKS stuff.

	* configure.in: remove the MARTIN_HACKS orbit stuff.

	* backends/server/remote-server.c, backends/server/debugger-srv.c,
	backends/server/debugger-srv.h, backends/server/remote-client.c,
	backends/server/Debugger.idl: nuke.

2005-02-25  Chris Toshok  <toshok@ximian.com>

	* interfaces/ITargetObject.cs (ITargetObject.TypeInfo): rename
	Type to TypeInfo, to better reflect the type of the property.
	Also, I was getting sick of seeing obj.Type.Type everywhere.

	* frontend/Command.cs, frontend/Expression.cs, frontend/Style.cs,
	frontend/ScriptingContext.cs, backends/native/NativeObject.cs,
	backends/native/NativeFundamentalObject.cs,
	backends/mono/MonoVariable.cs, backends/mono/MonoObject.cs,
	backends/mono/MonoFundamentalObjectBase.cs: deal with the fallout
	of the above change.
	
2005-02-23  Chris Toshok  <toshok@ximian.com>

	Fix bug #72827.
	* backends/mono/MonoSymbolFile.cs (JitLexicalBlockEntry): add
	start and end IL Offsets here.  not sure we need them, but it
	makes things consistent with the line number entry.
	(MethodAddress..ctor): read in the lexical block entries.
	(MonoMethod.get_variables): fix the FIXME to use scope ranges for
	variables if local names are ambiguous.

2005-02-21  Martin Baulig  <martin@ximian.com>

	* backends/DaemonThreadRunner.cs: Removed this old file.

	* backends/SingleSteppingEngine.cs
	(SingleSteppingEngine.DaemonEventHandler): Removed; this isn't
	used anymore.

2005-02-20  Chris Toshok  <toshok@ximian.com>

	* frontend/Makefile.am: track Tokenizer/ExpressionParser ->
	CSharpTokenizer/CSharpExpressionParser change.

	* wrapper/Makefile.am: same.

	* backends/native/NativeLanguage.cs: add implementation of
	ILanguage.SourceLanguage.

	* backends/mono/MonoLanguage.cs: same.
	
	* interfaces/ILanguage.cs: add "string SourceLanguage (StackFrame
	frame)".

	* frontend/Command.cs (Debugger.DoParseExpression): use
	context.Interpreter.GetExpressionParser to get our parser.
	(StyleCommand): nuke.
	(NestedCommand): new class that takes care of registering
	subcommands (for show, set, and threadgroup), and moves all the
	subcommand handling to one place.
	(SetCommand): new command for setting things.
	(SetCommand+SetLangCommand, SetCommand+SetStyleCommand): new
	private classes for the subcommands.
	(ShowCommand+*): move all the Show*Command subcommands to be
	private nested classes of ShowCommand, and change ShowCommand to
	inherit from NestedCommand.
	(ThreadGroup+*): same

	* frontend/Tokenizer.cs: rename to CSharpTokenizer.cs

	* frontend/ExpressionParser.jay: rename to CSharpExpressionParser.jay
	
	* frontend/CL.cs (Engine.Engine): re-indent.

	* frontend/Main.cs (CommandLineInterpreter.SetupEngine): remove
	the style command, add the set command, and add "info" as an alias
	for "show".

	* frontend/IExpressionParser.cs: interface that's used to
	communicate with any of the expression parsers.

	* frontend/Interpreter.cs: nuke ShortDescriptionAttribute since
	nothing uses it.
	(Interpreter.GetStyleNames): new function, so we can start
	thinking about autocompleting them.
	(Interpreter.CurrentLang, Interpreter.CurrentLangPretty,
	Interpreter.GetExpressionParser): the beginnings of new code to
	help implement the "set lang"/"show lang" commands, to help with
	mixed language debugging.

2005-02-17  Chris Toshok  <toshok@ximian.com>

	* backends/mono/MonoClassType.cs, backends/mono/MonoClass.cs:
	essentially collapse these two into one class.  MonoClass was an
	abstract base class with 2 methods (1 of which was a ctor), and
	MonoClassType was the only subclass.

	* backends/mono/MonoFunctionType.cs: track MonoClass ->
	MonoClassType change.

	* backends/mono/MonoClassInfo.cs: same.
	
2005-02-16  Chris Toshok  <toshok@ximian.com>

	* backends/mono/MonoSymbolFile.cs: rename "MonoType LookupType
	(...)" to "MonoType LookupMonoType (...)".

	* backends/mono/MonoLanguageBackend.cs: clean things up a little
	bit, rename "MonoType LookupType (...)" to "MonoType
	LookupMonoType (...)".
	
	* backends/mono/MonoFunctionType.cs: track LookupType ->
	LookupMonoType.

	* backends/mono/MonoArrayType.cs: same.

	* backends/mono/MonoClass.cs: same.

2005-02-16  Chris Toshok  <toshok@ximian.com>

	* backends/mono/MonoSymbolFile.cs,
	backends/mono/MonoLanguageBackend.cs: split out the MonoSymbolFile
	class and related machinery from MonoLanguageBackend.cs.
	
2005-02-15  Chris Toshok  <toshok@ximian.com>

	* classes/Makefile.am (EXTRA_DIST): remove ISymbolFile from here.
	
	* interfaces/Makefile.am (EXTRA_DIST): and add it here.

	* interfaces/ISymbolFile.cs: mv classes/ISymbolFile.cs here.
	
2005-02-15  Chris Toshok  <toshok@ximian.com>

	* backends/server/mutex.c (mono_debugger_event_trywait): fix
	warning.

	* backends/server/library.c: remove the #define for _GNU_SOURCE.
	gcc defines that for us.

	* backends/server/breakpoints.c: same.

	* backends/server/mutex.c: same.

	* backends/server/i386-arch.c: same.
	(server_ptrace_set_registers): fix type to remove compiler
	warning.

	* backends/server/i386-linux-ptrace.c (server_ptrace_global_init):
	no need to use g_static_mutex_init here since we initialize them
	when we declare them above.

2005-02-14  Chris Toshok  <toshok@ximian.com>

	* wrapper/Makefile.am (MDB_SRCLIST): remove Session.cs.

	* backends/mono/MonoLanguageBackend.cs: remove unused using.
	
	* classes/ExceptionCatchPoint.cs, classes/SourceInfo,
	classes/ProcessStart.cs, classes/SimpleBreakpoint.cs,
	classes/ModuleManager.cs, classes/ThreadGroup.cs,
	classes/Module.cs, classes/SourceLocation.cs,
	classes/EventHandle.cs, classes/Breakpoint.cs,
	classes/BreakpointHandle.cs, backends/Debugger.cs: remove
	serialization stuff.

	* arch/BfdContainer.cs: remove unused using.

	* arch/Bfd.cs: remove serialization stuff.

	* frontend/ScriptingContext.cs: remove unused usings.

	* frontend/Interpreter.cs (Interpreter.SaveSession,
	Interpreter.LoadSession, Interpreter.Restart): kill.

	* frontend/Command.cs (SaveCommand, LoadCommand, RestartCommand):
	kill.
	
	* frontend/Session.cs: nuke

	* frontend/Main.cs (CommandLineInterpreter.SetupEngine): remove
	registration of the load/save/restart commands.
	
2005-02-14  Chris Toshok  <toshok@ximian.com>

	* arch/DwarfReader.cs: add documentation for many of the Debugging
	Information Entries (DIEs), and add support for the Inheritance
	DIE.

2005-02-12  Chris Toshok  <toshok@ximian.com>

	* backends/SingleSteppingEngine.cs
	(SingleSteppingEngine.setup_engine): use manager.DebuggerBackend
	to get at the symboltablemanager.

2005-02-12  Chris Toshok  <toshok@ximian.com>

	* backends/Inferior.cs (Inferior.Run): store off the delegates so
	they aren't gc'ed before passing them to
	mono_dbeugger_server_spawn.

2005-02-12  Chris Toshok  <toshok@ximian.com>

	* backends/ThreadManager.cs: remove unused SymbolTableManager
	property.

2005-02-12  Chris Toshok  <toshok@ximian.com>

	* backends/ILanguageBackend.cs (NotificationType): add AddModule
	to reflect change to unmanaged code.

2005-02-10  Martin Baulig  <martin@ximian.com>

	* backends/Process.cs (Process.RuntimeInvoke): Don't throw an
	exception if the invoke failed; return the returned exception
	object instead.

2005-02-10  Martin Baulig  <martin@ximian.com>

	* backends/mono/*.cs: The new Mono debugging interface :-)

2005-02-10  Martin Baulig  <martin@ximian.com>

	* classes/TargetBinaryReader.cs (TargetBinaryReader.PeekBuffer):
	New public method.

2005-02-10  Martin Baulig  <martin@ximian.com>

	* backends/mono/MonoCSharpLanguageBackend.cs: Renamed to
	MonoLanguageBackend.cs.	

2005-02-10  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetTypeInfo.cs: New file.

	* interfaces/ITargetType.cs (ITargetType): Moved `HasFixedSize',
	`Size' and `GetObject' into ITargetTypeInfo.
	(ITargetType.Resolve): New method; returns an ITargetTypeInfo.

2005-02-10  Martin Baulig  <martin@ximian.com>

	* backends/: Renamed the `mono-csharp' directory to `mono'.
	* backends/mono/*.cs: Completely reworked the unmanaged debugger
	interface in the runtime.

2005-02-04  Chris Toshok  <toshok@ximian.com>

	* configure.in: add a mono dep to SERVER_DEPENDENCIES so we can
	use the metadata thread calls.

	* frontend/Interpreter.cs (Interpreter.Run): hook
	process.TargetOutput to the target_output delegate.
	(Interpreter.thread_created): same.

	* backends/server/i386-ptrace.c (child_setup_func): dup the
	inferior's output/error pipe fds over stdout/stderr.
	(server_ptrace_spawn): fill in the handlers and create the
	output/error pipes.  also, spawn our io thread.
	(io_thread): loop forever, proxying stdout/stderr to our
	delegates.

2005-02-03  Chris Toshok  <toshok@ximian.com>

	* frontend/Command.cs: add "-all" to SourceCommand, and fix up
	BreakCommand to deal with it.  Also add some ifdefed-out pending
	breakpoint code here.

	* frontend/Expression.cs
	(MethodGroupExpression.DoEvaluateLocation): throw
	MultpleLocationsMatchException instead of a ScriptingException
	when multiple methods match.

	* frontend/ScriptingContext.cs
	(MultipleLocationsMatchException): as much as I hate to do it, add
	an exception class to allow location resolution to pass back
	multiple matches (and allow the caller to differentiate the two
	cases of "more than one location" and "multiple locations")
	(ScriptingContext.AddMethodSearchResult): add blurb about '-all'.
	Also only print when @print = true.
	(ScriptingContext.NumMethodSearchResults): new property.
	(ScriptingContext.ClearMethodSearchResults): new method, clear out
	both the hashtable and arraylist.
	
2005-02-03  Chris Toshok  <toshok@ximian.com>

	* backends/mono-csharp/MonoClass.cs (MonoEventInfo..ctor): pass
	the MonoSymbolField to the superclass's ctor.
	(MonoMethodInfo..ctor): same.
	(MonoPropertyInfo..ctor): same, and cache the typeinfo we use to
	look up our type (so we can look it up again in the Type getter.)
	(MonoFieldInfo..ctor): same.
	(MonoFieldInfo.get_Type): if our type is a MonoClassPlaceholder,
	attempt to resolve it again before passing it back to the caller.
	(MonoPropertyInfo.get_Type): if our type is a
	MonoClassPlaceholder, attempt to resolve it again before passing
	it back to the caller.
	(MonoStructMember): provide readonly access to the MonoSymbolFile
	we loaded this member's types from.

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoSymbolTable.GetType): only cache the type in the types
	hashtable if it's not a placeholder.
	(MonoSymbolTable.GetTypeFromClas): return a placeholder object if
	there is no ClassEntry, not an OpaqueType.

2005-02-03  Chris Toshok  <toshok@ximian.com>

	* classes/MethodSource.cs: nuke unused comment.

2005-02-01  Chris Toshok  <toshok@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoSymbolTable.Update): add comment about the C structure this
	code reads.  Throw SymbolTableException instead of InternalError
	when the size of the struct isn't as expected, to be more in line
	with what we do when magic/version mismatches happen.
	(MonoSymbolTable.read_type_table): add comment about the C
	structure this code reads.
	(MonoSymbolTable.read_misc_table): add comment about the C
	structure this code reads.

2005-01-31  Chris Toshok  <toshok@ximian.com>

	* classes/ProcessStart.cs (DebuggerOptions.WorkingDirectory):
	default to Environment.CurrentDirectory instead of ".", so we get
	a full path when the user types "pwd".

	* frontend/Command.cs (CdCommand): new class, implements a
	gdb-like "cd" command.
	(PwdCommand): new class, implements a gdb-like "pwd" command.
	(FileCommand.Complete): use the filename completer.

	* frontend/Main.cs (CommandLineInterpreter.SetupEngine): register
	the "cd"/"pwd" commands.

2005-01-27  Chris Toshok  <toshok@ximian.com>

	* frontend/Completer.cs (StringsCompleter): simple completer to
	match against a static set of strings.

	* frontend/Command.cs (ShowCommand.Complete): complete against
	subcommand types.
	(ThreadGroupCommand.Complete): same.
	
2005-01-27  Chris Toshok  <toshok@ximian.com>

	* classes/Report.cs (DebugFlags): add SourceFiles.

	* classes/SourceFileFactory.cs (SourceFileFactory.read_file):
	quiet some spew and make it only show up for particular debug
	flags, and add a comment about the particular code page we use
	when reading the source file.

2005-01-25  Chris Toshok  <toshok@ximian.com>

	* glue/mono-debugger-readline.h: add prototype for
	mono_debugger_readline_get_columns.

	* glue/mono-debugger-readline.c
	(mono_debugger_readline_get_columns): new function, get the
	current screen width from readline.

	* frontend/GnuReadLine.cs (GnuReadLine.Columns): new property.
	the getter calls mono_debugger_readline_get_columns.

	* frontend/Style.cs (StructFormatter.Format): use
	GnuReadLine.Columns instead of hardcoding an assumed column width
	here.  also take into account the length of the header.
	
2005-01-25  Chris Toshok  <toshok@ximian.com>

	* frontend/Style.cs (Style): PrintVariable takes a FrameHandle now
	instead of StackFrame, and FormatObject also takes a FrameHandle
	arg.
	(StyleNative.FormatObject): If the object we're printing is a
	struct type, print out its static fields by calling
	NativeStyle.FormatStructType.
	(StyleNative.FormatStructType): print out the type's static
	fields (and their values).

	* frontend/ScriptingContext.cs (FrameHandle.ShowParameters,
	FrameHandle.ShowLocals): Style.PrintVariable takes a FrameHandle
	now, not a StackFrame.
	(ScriptingContext.PrintObject): pass the CurrentFrame in to this
	call so we can access static fields.

2005-01-25  Martin Baulig  <martin@ximian.com>

	* backends/native/NativePointerObject.cs
	(NativePointerObject.Print): Print a null pointer as "0x0".

2005-01-25  Martin Baulig  <martin@ximian.com>

	* frontend/Style.cs (StructFormatter): New public class.
	(StyleNative.DoFormatObject): Use the new StructFormatter.

2005-01-21  Chris Toshok  <toshok@ximian.com>

	* frontend/Command.cs (SourceCommand.DoResolveExpression): don't
	require that people use -instance for SourceCommand's (like break,
	list, etc.) in order for instance methods to be included in the
	search.  It should jfw.

2005-01-21  Chris Toshok  <toshok@ximian.com>

	* doc/Makefile.am (update): track proper location of
	Mono.Debugger.dll.

2005-01-21  Chris Toshok  <toshok@ximian.com>

	* frontend/Main.cs: Fix command line parsing so that it correctly
	allows for all of the following forms: "/arg:value", /arg value",
	"-arg:value", "-arg value", "/arg", and "-arg" (and prints out a
	usage message if it fails to parse a particular arg/value).

2005-01-14  Chris Toshok  <toshok@ximian.com>

	* frontend/Completer.cs (Completer.SymbolCompleter): attempt to
	prepend the currently in-scope namespaces to the text so we don't
	have to enter fully qualified names for completion.

	* frontend/ScriptingContext.cs (ScriptingContext.GetNamespaces):
	add two overloaded methods for this, one that takes a FrameHandle
	and one with no args (to use the current frame).

	* frontend/Expression.cs (SimpleNameExpression.GetNamespaces):
	remove, and move to ScriptingContext.
	(SimpleNameExpression.Lookup, SimpleNameExpression.DoResolveType):
	use ScriptingContext.GetNamespaces.

2005-01-05  Chris Toshok  <toshok@ximian.com>

	* frontend/Interpreter.cs (Interpreter.Modules): add a property so
	Completer.SymbolCompleter can get at the module list.

	* frontend/Command.cs (BreakCommand.Complete): if it doesn't start
	with a '-' or contain a '/', try to complete it as a symbol.

	* frontend/Completer.cs (Completer.ComputeMCP): computer the
	maximal common prefix from a set of strings.
	(Completer.CommandCompleter, Completer.ArgumentCompleter,
	Completer.FilenameCompleter, Completer.SymbolCompleter): call
	ComputeMCP when inserting the first match so that readline will
	complete up to the point where the matches are different.
	(Completer.SymbolCompleter): new function.  use either of two ways
	to get a list of methods to complete against.  probably isn't
	100%, but it's close.
	
2004-12-15  Chris Toshok  <toshok@ximian.com>

	* glue/mono-debugger-readline.c: drop the #include of
	mono/metadata/debug-helpers.h.
	(mono_debugger_readline_set_completion_matches): set
	rl_attempted_completion_over to 1 here so we don't fall back to
	filename completion automatically (that's handled by the Command
	completers.)

	* glue/mono-debugger-readline.h: drop the #include of
	mono/jit/jit.h.

2004-12-14  Chris Toshok  <toshok@ximian.com>

	* configure.in: simplify the readline stuff - we force the dep on
	readline/libedit if the frontend is being built.  there's no
	reason to allow the user to disable it.

	* frontend/Main.cs: GnuReadLine is all static now, and it's
	assumed to be there.

	* glue/mono-debugger-readline.c (sigint_handler): remove the
	USE_READLINE ifdef.
	(mono_debugger_readline_static_init): same, and change the return
	type to void.  also call rl_set_signals so readline's signal
	handlers will get installed.
	(mono_debugger_readline_readline): remove the USE_READLINE ifdef.
	(mono_debugger_readline_add_history): same.
	(mono_debugger_readline_get_filename_completion_desired): new
	function.
	(mono_debugger_readline_set_filename_completion_desired): same.
	(mono_debugger_readline_enable_completion): remove the
	USE_READLINE ifdef.

	* glue/mono-debugger-readline.h: remove the USE_READLINE ifdefs
	- we assume it's there - and add prototypes for the filename
	completion stuff.

	* frontend/GnuReadLine.cs: make all methods/properties static.
	Also, remove the has_readline stuff.  from now on we'll just
	assume readline is there if we're building the frontend.  Also,
	add two more pinvoke functions, for getting/setting
	rl_filename_completion_desired.

	* frontend/Completer.cs (Completer.ArgumentCompleter): move the
	argument completion stuff here.
	(Completer.FilenameCompleter): new function, generate completions
	based on the path.
	
	* frontend/Command.cs: GnuReadLine is all static now.  remove the
	silly Instance() stuff.
	(Command.Complete): take all the code for argument completion and
	put it in Completer.ArgumentCompleter.
	(BreakCommand.Complete): if the text begins with
	Path.DirectorySeparatorChar, do filename completion.  This should
	probably be made a bit smarter and moved to SourceCommand.

2004-12-14  Chris Toshok  <toshok@ximian.com>

	* frontend/Command.cs: nuke CommandError.

2004-12-14  Chris Toshok  <toshok@ximian.com>

	* frontend/Command.cs (Command.Complete): add parameter completion
	here - for instance, you type "command -<tab><tab>" and it'll list
	"command"'s possible arguments.

2004-12-14  Chris Toshok  <toshok@ximian.com>

	* frontend/Completer.cs (Completer.CommandCompleter): this isn't
	*really* the right spot for it, but we need to insert the prefix
	of all matches as the first element in the matches array, so that
	readline will know to insert only that and display the rest of the
	list to the user so they can choose from it..

2004-12-12  Martin Baulig  <martin@ximian.com>

	* classes/ProcessStart.cs (DebuggerOptions.StartTarget): New field.

	* frontend/Interpreter.cs (Interpreter.Start): New overloaded
	version taking a `DebuggerOptions'.

	* frontend/Main.cs (CommandLineInterpreter.ParseOption): Added
	`-run' command line argument to immediately start the target.

2004-12-11  Martin Baulig  <martin@ximian.com>

	* backends/ThreadManager.cs (ThreadManager.HandleChildEvent): Set
	`abort_requested' if the child exited.

2004-12-09  Miguel de Icaza  <miguel@ximian.com>

	* glue/mono-debugger-readline.c
	(mono_debugger_readline_set_completion_matches): When there are no
	matches readline expects to get a NULL back, not a zero array.

2004-12-09  Chris Toshok  <toshok@ximian.com>

	* frontend/GnuReadLine.cs: deal with null matches.

2004-12-09  Chris Toshok  <toshok@ximian.com>

	* wrapper/Makefile.am (MDB_SRCLIST): add frontend/Completer.cs

2004-12-09  Chris Toshok  <toshok@ximian.com>

	* frontend/CL.cs (Engine..ctor): create our Completer.

	* frontend/Completer.cs: new file/class.  provides the completion
	delegate for GnuReadLine that does completion against commands at
	the start of the line, then defers to command specific completion
	(if possible) for the rest.

	* frontend/Main.cs (CommandLineInterpreter..ctor): add the call to
	enable completion, but comment it out for now, until I can figure
	out why it's crashing.

	* frontend/Command.cs (Command.Complete): base class impl, just
	call SetCompletionMatches(null).
	(HelpCommand.Complete): override the default behavior so we
	complete against command names.

2004-12-09  Chris Toshok  <toshok@ximian.com>

	* frontend/Command.cs: Move class CommandError, enum Command
	Family, interface IDocumentableCommand, and class Command from
	CL.cs here.

2004-12-09  Chris Toshok  <toshok@ximian.com>

	* glue/mono-debugger-readline.c
	(mono_debugger_readline_current_line_buffer): new function, return
	rl_line_buffer, dup'ed.
	(mono_debugger_readline_set_completion_matches): new functoin.
	(mono_debugger_readline_completion_function): new function, this
	is the one we register with libreadline, the one that calls our
	delegate.
	(mono_debugger_readline_enable_completion): new function, register
	our completion function and set the delegate.

	* frontend/Main.cs (CommandLineInterpreter..ctor): use
	GnuReadLine.Instance().

	* frontend/GnuReadLine.cs: make this a singleton class.
	(GnuReadLine.SetCompletionMatches): new method.  this must be
	called from the CompletionDelegate in order to communicate back to
	libreadline the matches for a given string.
	(GnuReadLine.EnableCompletion): new method, sets the
	CompletionDelegate.
	(GnuReadLine.CurrentLine): gets the contents of the current line,
	so we can do some rudimentary parsing if necessary.
	
2004-12-08  Chris Toshok  <toshok@ximian.com>

	* Makefile.am (SUBDIRS): frontends -> frontend.

2004-12-08  Chris Toshok  <toshok@ximian.com>

	* configure.in (AC_OUTPUT): remove the frontends/* subdirs.  we
	just build frontend/ now.

	* wrapper/Makefile.am (MDB_SRCLIST): track change in location of
	all frontend files.

        * frontends/*: move all files into frontend/ directory, and
	collapse the three (yes, three) namespaces down into 1.
	
2004-12-08  Martin Baulig  <martin@ximian.com>

	* configure.in: Add -D_GNU_SOURCE to `glue_cflags' and
	`server_cflags' on Linux.

	* wrapper/Makefile.am (WRAPPER_CFLAGS): Include `@glue_cflags@'.

	* wrapper/wrapper.c (debugger_event_handler): Reflect latest
	metadata changes; take two guint64 arguments.

	* backends/server/i386-arch.c (i386_arch_child_stopped): The
	notification function now takes two guint64 arguments.

2004-12-07  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Command.cs (SourceCommand.Instance): Added
	`-instance' argument to include instance members in static
	context.

	* frontends/scripting/Expression.cs
	(MemberAccessExpression.ResolveMemberAccess): New public method;
	moved all the DoResolve() implementation here and added `bool
	allow_instance' argument.
	(MemberAccessExpression.DoResolve): Just call ResolveMemberAccess().
	(StructAccessExpression.FindMember): Added `bool allow_instance'
	argument to include instance members in static context.

2004-12-06  Chris Toshok  <toshok@ximian.com>

	* backends/server/powerpc-arch.c (powerpc_get_registers): we get
	all registers now, not just a subset of them.
	(powerpc_set_registers): same.
	(powerpc_get_pc): rename to powerpc_get_frame, and implement.
	(powerpc_insert_breakpoint):
	mono_debugger_breakpoint_manager_lock/unlock no longer take a
	pointer to a bpm.
	(powerpc_remove_breakpoint): same.
	(powerpc_enable_breakpoint): same.
	(powerpc_disable_breakpoint): same.
	(powerpc_get_breakpoints): same.
	(powerpc_current_insn_is_bpt): same.
	(check_breakpoint): same.

	* backends/server/powerpc-darwin.c (powerpc_get_target_info): fix
	signature and set is_bigendian.
	(powerpc_global_init): new function.
	(powerpc_darwin_inferior): add global_init and remove get_pc,
	renaming to get_frame.

2004-12-06  Chris Toshok  <toshok@ximian.com>

	* configure.in: nuke the LT_VERSION stuff, as it breaks the ppc
	build.

2004-12-06  Chris Toshok  <toshok@ximian.com>

	* backends/server/Makefile.am (libmonodebuggerserver_la_LDFLAGS):
	remove -module and -version-info, as it's unnecessary (for the
	moment, at the very least) and it breaks the ppc build.

	* glue/Makefile.am (libmonodebuggerreadline_la_LDFLAGS): remove
	-module, as it's unnecessary and breaks the ppc build.

	* autogen.sh: use glibtool if it's there.

	* acinclude.m4: add the LINUX_NPTL_CHECK here.

	* configure.in: and make use of it here, only if the platform is
	i386linux and server_only = no.

2004-12-06  Chris Toshok  <toshok@ximian.com>

	* glue/Makefile.am: change all the LIBEDIT stuff back to
	READLINE.  except now "READLINE" is a generic term, kinda like
	"Coke".

	* glue/mono-debugger-readline.c: LIBEDIT -> READLINE.

	* glue/mono-debugger-readline.h: include the right headers
	depending on whether we're readline or libedit.

	* README: add readline info to the dependency section.

	* configure.in (USE_READLINE): simplify the readline stuff here by
	using the macros that are in acinclude.m4.  the rest of this file
	(particularly the NPTL stuff) could stand a similar cleaning up.

	* acinclude.m4: new file.  put some macros dealing with
	readline/libedit here.  Make it deal with check readline and
	editline, and allow the user to specify either on the configure
	line.

2004-11-28  Miguel de Icaza  <miguel@ximian.com>

	* frontends/scripting/Command.cs (ListSourceCode): The symbol "-"
	means, list backwards, to be compatible with gdb. 

	* frontends/scripting/ScriptingContext.cs (ListSourceCode): Allow
	for count to be negative to list source code backwards.

	Fix off-by-one rendering of the line number.

2004-11-27  Chris Toshok  <toshok@ximian.com>

	* frontends/scripting/ScriptingContext.cs
	(ScriptingContext.AddMethodSearchResult): give a little helpful
	note about using "-id N".

	* frontends/command-line/Main.cs
	(CommandLineInterpreter.SetupEngine): add the "file" command, and
	remove the "start" command.
	(CommandLineInterpreter.ParseOption): new function to parse a
	command line arg.  Basically ripped from mcs and tweaked.
	(CommandLineInterpreter.ParseCommandLine): new function to parse
	the command line.  special handling for accumulating inferior args
	when the -args cmd line arg is present.
	(CommandLineInterpreter.Usage): new function.
	(CommandLineInterpreter.About): new function.
	(CommandLineInterpreter.Main): rework this to use ParseCommandLine
	instead of the GetOptions stuff.

	* frontends/scripting/Interpreter.cs (Interpreter): instead of
	duplicating fields of DebuggerOptions here, just save off the
	options passed to our ctor.
	(Interpreter.Interpreter): store off options, and don't attempt to
	initialize start here.  We do this when the user explicitly "run"s
	the executable.
	(Interpreter.IsScript): change the getter to use options.
	(Interpreter.Options): DebuggerOptions getter.
	(Interpreter.Start): we don't need to pass the DebuggerOptions
	here, as they were passed in to our ctor.
	(Interpreter.Query): new function to prompt the user for a 'y' or
	'n' response.
	
	* frontends/scripting/Command.cs (StartCommand): remove class.
	(FileCommand): new class, which allows setting and clearing
	DebuggerOptions.File.
	(RunCommand.DoResolve): Implement, and query the user if we're
	already debugging something (and we're interactive).
	(RunCommand.DoExecute): build up the inferior args array using the
	command args if they're present, or from the debugger options if
	they aren't.  Also, output the command line we're executing.
	(QuitCommand.NeedsProcess): override, return false.
	(QuitCommand.DoResolve): override, querying the user if there's a
	running inferior process.
	
	* classes/ProcessStart.cs (DebuggerOptions): remove the Options
	superclass.  This is still the place to look for options that
	effect execution of the debugger and of the inferior process, but
	parsing of the command line happens elsewhere now (Main.cs).
	Also, add File and InferiorArgs options, which constitute the
	inferior process's argv.
	(ProcessStart.Create): build up the args based on
	File/InferiorArgs.

2004-11-21  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetStructObject.cs (ITargetStructObject.Type):
	Fix compiler warning; the `new' modifier is required here.

	* interfaces/ITargetClassObject.cs: Likewise.
	* interfaces/ITargetPointerObject.cs: Likewise.
	* interfaces/ITargetStructType.cs: Likewise.

2004-11-18  Chris Toshok  <toshok@ximian.com>

	* backends/mono-csharp/MonoFundamentalType.cs
	(MonoFundamentalType.Supports): fix the debugger, after r36132
	(which makes IntPtr/UIntPtr primitive) broke it.

2004-11-17  Chris Toshok  <toshok@ximian.com>

	* frontends/scripting/Interpreter.cs (Interpreter.Start): accept a
	"string[] argv" argument, and pass that along to
	ProcessStart.Create.

	* frontends/scripting/Command.cs (StartCommand.DoExecute): pass
	the args directly to Interpreter.Start, so we don't parse them for
	debugger options (and don't expand @ args, etc.)

	* classes/ProcessStart.cs (ProcessStart.Create): add a new
	overloaded version that takes the argv as well as the
	DebuggerOptions.  This argv is used as is, without any processing.

2004-11-17  Chris Toshok  <toshok@ximian.com>

	* test/regress.exp: some changes - add pass/fail procs, keep track
	of the number of operations performed, and sometimes (rarely)
	choose "finish".

2004-11-17  Chris Toshok  <toshok@ximian.com>

	* test/regress.exp: add the current state of the "run the compiler
	compiling itself inside the debugger" regression test.  it has
	some hardcoded paths, and assumes you'll run it from the mcs/mcs
	dir, but it should work.

2004-11-15  Chris Toshok  <toshok@ximian.com>

	* frontends/command-line/Main.cs: remove some unused using
	directives.

2004-11-12  Chris Toshok  <toshok@ximian.com>

	* wrapper/wrapper.c (main_thread_handler): fix build.
	(mono_debugger_main): same.

2004-11-12  Chris Toshok  <toshok@ximian.com>

	* jay/: Add our own copy of jay from the mcs source.
	
	* configure.in (AC_OUTPUT): add jay/Makefile.

	* Makefile.am (SUBDIRS): add jay/

	* frontends/command-line/Makefile.am (JAY): use our jay, not
	mcs's.

2004-10-22  Chris Toshok  <toshok@ximian.com>

	* frontends/scripting/Command.cs: remove CommandParamAttribute.
	Duncan is a GOD.

2004-10-22  Chris Toshok  <toshok@ximian.com>

	* frontends/command-line/Main.cs: differentiate between commands
	and aliases (RegisterCommand/RegisterAlias).

	* frontends/scripting/Interpreter.cs: remove the HelpAttribute.

	* frontends/command-line/CL.cs: add the CommandFamily enum, and
	differentiate between "aliases" and "commands".  Also, expose the
	commands and aliases hashes as readonly so the HelpCommand can get
	at them.  Also, When commands are registered, build up the list of
	commands by family.

	* frontends/scripting/Command.cs: add help docs (rather spartan at
	the moment) for all commands, and make the HelpCommand generate
	all its output from these docs.

2004-10-22  Martin Baulig  <martin@ximian.com>

	* wrapper/wrapper.c (debugger_get_virtual_method): Don't call
	mono_object_get_virtual_method() on valuetypes.

2004-10-22  Martin Baulig  <martin@ximian.com>

	* backends/ILanguageBackend.cs
	(ILanguageBackend): Added GetBoxedObjectFunc().

2004-10-22  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs (Operation): Added public
	`SimpleStackFrame StartFrame' field; this is the stack frame where
	the operation started.
	(SingleSteppingOperation.ProcessCommand): Compute and set the
	operation's `StartFrame'.

2004-10-22  Martin Baulig  <martin@ximian.com>

	* tests/: Updated the tests and made them work again.

2004-10-22  Chris Toshok  <toshok@ximian.com>

	* frontends/scripting/Style.cs (NativeStyle.FormatMethod): fix the
	formatting of cctor/ctor.
	(NativeStyle.FormatType): format cctors as well, as pass the right
	values for is_static/is_ctor.

	* frontends/scripting/Expression.cs: special case ".ctor" and
	".cctor" method names.

	* interfaces/ITargetStructType.cs
	(ITargetStructType.StaticConstructors): new property.
	(ITargetStructType.GetStaticConstructor): new method.

	* backends/mono-csharp/MonoClass.cs: add support for cctors.

	* backends/native/NativeStructType.cs: stub out the static
	constructor foo.

2004-10-22  Chris Toshok  <toshok@ximian.com>

	* frontends/command-line/Tokenizer.cs (Tokenizer.xtoken): handle
	"." (DOT) and ".." (DOTDOT).

	* frontends/command-line/ExpressionParser.jay (expression): add a
	BASE DOTDOT IDENTIFIER production for use with methods that have a
	"." prefix (like .ctor and .cctor).
	(variable_or_type_name): same.

	* frontends/scripting/Expression.cs: if the method name is
	".ctor", add the type's constructors to the list of methods.

2004-10-22  Chris Toshok  <toshok@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs: replace +
	with / when registering load handlers.

2004-10-21  Chris Toshok  <toshok@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoMethod.GetTypeSignature): fall through in the TypeCode.Object
	case so we use t.FullName.
	(MonoMethod.RegisterLoadHandler): allow multiple load handlers per
	method, just make sure to only insert the load handler breakpoint
	(the one that we hit when first entering the method that allows us
	to insert all the user created ones) once.  Before this change you
	could only insert one user breakpoint on an unjitted method.

2004-10-21  Martin Baulig  <martin@ximian.com>

	* backends/ILanguageBackend.cs
	(NotificationType): Added `ThrowException'.

	* backends/Inferior.cs
	(Inferior.ChildEventType): Added `THROW_EXCEPTION'.

	* backends/SingleSteppingEngine.cs: We're now getting a
	NotificationType.ThrowException from the runtime each time an
	exception is being thrown.  Use that for exception catchpoints.

2004-10-21  Chris Toshok  <toshok@ximian.com>

	* frontends/scripting/Interpreter.cs
	(Interpreter.GetFullPathByFilename): new method - find the full
	path given just the filename.  This makes emacs breakpoints (C-x
	space) work.

2004-10-21  Chris Toshok  <toshok@ximian.com>

	* frontends/scripting/Style.cs (StyleNative.FormatEvent): new
	function.
	(StyleNative.FormatType): format both instance and static events.

	* frontends/scripting/Expression.cs
	(StructAccessExpression.GetEvent,
	StructAccessExpression.GetStaticEvent): new methods.
	(StructAccessExpression.FindMember): try to find events too.
	(StructAccessExpression.GetMember): add event support.
	(StructAccessExpression.GetStaticMember): same.
	(StructAccessExpression.DoEvaluateLocation): add support for event
	add/remove blocks.

	* frontends/scripting/Command.cs: add Add/Remove properties so
	-add and -remove can be used on source commands (like list and
	break).

	* backends/native/NativeStructType.cs: implement the event stuff
	from ITargetStructType.

	* backends/native/NativeStructObject.cs
	(NativeStructObject.GetEvent): implement.

	* backends/mono-csharp/MonoClassObject.cs
	(MonoClassObject.GetEvent): implement the ITargetStructObject
	event stuff.

	* backends/mono-csharp/MonoClass.cs (MonoClass.init_events,
	MonoClass.Events, MonoClass.init_static_events,
	MonoClass.StaticEvents): implement the ITargetStructType event
	stuff.
	(MonoClass.ctor): read event/static event info.

	* interfaces/ITargetStructType.cs (ITargetStructType.Events): new
	property.
	(ITargetStructType.StaticEvents): new property.
	(ITargetStructType.GetStaticEvent): new method

	* interfaces/ITargetStructObject.cs
	(ITargetStructObject.GetEvent): new method.

2004-10-21  Martin Baulig  <martin@ximian.com>

	* classes/TargetEvent.cs (TargetEventType): Added `Exception'.

	* classes/Breakpoint.cs (Breakpoint.CheckBreakpointHit): Added
	`TargetAddress frame_address' argument.

	* classes/ExceptionCatchPoint.cs: New public class, derives from
	Breakpoint.

	* classes/EventHandle.cs: New public class.

	* backends/Process.cs
	(Process.AddEventHandler): New public method.
	(Process.RemoveEventHandler): New public method.

	* backends/SingleSteppingEngine.cs
	(SingleSteppingEngine.handle_exception): Support exception catch points.	

2004-10-21  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Command.cs (CatchCommand): New command.

2004-10-21  Martin Baulig  <martin@ximian.com>

	* interfaces/ILanguage.cs
	(ILanguage.ExceptionType): New public property.

2004-10-21  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoSymbolTable.GetTypeFromClass): Added `Type type' argument; if
	we can't find the class for some reason, print a warning and
	create a MonoOpaqueType.

2004-10-20  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetStructType.cs
	(ITargetPropertyInfo): Added `Getter' and `Setter' properties.

	* frontends/scripting/Expression.cs
	(LocationType): New public enum.
	(Expression.EvaluateLocation): Added `LocationType type' argument.
	(Expression.DoEvaluateLocation): Likewise.
	(SourceExpression): Added `-set' and `-get' arguments to specify a
	property's getter/setter.

	* frontends/scripting/Command.cs (AboutCommand): Added Chris Toshok :-)

2004-10-20  Chris Toshok  <toshok@ximian.com>

	* classes/ProcessStart.cs (DebuggerOptions): add -f/-fullname,
	which the emacs gud stuff passes on the command line, and also
	change the WorkingDirectory option to -cd/-working-directory.

	* frontends/scripting/Style.cs (StyleEmacs):
	(StyleNative.TargetStopped): make this virtual so that StyleEmacs
	can override it.

	* frontends/scripting/Interpreter.cs (Interpreter.ctor): add emacs
	style, and don't call Run() here, we do it in response to the user
	typing "run".

	* frontends/scripting/Command.cs (RunCommand): new command.
	(HelpCommand.Execute): add "run" blurb.

	* frontends/command-line/Main.cs
	(CommandLineInterpreter.ctor): if we're running in emacs -- if
	options.InEmacs == true -- default the style to "emacs".
	(CommandLineInterpreter.SetupEngine): register the RunCommand on
	"run" and "r".

2004-10-20  Martin Baulig  <martin@ximian.com>

	* backends/StepFrame.cs
	(StepFrame.StackFrame): New public property.
	(StepFrame.ctor): Added `SimpleStackFrame' argument.

	* backends/SingleSteppingEngine.cs
	(SingleSteppingEngine.handle_exception): New private method to
	handle exceptions.

2004-10-20  Martin Baulig  <martin@ximian.com>

	* backends/ILanguageBackend.cs
	(NotificationType): Added `HandleException'.

	* backends/Inferior.cs
	(Inferior.ChildEventType): Added `HANDLE_EXCEPTION'.

	* backends/MonoThreadManager.cs
	(MonoThreadManager.HandleChildEvent): Added support for
	`NotificationType.HandleException'.

	* backends/SingleSteppingEngine.cs
	(SingleSteppingEngine.ProcessEvent): Added support for
	`Inferior.ChildEventType.HANDLE_EXCEPTION'.	

2004-10-20  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBakcend.cs
	(MonoMethod.GetTypeSignature): New method.
	[FIXME: This needs some love.]	

2004-10-20  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoMethod.RegisterLoadHandler): Pass the full method signature
	to the JIT; fixes #68527.

2004-10-20  Martin Baulig  <martin@ximian.com>

	* arch/BfdDisassembler.cs (BfdDisassembler.print_address_func):
	Always include the address, even if we have a function name.

2004-10-18  Chris Toshok  <toshok@ximian.com>

	* frontends/scripting/Expression.cs (StructAccessExpression):
	remove the "new" modifier from the Type field.

2004-10-18  Chris Toshok  <toshok@ximian.com>

	* backends/ThreadManager.cs (ThreadManager.SendSyncCommand):
	Process -> Engine.
	(ThreadManager.engine_thread_main): same.

	* backends/SingleSteppingEngine.cs: rename Command.Process to
	Command.Engine, so things are a little less confusing (it is
	afterall a SSE, not a Process).

2004-10-06  Chris Toshok  <toshok@ximian.com>

	* glue/Makefile.am
	(libmonodebuggerreadline_la_LIBADD): s/READLINE/LIBEDIT/

	* glue/mono-debugger-readline.[ch]: same.

	* configure.in: s/libreadline/libedit, and also add TRY_LINK
	clauses that look for -lcurses and -lncurses, not just -ltermcap.

2004-10-05  Chris Toshok  <toshok@ximian.com>

	* arch/DwarfFrameReader.cs: stub out the 'P' augmentation (much as
	the 'L' aug is presently stubbed out.)  This code appears
	incomplete, but this at least gets us a functioning "where"
	command when debugging mono-find-provides.exe (libicu has P augs).
	Also, fix the unknown augmentation error to include the particular
	aug, not the entire aug string.

2004-10-05  Chris Toshok  <toshok@ximian.com>

	* frontends/scripting/Expression.cs: correct message for zero
	length array accesses.

2004-09-24  Martin Baulig  <martin@ximian.com>

	* backends/server/i386-ptrace.c (server_ptrace_finalize): Don't
	call do_wait(), it's causing hangs on exit and it was just there
	to reap children.

2004-09-20  Chris Toshok  <toshok@ximian.com>

	* frontends/scripting/Expression.cs
	(ArrayAccessExpression.DoEvaluateVariable): don't unconditionally
	throw an exception about the variable not being an array type -
	only do that if casting to both ITargetArrayObject and
	ITargetPointerObject fails.  this should fix printing array
	elements from the (mdb) prompt.

2004-09-20  Chris Toshok  <toshok@ximian.com>

	* backends/SingleSteppingEngine.cs
	(SingleSteppingEngine.frame_changed): in the else block of the if,
	current_method might be null, so take that into account before
	calling check_method_operation.

2004-09-20  Chris Toshok  <toshok@ximian.com>

	* arch/DwarfReader.cs (TargetVariable.ctor): Add a ctor that takes
	an offset instead of a TargetLocation.
	(TargetVariable.GetAddress): in the case where the offset ctor is
	used, use that offset directly when creating a
	MonoVariableLocation.
	(DieMethodVariable.ProcessAttribute): the DWARF spec says location
	attributes can be blocks of constants.  handle the constant cases
	here (does this need to be augmented with the other block cases as
	well?)
	(DieMethodVariable.DoResolve): handle both the block and constant
	cases here.

2004-09-21  Martin Baulig  <martin@ximian.com>

	* classes/ProcessStart.cs (ProcessStart..ctor): If we're debugging
	a managed application, check whether it has the correct runtime
	version.	

2004-09-07  Martin Baulig  <martin@ximian.com>

	* arch/BfdDisassembler.cs: Store the delegates in a class field
	before passing them to native code, so they're not garbage
	collected.

	* classes/TargetLocation.cs (TargetLocation.ReadAddress): New
	public method.

	* frontends/scripting/Command.cs (PrintCommand.Format): Added
	`Address' format ("/a", "/address").

2004-09-02  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoCSharpLanguageBackend.GetTrampoline): Catch symbol file
	exceptions and silently return null.

2004-08-27  Martin Baulig  <martin@ximian.com>

	* arch/DwarfReader.cs (DwarfReader.read_pubnames): Ignore
	duplicate entries.

2004-07-12  Martin Baulig  <martin@ximian.com>

	* interfaces/ILanguage.cs (ILanguage.CreatePointer): New method.

2004-07-12  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetClassObject.cs
	(ITargetClassObject.CurrentType): New property.

	* frontends/scripting/Expression.cs (CastExpression): Allow a cast
	to the current type.

2004-07-12  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs: Reflect
	latest runtime changes.

2004-07-07  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs
	(Callback.ProcessEvent): Added `out TargetEventArgs'.
	(SingleSteppingEngine.ProcessEvent): Only send an event if the
	callback told us to do so.

2004-07-07  Martin Baulig  <martin@ximian.com>

	* backends/ILanguageBackend.cs
	(ILanguageBackend.GetVirtualMethodFunc): New property.

	* wrapper/wrapper.c (MonoDebuggerInfo): Added
	`get_virtual_method', which calls mono_object_get_virtual_method().

	* backends/SingleSteppingEngine.cs (CallbackruntimeInvoke): Call
	the `GetVirtualMethodFunc' to get the actual method from the vtable.

2004-07-07  Martin Baulig  <martin@ximian.com>

	* backends/native/NativeLanguage.cs: Make this a "real" language
	backend, ie. we just create one instance of it and it's also doing
	type lookups.
	(NativeLanguage): The .ctor now also takes the BfdContainer.
	(NativeLanguage.LookupType): Implemented.

	* arch/DwarfReader.cs (DwarfReader.LookupType): New public method.

2004-07-06  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetPointerType.cs
	(ITargetPointerType.IsArray): New property.

	* interfaces/ITargetPointerObject.cs
	(ITargetPointerObject.GetArrayElement): New method.

2004-07-06  Martin Baulig  <martin@ximian.com>

	* arch/DwarfReader.cs: Added support for bitfields.

2004-07-06  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoSymbolTable): Derive from Module; we put all icall wrappers
	into their own "<Mono Runtime>" module.
	(MonoSymbolTable.WrapperMethod): New private class; we now get the
	icall wrappers from the JIT.

2004-07-02  Martin Baulig  <martin@ximian.com>

	* backends/server/i386-arch.c (i386_arch_child_stopped): Reset
	DR_STATUS if we hit a hardware breakpoint.

2004-07-02  Martin Baulig  <martin@ximian.com>

	* frontends/command-line/ExpressionParser.jay: Added `->' syntax
	for pointer dereference + member access.

2004-07-02  Martin Baulig  <martin@ximian.com>

	* backends/ThreadManager.cs (ThreadManager.AcquireGlobalThread):
	Fixed a bad deadlock.

2004-07-02  Martin Baulig  <martin@ximian.com>

	* backends/server/mutex.c (DebuggerEvent): New typedef.
	(mono_debugger_event_new): New function.
	(mono_debugger_event_wait): New function.
	(mono_debugger_event_trywait): New function.
	(mono_debugger_event_signal): New function.

	* classes/Threading.cs (DebuggerAutoResetEvent): Use the new
	unmanged event functions from mutex.c.

2004-07-02  Martin Baulig  <martin@ximian.com>

	* classes/Report.cs: There's now MDB_DEBUG_FLAGS environment
	variable which sets the default debugging flags and a
	MDB_DEBUG_OUTPUT one which redirects the debugging output into a
	file.	

2004-07-02  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs
	(SingleSteppingEngine.Callback): Make this class abstract, moved
	the callback code into classes derived from this.

2004-06-30  Martin Baulig  <martin@ximian.com>

	* classes/ObjectCache.cs: Don't make the `objects' ArrayList
	synchronized, protect it with a mutex instead.  This seems to fix
	the deadlock.

	* classes/Threading.cs (DebuggerMutex): Use GMutex instead of Mono
	mutexes.

	* backends/server/breakpoints.h (BreakpointManager): Removed the
	`lock_func' and `unlock_func'.
	(mono_debugger_breakpoint_manager_new): Don't take the function
	pointers as arguments anymore.
	(mono_debugger_breakpoint_manager_lock): Don't take any arguments,
	this is now global.
	(mono_debugger_breakpoint_manager_unlock): Likewise.

	* backends/server/breakpoints.c: Use a GStaticRecMutex.

	* backends/server/mutex.[ch]: New files.

2004-06-30  Martin Baulig  <martin@ximian.com>

	* classes/ProcessStart.cs (ProcessStart.SetupEnvironment): Don't
	pass GC_DONT_GC to our child.

2004-06-30  Martin Baulig  <martin@ximian.com>

	* classes/Threading.cs (DebuggerWaitHandle.Debug): New protected
	method.  Only call Report.Debug, if we're actually debugging.

2004-06-30  Martin Baulig  <martin@ximian.com>

	* backends/ILanguageBackend.cs
	(NotificationType.ThreadAbort): New notification.

	* backends/MonoThreadManager.cs
	(MonoThreadManager.HandleChildEvent): Handle thread abort.	

2004-06-29  Martin Baulig  <martin@ximian.com>

	* classes/Threading.cs (DebuggerWaitHandler.DebugFlags): New
	public field; default to DebugFlags.Mutex.

	* backends/BreakpointManager.cs: Set DebugFlags.BreakpointManager
	on our mutex.

2004-06-29  Martin Baulig  <martin@ximian.com>

	* backends/server/server.h
	(mono_debugger_server_get_signal_info): Changed type of last
	argument to `SignalInfo **'; returns a pointer to the g_new()ed
	SignalInfo struct.

	* backends/ptrace/PTrace.cs (PTraceInferior.SetupInferior):
	Correctly marshal the SignalInfo struct.

2004-06-29  Martin Baulig  <martin@ximian.com>

	* backends/server/server.h (SignalInfo): Removed `sigprof',
	`sigpwr', `sigxcpu', `thread_abort', `thread_restart',
	`thread_debug' and `mono_thread_debug'; added `mono_thread_abort'.

	* backends/Inferior.cs (Inferior): Removed the corresponding
	properties.	

2004-06-29  Martin Baulig  <martin@ximian.com>

	* backends/server/library.c (mono_debugger_server_static_init):
	Don't override the mono thread abort signal.

2004-06-29  Martin Baulig  <martin@ximian.com>

	* wrapper/Makefile.am: Don't install Mono.Debugger.dll in
	$(libdir), it only goes into the GAC.

2004-06-29  Martin Baulig  <martin@ximian.com>

	* classes/ProcessStart.cs (ProcessStart.SetupEnvironment):
	Correctly process the environment here; if the user explicitly
	sets an env var in `UserEnvironment', it overrides the value
	inherited from our environment.
	(DebuggerOptions.MonoPrefix): Added "--mono-prefix" command line
	argument.  Sets the MONO_GAC_PREFIX, MONO_PATH, LD_LIBRARY_PATH
	and PATH in the inferior.

2004-06-29  Martin Baulig  <martin@ximian.com>

	* classes/ProcessStart.cs
	(ProcessStart.Arguments): Renamed to `UserArguments'.
	(ProcessStart.Environment): Renamed to `UserEnvironment'.
	(ProcessStart.Environment): New public property.	

2004-06-29  Martin Baulig  <martin@ximian.com>

	* classes/ProcessStart.cs (DebuggerOptions.JitWrapper): Removed.

	* frontends/command-line/Main.cs: Removed all the `AssemblyInfo'
	attributes.

	* wrapper/Makefile.am: Also include our generated AssemblyInfo.cs
	in mdb.exe.	

2004-06-29  Martin Baulig  <martin@ximian.com>

	* arch/Makefile.am: Don't install libmonodebuggerbfdglue.la, link
	it into libmonodebuggerserver.la instead.

	* wrapper/Mono.Debugger.dll.config.in: Provide a .config file for
	Mono.Debugger.dll and map "monodebuggerserver" to the full path
	name of the installed library.

2004-06-29  Martin Baulig  <martin@ximian.com>

	* wrapper/mono-debugger-jit-wrapper.h (MonoDebuggerManager): Added
	`guint32 thread_size' (which is `sizeof (MonoDebuggerThread)') and
	removed `thread_manager_notification'.
	(NOTIFICATION_THREAD_CREATED): New notification.

	* wrapper/thread-manager.c
	(mono_debugger_thread_manager_add_thread): Use the normal
	mono_debugger_notification_function() notification mechanism; the
	`notification_function' is gone.

	* backends/MonoThreadManager.cs
	(MonoThreadManager.managed_handler): Removed.
	(MonoThreadManager.thread_created): Call this via the
	NotificationType.ThreadCreated notification.
	(MonoThreadManager.do_initialize): Call thread_created() on the
	`main_thread'; this is very important because it tells GC about
	the main thread's stack.

2004-06-29  Martin Baulig  <martin@ximian.com>

	* backends/server/i386-linux-ptrace.c
	(_server_ptrace_setup_thread_manager): Don't set
	PTRACE_O_TRACEFORK and PTRACE_O_TRACEVFORKDONE; we don't follow
	forks yet.

2004-06-29  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetMemoryAccess.cs
	(ITargetAccess.InsertBreakpoint): New method.

	* backends/Process.cs (BreakpointCheckHandler): Added
	`ITargetAccess target' argument.

	* classes/Breakpoint.cs (Breakpoint.CheckBreakpointHit): Added
	`ITargetAccess target' argument.

	* classes/SourceInfo.cs (MethodLoadedHandler): Take an
	ITargetAccess argument instead of an Inferior.

	* arch/Bfd.cs (Bfd.dynlink_handler): Use the `ITargetAccess' which
	we got as argument; this breakpoint may be hit on a different
	thread than the one we used to insert it, so we can't pass the
	`Inferior' as `user_data'.

2004-06-29  Martin Baulig  <martin@ximian.com>

	* interface/ISymbolTable.cs (Symbol): New class.
	(ISimpleSymbolTable.SimpleLookup): Return a `Symbol', not a
	string.

	* arch/ArchitectureI386.cs (ArchitectureI386.UnwindStack): Added
	some "hacks" for special functions.

2004-06-26  Martin Baulig  <martin@ximian.com>

	* classes/StackFrame.cs (SimpleStackFrame): New public class.
	Moved the stack frame's actual data here.

2004-06-26  Martin Baulig  <martin@ximian.com>

	* arch/Bfd.cs: Use correct start/end addresses.

	* arch/DwarfReader.cs (DwarfException, DwarfBinaryReader): Don't
	nest these two classes in DwarfReader.

	* arch/DwarfFrameReader.cs: New file.

	* classes/Module.cs (Module.UnwindStack): New abstract method.

2004-06-25  Martin Baulig  <martin@ximian.com>

	* classes/StackFrame.cs (Registers): New public class.
	(StackFrame.WriteRegister): New public method to modify the
	register.	

	* interfaces/IArchitectures.cs
	(IArchitecture.RegisterSizes): New property.

	* backends/Inferior.cs (Inferior.GetRegisters): Return a
	`Registers', not a `Register[]'.
	(Inferior.SetRegisters): Take a `Registers' argument, not a
	`Register[]' one.

	* backends/Process.cs (Process.GetRegisters): Return a
	`Registers', not a `Register[]'.
	(Process.SetRegisters): Take a `Registers' argument, not a
	`Register[]' one.

2004-06-25  Martin Baulig  <martin@ximian.com>

	* classes/StackFrame.cs (Register.Data): Renamed to `Value' and
	changed type to long.

2004-06-25  Martin Baulig  <martin@ximian.com>

	* backends/Process.cs (Process.RuntimeInvoke): Take a `StackFrame'
	argument instead of an `ILanguageBackend' one; make them public.
	(Process.MyStackFrame): Killed this class.

	* backends/Backtrace.cs (Backtrace..ctor): Only take the first
	frame as argument.
	(Backtrace.GetBacktrace): New public method; unwind the stack to
	actually get the backtrace.

	* classes/StackFrame.cs (Register.Valid): New public property.
	(Register.SetValue): New public method.
	(StackFrame): Make this class sealed, not abstract.
	(StackFrame.Process): New public property.
	(StackFrame.CallMethod, StackFrame.RuntimeInvoke): Removed, use
	the methods in Process.

	* interfaces/IArchitecture.cs (IArchitecture.UnwindStack):
	Replaced the two overloaded versions which one single one which
	takes a stack frame and returns a stack frame.

	* interfaces/IMethod.cs (IMethod.UnwindStack): New method.

2004-06-25  Martin Baulig  <martin@ximian.com>

	* interfaces/IArchitecture
	(IArchitecture.CountRegisters): New property.

	* interfaces/ITargetMemoryAccess.cs
	(ITargetMemoryAccess.GetRegister): Removed.

	* backends/Inferior.cs (Inferior.GetStackPointer): Removed.
	(Inferior.GetRegister, Inferior.SetRegister): Removed.
	(Inferior.GetRegisters, Inferior.SetRegisters): Don't take an
	array of register indices; we always get/set all registers and
	they're always in the correct order.

	* backends/server/server.h
	(mono_debugger_server_get_registers): Removed the `count' and
	`registers' argument; always return all registers.
	(mono_debugger_server_set_registers): Likewise.

2004-06-25  Martin Baulig  <martin@ximian.com>

	* backends/server/server.h (InferiorVTable): Renamed `get_pc' to
	`get_frame'; changed argument to `StackFrame *frame', this is an
	"out ServerStackFrame" argument.

	* backends/Inferior.cs (mono_debugger_server_get_frame): This now
	has an "out ServerStackFrame" argument; use it to get the current
	frame rather than creating a 1-frame-backtrace.

2004-06-25  Martin Baulig  <martin@ximian.com>

	* classes/StackFrame.cs
	(StackFrame.Registers): Don't make this abstract.
	(StackFrame..ctor): Take the registers as argument.
	(StackFrame.DisassembleInstruction): Removed.
	(StackFrame.DisassembleMethod): Removed.

	* backends/Process.cs (Process.CreateFrame): Added `Register[]'
	argument, removed the `Backtrace' argument.	

2004-06-25  Martin Baulig  <martin@ximian.com>

	* classes/TargetException.cs (TargetExceptionType): Renamed to
	TargetError and synced this with the error codes from the unmanged
	code in backends/server/server.h.

	* backends/Inferior.cs (CommandError): Removed, we now use
	TargetError from classes/TargetException.cs.

2004-06-25  Martin Baulig  <martin@ximian.com>

	* classes/TargetException.cs
	(TargetExceptionType): New public enum.
	(TargetException): Don't make this abstract; the .ctor now takes a
	TargetExceptionType argument.

2004-06-25  Martin Baulig  <martin@ximian.com>

	* classes/TargetInvocationException.cs
	(TargetInvocationException): Don't derive from TargetException.

	* classes/TargetException.cs (MethodOverloadException): Removed.

	* backends/mono-csharp/MonoFunctionType.cs: Throw an
	ArgumentException, not a MethodOverloadException.

2004-06-23  Martin Baulig  <martin@ximian.com>

	* backends/server/i386-arch.c (server_ptrace_get_backtrace): Added
	a 0x0xffffe002 (NPTL syscall trampoline) hack.

	* arch/ArchitectureI386.cs
	(ArchitectureI386.GetCallTarget): Likewise.

2004-06-23  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Command.cs (LookupCommand): New command.

2004-06-23  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Command.cs (PrintFrameCommand): Only derive
	from ProcessCommand, not from FrameCommand.  Parse the arguments
	to get the (optional) frame number.
	(SelectProcessCommand): Only derive from DebuggerCommand, not from
	ProcessCommand.  Parse the arguments to get the (optional) process
	number.	

2004-06-23  Martin Baulig  <martin@ximian.com>

	* backends/server/server.h
	(mono_debugger_server_insert_hw_breakpoint): Automatically search
	for a free debug register and return it in `idx' (made this an
	`guint32 *idx' out param).

	* backends/Inferior.cs (Inferior.InsertHwBreakpoint): Made `idx'
	and "out" parameter and added `bool fallback'.  We now search for
	an empty debug register and return it in `idx'.  If none can be
	found and `fallback' is set, insert a normal breakpoint.

	* backends/SingleSteppingEngine.cs
	(SingleSteppingEngine.insert_temporary_breakpoint): Try to insert
	a hardware breakpoint and set the fallback flag.

2004-06-23  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs (SingleSteppingEngine.Start):
	Make this method internal and make new threads run in the background.

2004-06-23  Martin Baulig  <martin@ximian.com>

	* classes/Threading.cs: New public class.  Contains wrappers
	around Mutex, ManualResetEvent and AutoResetEvent which have some
	debugging support.

2004-06-21  Martin Baulig  <martin@ximian.com>

	* interfaces/ILanguage.cs (ILanguage.CreateObject): New method.

	* frontends/scripting/Expression.cs
	(CatchExpression): New expression.

	* frontends/command-line/Tokenizer.cs: Added `catch' keyword.

2004-06-21  Martin Baulig  <martin@ximian.com>

	* classes/TargetEvent.cs
	(TargetEventType): Added `UnhandledException'.

	* backends/SingleSteppingEngine.cs: Send a
	TargetEventType.UnhandledException when we catch an unhandled
	exception.	

2004-06-21  Martin Baulig  <martin@ximian.com>

	* backends/ILanguageBackend.cs
	(NotificationType.UnhandledException): New notification.

	* backends/Inferior.cs (Inferior.RuntimeInvoke): Added
	`bool debug' argument; if true we don't pass an exception pointer
	to mono_runtime_invoke() so it'll actually throw exceptions.

	* backends/SingleSteppingEngine.cs: If we caught an unhandled
	exception, continue until mono_handle_exception() restored the
	stack for us and then stop.

2004-06-21  Martin Baulig  <martin@ximian.com>

	* backends/ThreadManager.cs: If we caught a SIGINT, call
	Interrupt() on all non-deamon SSE's.

	* backends/SingleSteppingEngine.cs
	(SingleSteppingEngine.Interrupt): Call Inferior.Stop(), not
	Inferior.GlobalStop().	

2004-06-21  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Command.cs (CallCommand): New command.

2004-06-21  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Expression.cs
	(ThisExpression, BaseExpression): New public classes.

2004-06-21  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Expression.cs
	(ParentClassExpression): Removed.

2004-06-20  Martin Baulig  <martin@ximian.com>

	* classes/SourceInfo.cs (SourceInfo.FindMethod): Removed.

	* clases/Module.cs (Module.FindMethod): Call
	ISymbolFile.FindMethod() directly rather than looping over all the
	source files.

2004-06-20  Martin Baulig  <martin@ximian.com>

	* arch/DwarfReader.cs: Read the .debug_pubnames section and use it
	for name based lookups.

	* classes/ISymbolFile.cs (ISymbolFile.FindMethod): New method.

	* classes/SourceInfo.cs (SourceFile.FindMethod): Use
	ISymbolFile.FindMethod() rather than looping over all the methods.

2004-06-19  Martin Baulig  <martin@ximian.com>

	* classes/MethodSource.cs (MethodSource.GetNamespaces): New public
	virtual property.

	* backends/mono-csharp/CSharpMethod.cs
	(CSharpMethod.GetNamespaces): Overload.

	* frontends/scripting/Expression.cs (SimpleNameExpression): Do a
	namespace lookup.

2004-06-18  Martin Baulig  <martin@ximian.com>

	* frontends/command-line/ExpressionParser.jay: Added support for
	parenthesized expressions and allow the left side of a member
	access to be an expression.

2004-06-18  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Expression.cs (CastExpression): New
	expression.  Currently only works from a class type to one of its
	parent classes.

2004-06-18  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoClass.cs: If we have a parent class,
	correctly index our fields, properties and methods so we can
	distinguish members from our parent class.

2004-06-18  Martin Baulig  <martin@ximian.com>

	* backends/Inferior.cs (Inferior.GetCurrentFrame): New internal
	function; this is a more reliable way of getting the inner
	Inferior.StackFrame.	

2004-06-18  Martin Baulig  <martin@ximian.com>

	* backends/ILanguageBackend.cs
	(ILanguageBackend.GetTrampolineAddress): Added `out bool is_start';
	if true, then the return address is the start of the trampoline
	function and we need to FinishNative through it.

2004-06-18  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs (OperationType.FinishNative):
	New stepping operation.  This does a "finish" if we don't have a
	current method by checking the stack pointer.

	* backends/Process.cs (Process.FinishNative): New public method.

	* frontends/scripting/Command.cs (FinishCommand): Added optional
	`-native' argument.

2004-06-17  Martin Baulig  <martin@ximian.com>

	* classes/StackFrame.cs (StackFrame): Added `StackPointer' and
	`FrameAddress'.

	* backends/Inferior.cs
	(Inferior.ServerStackFrame): Added `StackPointer'.
	(Inferior.StackFrame): Added `StackPointer' and `FrameAddress'.

	* frontends/scripting/Command.cs (ShowFrameCommand): Added
	`show frame' command to get information about the current stack
	frame.	

2004-06-17  Martin Baulig  <martin@ximian.com>

	* arch/CoreFile.cs: Removed.
	* arch/CoreFileElfI386.cs: Removed.

2004-06-17  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Command.cs (DisassembleCommand): Take an
	optional pointer expression, add auto-repeat support.

2004-06-17  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/ScriptingContext.cs
	(ScriptingContext.LastExamineAddress): Removed.

	* frontends/scripting/Command.cs (ExamineCommand): Store the end
	address internally and use it when we're repeating.

2004-06-17  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Main.cs (SetupEngine): `where' is now an
	alias for `backtrace'.

2004-06-17  Martin Baulig  <martin@ximian.com>

	* test/mono-debugger.tests/start-restart.exp: New test.

2004-06-17  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Command.cs (StartCommand): Reenable this.

2004-06-17  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Command.cs
	(AboutCommand): Added `about' command.

2004-06-17  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Expression.cs (NumberExpression): Derive
	from PointerExpression.
	(PointerDereferenceExpression.EvaluateAddress): Removed the
	NumberExpression hack.

2004-06-17  Martin Baulig  <martin@ximian.com>

	* frontends/command-line/CL.cs
	(Command.Repeat): New public virtual method.
	(Engine.Repeat): New public method.

	* frontends/scripting/Command.cs
	(DebuggerCommand.Repeating): New public bool field.
	(DebuggerCommand.Repeat): Just set Repeating and call Execute().	

2004-06-16  Martin Baulig  <martin@ximian.com>

	* backends/BreakpointManager.cs: Don't allow multiple breakpoints
	on the same method.

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoMethod.RegisterLoadHandler): Don't allow multiple load
	handlers on the same method.

2004-06-16  Martin Baulig  <martin@ximian.com>

	* wrapper/: Don't #include <mono/metadata/verify.h>.

2004-06-16  Martin Baulig  <martin@ximian.com>

	* classes/ProcessStart.cs: Added --debug-flags command line
	options to set Report.CurrentDebugFlags.

	* wrapper/Makefile.am: Reference the newly built Mono.Debugger.dll
	and not the one from the gac.

2004-06-12  Martin Baulig  <martin@ximian.com>

	Released version 0.9 "Seven Mile Bridge" of the Mono Debugger :-)

2004-06-12  Martin Baulig  <martin@ximian.com>

	* configure.in, wrapper/Makefile.am: GACify the debugger :-)

	* wrapper/AssemblyInfo.cs: New file.
	* wrapper/mono.snk, wrapper/mono.pub: New files.

2004-06-12  Martin Baulig  <martin@ximian.com>

	* configure.in: Bumped version number to 0.9.

2004-06-12  Martin Baulig  <martin@ximian.com>

	* classes/ThreadGroup.cs (Global, Main): New static public
	properties.  Initialize the "global" and "main" thread group in
	our static .ctor.

2004-06-09  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs: When entering a JIT
	trampoline, breakpoints on that call must remain disabled while
	we're inside the trampoline function.

2004-06-08  Martin Baulig  <martin@ximian.com>

	* frontends/command-line/ExpressionParser.jay: Added
	`&expr' syntax to take the address of an expression.

	* frontends/scripting/Expression.cs
	(PointerDereferenceExpression): Allow NumberExpression's as target
	to make `*0x12345678' and `*305419896' work.

	* frontends/scripting/Command.cs (ExamineCommand): Allow repeating
	this command by typing it again without arguments.  Require a
	pointer expression as argument.

2004-06-03  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/ScriptingContext.cs
	(ScriptingContext.CurrentFrame): Removed the setter.
	(ScriptingContext.CurrentFrameIndex): New property.

2004-06-03  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoFunctionType.cs
	(MonoFunctionType.Invoke): Copy register variables onto the heap.

2004-06-03  Martin Baulig  <martin@ximian.com>

	* test/TestInvocation.cs: New file.

	* test/mono-debugger.tests/TestInvocation.exp: New test.

2004-06-02  Martin Baulig  <martin@ximian.com>

	Released version 0.8 "Wrightsville Beach" of the Mono Debugger :-)

2004-06-01  Martin Baulig  <martin@ximian.com>

	* frontends/command-line/GnuReadline.cs
	(mono_debugger_readline_add_history): This returns `void'.

2004-05-29  Martin Baulig  <martin@ximian.com>

	* arch/bfdglue.c (bfd_glue_get_target_name): Return a g_strdup()ed
	copy since the managed->unmanaged wrapper now g_free()s it.
	(bfd_glue_get_symbol): Likewise.

2004-03-16  Martin Baulig  <martin@ximian.com>

	Released version 0.7 "Wilmington" of the Mono Debugger :-)

2004-04-29  Martin Baulig  <martin@ximian.com>

	* configure.in: Bumped version number to 0.7.

2004-04-26  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Session.cs: New file.

	* arch/Bfd.cs (Bfd): Added serialization support.
	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoSymbolFile): Serializable.

	* classes/Breakpoint.cs, classes/SourceInfo.cs: These are easy,
	just save/load them.

2004-04-26  Martin Baulig  <martin@ximian.com>

	* classes/ProcessStart.cs: Don't make this class abstract.

2004-04-25  Martin Baulig  <martin@ximian.com>

	* arch/Bfd.cs: Improved support for libraries.

	* arch/DwarfReader.cs: Allow reading a library which is not yet
	loaded in memory; ie. read the line number table, but do
	relocations later.

2004-04-23  Martin Baulig  <martin@ximian.com>

	* classes/Module.cs (Module.RegisterLoadHandler): Moved here from
	SourceMethod.

	* classes/SourceInfo.cs (SourceMethod): Don't make this abstract.
	(SourceMethod.RegisterLoadHandler): Moved into Module.

2004-04-23  Martin Baulig  <martin@ximian.com>

	* classes/ISymbolFile.cs: New public interface.

	* classes/SourceInfo.cs (SourceFile): Don't make this abstract.

	* classes/Module.cs (Module.SourceFile): New abstract property.
	(Module.Sources): Moved this property into ISymbolFile.

2004-04-20  Miguel de Icaza  <miguel@ximian.com>

	* frontends/command-line/Main.cs: Add alias for "b" to mean "break"

	* frontends/scripting/Command.cs: Do not try to resolve if we have
	no current process, it leads to a crash.

	(QuitCommand): Derive from CL.Command, so we do not require a
	process to debug to quit.

2004-04-16  Peter Williams  <peter@newton.cx>

	* frontends/scripting/Command.cs: (ShowMethodsCommand.DoResolve):
	Fix paste-o in help text.
	(StepCommand.DoExecute): Call ResetCurrentSourceCode so that a
	'list' command will cause listing to start from the next line.
	Also for next, nexti, stepi, finish, and continue.

2004-04-14  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Command.cs
	(TargetCommand): Renamed this to FrameCommand.
	(ProcessCommand): New abstract base class.	

2004-04-14  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/AssertCommand.cs: Removed.

2004-04-14  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Interpreter.cs (Interpreter): New abstract
	base class.  Moved most of the functionality from ScriptingContext
	here.	

	* frontends/scripting/ScriptingContext.cs (ScriptingContext): This
	is now a real "context".

2004-04-14  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Engine.cs (Engine): New public class.

	* frontends/scripting/Generator.cs: Renamed to Engine.cs

2004-04-14  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Command.cs (TargetCommand): New abstract
	base class.

2004-04-14  Martin Baulig  <martin@ximian.com>

	* frontends/command-line/: Started working on a new command line
	interface.

	* frontends/scripting/Parser.jay: Removed.
	* frontends/scripting/Tokenizer.cs: Removed.

2004-04-14  Martin Baulig  <martin@ximian.com>

	The debugger is unstable at the moment, please use the latest release. 

2004-04-13  Martin Baulig  <martin@ximian.com>

	* wrapper/wrapper.c: Don't call mono_thread_manage(), but send a
	special notification instead.  This tells the MonoThreadManager to
	deal with the main thread.

2004-04-13  Martin Baulig  <martin@ximian.com>

	* wrapper/wrapper.c: Use the Mono I/O-layer instead of POSIX
	semaphores.	

2004-04-13  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoCSharpLanguageBackend): Don't take a `Process' argument.

	* wrapper/: We don't need the command thread anymore.

2004-04-13  Martin Baulig  <martin@ximian.com>

	* classes/BreakpointHandle.cs (BreakpointHandle.Create): New
	internal static method; takes a Process argument to create the
	load handler.

	* classes/SourceInfo.cs (SourceMethod.RegisterLoadHandler): Added
	Process argument.

2004-04-13  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetMemoryAccess.cs
	(ITargetMemoryInfo.Architecture): New property.

	* interface/IMethod.cs (IMethod.GetTrampoline): Added
	ITargetMemoryAccess argument.

	* backends/ILanguageBackend.cs (ILanguageBackend.GetTrampoline):
	Renamed to GetTrampolineAddress() and take an ITargetMemoryAccess
	instead of an Inferior.  Added ITargetMemoryAccess argument to the
	other overloaded version.

2004-04-13  Martin Baulig  <martin@ximian.com>

	Rewrote and simplified the notification code.

	* backends/Inferior.cs (Inferior.ChildEventType): Added
	`CHILD_NOTIFICATION'.  This is a special event which'll be
	returned when the runtime/JIT wants to send us a notification.

	* backends/MonoThreadManager (HandleChildEvent): We're now getting
	all events from the ThreadManager and handle notifications here.

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoCSharpLanguageBackend.DaemonThreadHandler): Removed.
	(MonoCSharpLanguageBackend.Notification): New public method.
	Handle notifications here.

	* backends/server/server.h
	(mono_debugger_server_set_notification): New global function to
	tell the backend about our notification address.  Whenever a
	breakpoint at that address is hit, it's now sending a
	MESSAGE_CHILD_NOTIFICATION.

	* wrapper/wrapper.c: Majorly cleaned this up; use the new
	notification system.	

2004-04-13  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoSymbolFile.GetMethod_internal): Use the full method signature
	as method name.

	* arch/BfdDisassembler.cs (print_address_func): Put back
	trampoline support.

2004-04-13  Martin Baulig  <martin@ximian.com>

	* backends/server/server.h (mono_debugger_server_get_target_info):
	Added `guint32 *is_bigendian'.

2004-04-13  Martin Baulig  <martin@ximian.com>

	* arch/Bfd.cs: Get the name of the target on startup, added
	PowerPC support.

2004-04-13  Martin Baulig  <martin@ximian.com>

	* arch/bfdglue.c (bfd_glue_get_target_name): New function.

2004-04-13  Martin Baulig  <martin@ximian.com>

	* classes/ProcessStart.cs (Options.LoadNativeSymbolTable): Added
	`--native-symtabs' command line option.

2004-04-13  Martin Baulig  <martin@ximian.com>

	* arch/ArchitecturePowerPC.cs: New file.

	* arch/StabsReader.cs: New file.

2004-04-13  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetMemoryAccess.cs
	(ITargetInfo): Added `bool IsBigEndian'.

2004-04-13  Martin Baulig  <martin@ximian.com>

	* backends/server/server.h
	(mono_debugger_server_global_wait): Take a `guint32 *', not a
	`guint64 *'.
	(mono_debugger_server_dispatch_event): `status' is now a
	`guint32', not a `guint64'.

2004-04-10  Martin Baulig  <martin@ximian.com>

	* arch/: Imported Binutils 2.14.

2004-04-09  Martin Baulig  <martin@ximian.com>

	* backends/server/library.c: Put this back.

	* backends/server/server.h: Put the vtable back.
	(mono_debugger_server_get_target_info): Don't take a ServerHandle.
	
2004-04-09  Martin Baulig  <martin@ximian.com>

	* classes/TargetException.cs
	(TargetException): Don't make this abstract.
	(TargetMemoryException): Added parameterless .ctor.	

	* backends/Interior.cs (Inferior.GlobalStop): New public method.

	* backends/SingleStepping.cs (SingleSteppingEngine.Interrupt): Call
	GlobalStop() instead of Stop() on the inferior.

2004-04-09  Martin Baulig  <martin@ximian.com>

	* configure.in: Added private configure option and an automake
	conditional to enable some hacking features - just for me at the
	moment ...

2004-03-16  Martin Baulig  <martin@ximian.com>

	Released version 0.6 "Atlanta" of the Mono Debugger :-)

2004-03-16  Martin Baulig  <martin@ximian.com>

	* RELEASE-NOTES-0.6.txt: New file.

	* configure.in: Check whether we have NPTL support.

2004-03-05  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Parser.jay: Added "repeat" command.

2004-03-05  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs: Use method_has_source()
	everywhere and made it actually work.

	* classes/TargetAddress.cs: Committed an ugly hack to the .ctor;
	since we're currently only running on the i386, we can just throw
	the upper 32 bits away to work around some marshalling issues.

2004-03-05  Martin Baulig  <martin@ximian.com>

	* wrapper.c (compile_method): Return a guint64.

2004-03-05  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs (method_has_source): New
	private method to check whether a method has source code; it's
	used to determine whether we should enter a method while doing a
	source stepping operation.

	* classes/SourceFileFactory (SourceFileFactory.Exists): New public
	method; just checks whether the file exists without opening it.

2004-03-05  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs (callback_method_compiled):
	Step over it if we're performing a source stepping operation and
	the method doesn't have any source code.

2004-03-04  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs (ProcessCommand): Call Step()
	for OperationType.Run and OperationType.RunInBackground.
	(Step, DoStep): Allow OperationType.Run(InBackground).

2004-03-04  Martin Baulig  <martin@ximian.com>

	* classes/Backtrace.cs (Length): Return 0 if we don't have any
	frame.

	* classes/SourceAddress.cs (ToString): Return "filename:linenum".	

2004-03-04  Martin Baulig  <martin@ximian.com>

	* backends/server/i386-linux-ptrace.c
	(mono_debugger_server_stop_and_wait): Make this work reliably; if
	mono_debugger_server_global_wait() is running while we're being
	called, "steal" its return value and return it here.

2004-03-04  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs (SendSyncCommand): Allow sync
	commands to be run from the background thread, ie. inside an event
	handler.

2004-03-04  Martin Baulig  <martin@ximian.com>

	* classes/Breakpoint.cs (BreakpointEventHandler): Added additional
	StackFrame argument.

2004-03-04  Martin Baulig  <martin@ximian.com>

	* backends/Debugger.cs (DebuggerBackend.Initialize): Renamed this
	to DoInitialize() and added a static Initialize().

	* backends/SingleSteppingEngine.cs (Kill): New public method.

	* backends/server/i386-linux-ptrace.c: Protect do_wait() by a mutex.
	(_mono_debugger_server_setup_inferior): Wait until the target
	actually stopped.

2004-03-03  Martin Baulig  <martin@ximian.com>

	* backend/server/i386-ptrace.c (mono_debugger_server_initialize):
	Catch mono's thread abort signal and call pthread_exit(NULL) in it.

2004-03-03  Martin Baulig  <martin@ximian.com>

	* backends/Debugger.cs (DebuggerBackend.Run): Changed return type
	to void; don't wait until the application is started.

	* backends/ThreadManager.cs (ThreadManager.StartApplication):
	Changed return type to void.
	(ThreadManager.WaitForApplication): New public method.
	(ThreadManager.ReachedMain): Fire the events here.

2004-03-03  Martin Baulig  <martin@ximian.com>

	* lib/: Removed.

	* lib/Debugger.exe.config.in: Removed.
	* lib/Interpreter.exe.config.in: Removed.

	* lib/Makefile.am: Build everything in ../wrapper/.

	* wrapper/mdb.in: Moved here from ../lib.

	* wrapper/Makefile.am: Call it mdb.exe instead of Interpreter.exe.

	* classes/ProcessStart.cs: The `mono-debugger-mini-wrapper' is now
	always in the same directory than Mono.Debugger.dll; use this to
	setup the 'Path_Mono'.

2004-03-02  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoSourceMethod.IsLoaded): Call ensure_method().

	* frontends/scripting/Expression.cs (SourceExpression): Added
	support for source file and line number.

	* frontends/scripting/Parser.jay (source_expression): Added
	"STRING COLON INTEGER" syntax.

2004-03-02  Mike Kestner  <mkestner@ximian.com>

	* configure.in : expand pc.in
	* Makefile.am : install pc and dist pc.in
	* mono-debugger.pc.in: new

2004-03-02  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine (EndStackAddress): New internal field.
	(AcquireThreadLock): Return void; if we have an `EndStackAddress',
	write our esp into it.

	* backends/MonoThreadManager.cs: Added back GC support.

2004-03-02  Martin Baulig  <martin@ximian.com>

	* configure.in: Bumped version number to 0.6.  This is not a
	release, but 0.5 was the old Clemson release.

2004-03-02  Martin Baulig  <martin@ximian.com>

	* classes/SimpleBreakpoint.cs: Added simpler .ctor.

2004-01-16  Martin Baulig  <martin@ximian.com>

	* classes/BreakpointHandle.cs: The .ctors don't take a `Process'
	argument anymore; you need to call EnableBreakpoint() to actually
	enable the breakpoint.

2004-01-16  Martin Baulig  <martin@ximian.com>

	* interfaces/IMethod.cs (IMethodSource): Removed this interface;
	the abstract class `MethodSource' is identical to this interface.

	* classes/MethodSource.cs (MethodSource.MethodLookup): Removed.

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs: Removed the
	old method lookup code.

	* lib/SymbolFileReader.cs: Removed.

2004-01-16  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs: Merged
	MonoSymbolFile and MonoModule.

2004-01-16  Martin Baulig  <martin@ximian.com>

	* arch/Bfd.cs: Merged with BfdModule.

	* arch/BfdModule.cs: Removed.

2004-01-16  Martin Baulig  <martin@ximian.com>

	* classes/Module.cs: Made this class abstract and merge it with
	ModuleData; modules can't be "unloaded" anymore.

	* classes/ModuleData.cs: Removed.

2004-01-16  Martin Baulig  <martin@ximian.com>

	* backends/BreakpointManager.cs (BreakpointManager.Handle):
	Removed this class; BreakpointManager now uses `Breakpoint'.

	* backends/Process.cs (Process.InsertBreakpoint): Just take a
	`Breakpoint' and a `TargetAddress'.

	* classes/Breakpoint.cs (Breakpoint.ThreadGroup): New property.
	(Breakpoint.Breaks): New method; moved here from BreakpointHandle.

	* classes/ModuleData.cs (ModuleData.EnableBreakpoint): Removed.
	(ModuleData.DisableBreakpoint): Removed.

	* classes/SimpleBreapoint.cs: Added .ctor which takes a
	BreakpointCheckHandler and a BreakpointHitHandler delegate.

2004-01-16  Martin Baulig  <martin@ximian.com>

	Merged Mono.Debugger.dll and Mono.Debugger.Backend.dll.

	* backends/classes/NativeModule.cs: Removed.

	* backends/Debugger.cs: Removed the breakpoint code from here.

	* backends/SingleSteppingEngine.cs: We can now step over
	breakpoints again.

	* classes/Breakpoint.cs (Breakpoint.Enabled): Removed this
	property.

	* classes/BreakpointHandle.cs: Reworked this class; it's now
	public and you call EnableBreakpoint() and DisableBreakpoint() on
	it to enable/disable breakpoints.

	* classes/Module.cs: Removed the breakpoint code from here.	

2004-01-15  Martin Baulig  <martin@ximian.com>

	* classes/TargetEvent.cs (TargetEventType): Added `FrameChanged'.

	* backends/SingleSteppingEngine.cs: Emit a
	TargetEventType.FrameChanged event after completing a callback.

2004-01-15  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Expression.cs (SourceExpression): The .ctor
	now just takes a VariableExpression and line number.  We try to
	resolve the expr as a method and then use the new
	ITargetFunctionType.Source to get its source.
	(VariableExpression): Added virtual `DoResolveBase' which is
	always called before any of the other `DoResolve*' methods.

2004-01-15  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetFunctionType.cs (Source): New property.

2004-01-15  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend: Renamed
	`MonoSymbolTableReader' to `MonoSymbolfile'.

	* backends/mono-csharp/: We're now passing the `MonoSymbolFile'
	instead of the `MonoSymbolTable' to the types.

2004-01-15  Martin Baulig  <martin@ximian.com>

	The big rewrite and cleanup.

	The debugger now requires either Red Hat 9 or glibc 2.3.x and a
	2.6.0 kernel.	It does not work with a 2.4.x kernel except the
	one from Red Hat 9.

	* backends/Process.cs: This is now in backends again, it is a
	public (non-abstract) class and contains the "user interface" of
	the SingleSteppingEngine.

	* backends/SingleSteppingEngine.cs: This is now just the engine
	itself; we create on SingleSteppingEngine class per target thread,
	but they're all managed from the ThreadManager and we just have
	one thread in the debugger.

	* backends/ThreadManager.cs: Contains the main event loop and
	dispatches events and commands to the SingleSteppingEngines.

2003-12-29  Martin Baulig  <martin@ximian.com>

	WARNING WARNING WARNING WARNING:

	Everything newer than the Clemson release is highly experimental
	and will not work out-of-the-box.  You should not use the CVS
	version of the debugger unless you know exactly what you're doing.

2003-12-25  Martin Baulig  <martin@ximian.com>

	* backends/server/: Removed the `InferiorInfo' vtable; call the
	functions directly.

	* backends/server/library.c: Removed.

	* backends/server/i386-ptrace.c: Call functions
	`mono_debugger_server_*' and make them public.	

2003-12-15  Martin Baulig  <martin@ximian.com>

	* classes/GnuReadLine.cs: Check whether readline is supported and
	use Console.ReadLine() if not.

	* glue/Check whether readline is supported.

2003-12-15  Martin Baulig  <martin@ximian.com>

	* configure.in: Allow windows.
	(glue_cflags, server_cflags): AC_SUBST() them.

	* backends/server/i386-win32.c: Initial windows port.

2003-12-15  Martin Baulig  <martin@ximian.com>

	* arch/bfdglue.c (bfd_glue_elfi386_locate_base): This is only
	supported on Linux and FreeBSD.

2003-12-15  Martin Baulig  <martin@ximian.com>

	* backends/IInferior.cs (IInferior): Made this interface internal.
	(IInferior.RuntimeInvoke, IInferior.GetRegister): Removed; they're
	inherited from ITargetAccess.

	* backends/ILanguageBackend.cs: Made this interface internal.

	* backends/DaemonThreadRunner.cs: Made this class internal.

	* backends/Process.cs (Process.TargetOutput, DebuggerOutput,
	DebuggerError): Made these events public.

	* backends/SingleSteppingEngine.cs: Made the .ctor internal.	

2003-12-15  Martin Baulig  <martin@ximian.com>

	* classes/IOChannel.cs (Spawn): Removed this obsolete class.

	* glue/iochannel.c (mono_debugger_glue_kill_process): Removed.

2003-12-15  Martin Baulig  <martin@ximian.com>

	* backends/IInferior.cs (IInferior): Added properties for the
	signal numbers.

	* backends/ptrace/PTrace.cs: We're now getting the signal numbers
	in a `SignalInfo' structure from the inferior; the corresponding
	properties are no longer static.

2003-12-15  Martin Baulig  <martin@ximian.com>

	* backends/server/: Did some API cleanups; separate
	architecture-specific code a bit more.

	* backends/server/i386-arch.c (ArchInfo): New struct; store all
	architecture-specific stuff here.

2003-12-09  Martin Baulig  <martin@ximian.com>

	Released version 0.5 "Clemson" of the Mono Debugger :-)

2003-11-06  Martin Baulig  <martin@ximian.com>

	* configure.in: Completely disable the GUI for the moment.

2003-09-13  Martin Baulig  <martin@ximian.com>

	* arch/ArchitectureI386.cs (ArchitectureI386.UnwindStack): Use
	`(long) (uint)' instead of just `(long)' to make this work for
	registers having "negative" values (0xbfffffec for instance).

	* frontends/scripting/ScriptingContext.cs
	(FrameHandle.PrintVariable): Format this nicely.

2003-09-08  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/: When invoking a method with the `call'
	command, debug the invoked method.  See the NEWS file for details.

	* backends/IInferior.cs (IInferior.CallInvokeMethod): Removed.
	(IInferior.RuntimeInvoke): New method; there are two overloaded
	versions: one is similar to the old CallInvokeMethod() and the
	other one allows us to debug the invoked method.

	* backends/ILanguageBackends.cs
	(ILanguageBackend.RuntimeInvokeFunc): New property.
	(ILanguageBackend.CompileMethod): New method.

	* backends/SingleSteppingEngine.cs
	(SingleSteppingEngine.CallInvokeMethod): Renamed to RuntimeInvoke().
	(SingleSteppingEngine.RuntimeInvoke): Added overloaded version
	which allows us to debug the invoked function.

	* interfaces/ITargetFunctionObject.cs
	(ITargetFunctionObject.Invoke): Added `bool debug' argument; if
	true, debug the invoked method.

	* interfaces/ITargetFunctionType.cs
	(ITargetFunctionType.Invoke): Added `bool debug' argument; if
	true, debug the invoked method.

2003-09-07  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetStructType.cs
	(ITargetStructType.Constructors): New property.
	(ITargetStructType.GetConstructor): New method.

	* frontends/scripting/Parser.jay (variable_expression): Added `new
	type (args)' syntax to invoke a constructor.

2003-08-12  Martin Baulig  <martin@ximian.com>

	* classes/StackFrame.cs (StackFrame.GetRegister): Removed.
	(StackFrame.GetRegisterLocation): New public method.

	* backends/native/NativeLanguage.cs: The .ctor now takes an
	ITargetInfo because NativePointerType needs the target address
	size.

	* backends/native/NativePointerType.cs: Always set the correct
	size.

	* frontends/scripting/VariableExpression.cs
	(RegisterExpression.ResolveLocation): New public method.  This is
	used when resolving an `x %eax'.

2003-08-11  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Parser.jay: Use a colon instead of a dot to
	separate a type name and its static member.  This deambiguates the
	grammar and also allows things like
	'print System.DateTime:MinValue.Ticks'.

2003-08-11  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/ScriptingContext.cs
	(ScriptingContext.Print): Don't call String.Format() on already
	formatted strings; this'll cause problems if the string contains
	any '{' or '}'s.

2003-08-11  Martin Baulig  <martin@ximian.com>

	* backends/IInferior.cs (IInferior.CallMethod): This method now
	takes two `long' arguments.

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoSymbolTable.LookupType): Call `mono_debugger_lookup_type ()'
	in the JIT to do the actual lookup.

2003-08-07  Martin Baulig  <martin@ximian.com>

	* interfaces/ILanguage.cs (ILanguage.LookupType): New method.

	* interfaces/ITargetStructType.cs
	(ITargetMemberInfo): New public interface.
	(ITargetFieldInfo, ITargetPropertyInfo, ITargetMethodInfo): Derive
	from ITargetMemberInfo.

	* frontends/scripting/Parser.jay: Added `Type.StaticField',
	`Type.StaticProperty' and `Type.StaticFunc (args)' syntax to
	access static members of a type without an instance.

2003-08-06  Martin Baulig  <martin@ximian.com>

	* backends/mono-cshap/MonoClass.cs: Added support for static
	fields, properties and methods.

	* interfaces/ITargetMemoryAccess.cs (ITargetAccess.CallMethod):
	Added new overloaded version of this method.

	* interfaces/ITargetStructType.cs (ITargetStructType): Added
	StaticFields, StaticProperties and StaticMethods properties and
	GetStaticField(), GetStaticProperty() and GetStaticMethod()
	methods.

2003-08-06  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoStringType.cs: We don't get the vtable
	from the JIT anymore; instead we call mono_string_new_wrapper()
	via a special wrapper method to make this work for multiple
	application domains.

2003-08-04  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/*.cs: Completely reworked the type support.
	We're now just creating one single `MonoType' instance per type;
	arrays, strings and enums now also derive from MonoClass which
	allows us to access the System.Array, System.String and
	System.Enum members.

2003-07-28  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Tokenizer.cs: Allow identifiers to be quoted
	in apostrophs (').

	* frontends/scripting/VariableExpression.cs
	(StructAccessExpression): Do a simple overload resolution for methods.

2003-07-22  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoClass.cs: New class.  This is now used
	for class and value types and also for fundamental types; it
	allows us to call things like `Substring(int)' on a string.

	* backends/mono-csharp/MonoStructType.cs: Moved most of this class
	into MonoClass.

	* backends/mono-csharp/MonoFundamentalType.cs: Derive from
	MonoStructType since a fundamental type is also a valuetype.

2003-07-20  Martin Baulig  <martin@ximian.com>

	Largely improved the type support.  We can now invoke methods with
	arguments and also modify variables.

	* classes/TargetBinaryWriter.cs: New class.

	* interfaces/ITargetFunctionObject.cs (Invoke): The method now
	takes a `object[] args' argument.

	* backends/mono-csharp/*.cs: Improved this a lot; the JIT is now
	providing us with better type information and explicitly tells us
	about builtin types; added support to call methods with arguments;
	it's now possible to modify variables.

2003-07-12  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoStructType.cs: We can now call a
	property's getter function.

2003-07-12  Martin Baulig  <martin@ximian.com>

	Started to added support for calling methods in the target.

	* classes/TargetLocation.cs (TargetMemoryAccess): Renamed to
	TargetAccess and changed type to ITargetAccess.
	* classes/StackFrame.cs: Likewise.

	* classes/RelativeTargetLocation.cs: Made this public.

	* interfaces/ITargetFunctionType.cs (HasReturnValue): New
	property.

	* interfaces/ITargetMemoryAccess.cs
	(ITargetAccess.CallInvokeMethod): New method.

	* interfaces/ITargetStructObject.cs
	(ITargetStructObject.GetMethod): New method.
	(ITargetStructObject.InvokeMethod): Removed.

	* frontends/scripting/Parser.jay: Added `!!' expression which is
	the last VariableExpression which was printed, ie. you can say
	`print !!' to see the last expression again.
	Added '$foo.method ()' syntax to invoke that method.

2003-07-11  Martin Baulig  <martin@ximian.com>

	Added support to modify variables of fundamental types.

	* interfaces/ITargetMemoryAccess.cs
	(ITargetMemoryAccess.WriteBuffer): We don't need a `size' argument
	here since we can just use the buffer's length.

	* interfaces/ITargetFundamentalObject.cs
	(ITargetFundamentalObject.Object): Added setter to this property.

	* frontends/scripting/Parser.jay: Added a `set $variable =
	<expression>' command to modify variables.

2003-07-10  Martin Baulig  <martin@ximian.com>

	* backends/server/server.h (StackFrame): Replaced the
	`locals_address' and `params_address' fields with `frame_address'.

	* backends/ptrace/PTrace.cs (PTraceInferior.StackFrame): Added
	`FrameAddress' field.  We need to keep this structure in sync with
	StackFrame in server.h.

	* arch/ArchitectureI386.cs (UnwindStack): Registers are stored as
	`long's, not as `uint's.

2003-07-05  Martin Baulig  <martin@ximian.com>

	* arch/bfd/elf32-target.h, peigen.c, targmatch.h: Include these
	generated files in CVS and don't rebuild them.

2003-07-05  Martin Baulig  <martin@ximian.com>

	* interfaces/IProcess.cs (GetBacktrace): Added overloaded version
	which takes an `int max_frames' argument.

	* frontends/scripting/Parsing.jay: The `bt' command now takes an
	optional integer argument which is the maximum number of frames to
	include in the backtrace.

2003-07-05  Martin Baulig  <martin@ximian.com>

	Released version 0.4 "New York City" of the Mono Debugger :-)

2003-07-04  Martin Baulig  <martin@ximian.com>

	* backends/DaemonThreadRunner.cs: Rewrote this to use the
	SingleSteppingEngine.  This allows us to debug daemon threads if
	they ever crash.

	* backends/Process.cs: Don't give daemon processes negative IDs.

	* frontends/scripting/ScriptingContext.cs: Don't hide daemon processes.

2003-06-30  Martin Baulig  <martin@ximian.com>

	* arch/bfd: Imported from binutils 2.13.2.
	* arch/libiberty: Likewise.

	* arch/Makefile.am: We now build a minimal libbfd here and include
	it in the libmonodebuggerbfdglue.la.

2003-06-23  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetFunctionType.cs: New class.
	* interfaces/ITargetFunctionObject.cs: New class.

	* interfaces/TargetObjectKind: Added `function'.

	* arch/DwarfReader.cs: More work on native type support.

2003-06-23  Martin Baulig  <martin@ximian.com>

	* arch/DwarfReader.cs: Improved native type support.

	* backends/native/NativeOpaqueObject.cs: New class.
	* backends/native/NativePointerObject.cs: New class.
	* backends/native/NativePointerType.cs: New class.
	* backends/native/NativeStructObject.cs: New class.
	* backends/native/NativeStructType.cs: New class.

	* frontends/scripting/Parser.jay: Added `$foo->test' syntax; allow
	`*($foo.test)' syntax.

	* frontends/scripting/Tokenizer.cs: Don't allow dots in identifiers.

2003-06-22  Martin Baulig  <martin@ximian.com>

	* backends/native/NativeStringType.cs: Derive from
	NativeFundamentalType.

	* backends/native/NativeStringObject.cs: Derive from
	NativeFundamentalObject.

2003-06-21  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetType.cs (GetObject): New method.

	* interfaces/ILanguage.cs: New public interface.

	* classes/Module.cs: Renamed `Language' to `LanguageBackend' and
	added new `Language' property to return the ILanguage.

	* classes/StackFrame (Language): New public property.
	(GetRegister): Added overloaded version which takes the register
	index and an offset and returns a ITargetObject.

	* interfaces/ITargetObject.cs (Location): New property.
	(Print): New function.  Returns a stringified representation of
	the object - suitable to be displayed to the user.

	* interfaces/ITargetPointerObject.cs
	(HasAddress, Address): New properties.

	* interfaces/ITargetType.cs (GetObject): Made this method part of
	the interface.

	* interfaces/TargetObjectKind.cs: Added `Opaque'.

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoSymbolTable): Implement ILanguage.

	* backends/mono-csharp/MonoOpaqueObject.cs: Don't implement
	ITargetPointerObject. Opaque objects are opaque and no pointers.
	* backends/mono-csharp/MonoOpaqueType.cs: Likewise.

	* frontends/scripting/VariableExpression.cs (RegisterExpression):
	Made this a VariableExpression.

	* frontends/scripting/Parser.jay: Added an `examine' command to
	examine memory.  Syntax like gdb's `x' command.

2003-06-21  Martin Baulig  <martin@ximian.com>

	* classes/TargetLocation.cs: Moved here from
	backends/classes/MonoTargetLocation.cs.

	* classes/RelativeTargetLocation.cs: Moved here from
	backends/classes/MonoRelativeTargetLocation.cs.

	* classes/AbsoluteTargetLocation.cs: New public class.

2003-06-20  Martin Baulig  <martin@ximian.com>

	* doc/debugger.sxi: Added the slides from the GUADEC talk.

2003-06-20  Martin Baulig  <martin@ximian.com>

	* interfaces/IArchitecture.cs
	(GetBreakpointTrampolineData): Removed.
	(IsRetInstruction): Added ITargetMemoryAccess argument.
	(GetCallTarget, GetTrampoline): Added ITargetAccess argument.

	* arch/ArchitectureI386.cs: The .ctor doesn't take an
	ITargetAccess argument anymore.  This allows us to use the
	IArchitecture in all threads, not just in the IInferior one.

	* interfaces/IMethod.cs (GetTrampoline): Changed return type from
	TargetAddress to SourceMethod; don't trigger a JIT compilation
	here.

	* backends/ILanguageBackend.cs (GetTrampoline): Added overloaded
	version which takes a TargetAddress and returns a SourceMethod.
	This version doesn't trigger a JIT compilation can may be called
	from all threads.

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoSymbolTable): Added AddImage() and GetImage() methods to get
	a MonoSymbolTableReader from the TargetAddress of a `MonoImage *'.
	(MonoSymbolTableReader): Implement ISimpleSymbolTable.

2003-06-20  Martin Baulig  <martin@ximian.com>

	* wrapper/wrapper.c, wrapper/thread-manager.c: Don't declare
	variables as volatile which are not actually modified by the
	debugger.

2003-06-14  Martin Baulig  <martin@ximian.com>

	* backends/IInferior.cs (IInferiorStackFrame): Removed the
	`LocalsAddress' and `ParamsAddress' properties.
	* classes/StackFrame.cs: Likewise.

	* backends/classes/MonoRegisterLocation.cs: Removed.
	* backends/classes/MonoStackLocation.cs: Removed.

	* backends/classes/MonoVariableLocatin.cs: This is now used for all
	variables, no matter whether they're stored on the stack or in a
	register.  The JIT just distinguishes between variables which are
	stored in a register and variables which are at an offset from a
	register.  This base register can be %ebp or any other register.

2003-06-13  Martin Baulig  <martin@ximian.com>

	* wrapper/wrapper.c: Use POSIX semaphores instead of the mono
	io-layer.  For some reason, using the mono io-layer doesn't work
	on all systems.

2003-06-10  Martin Baulig  <martin@ximian.com>

	* arch/opcodes/: Imported from binutils 2.13.2.

	* configure.in: Don't require libopcodes and dis-asm.h, but use
	the included libopcodes.  Note that we still need libbfd for this.

2003-06-08  Martin Baulig  <martin@ximian.com>

	* frontends/gui/SourceView.cs: Made the context menu actually work.

2003-06-08  Martin Baulig  <martin@ximian.com>

	* frontends/gui/GotoLineDialog.cs: New dialog for "Edit / Goto Line".

2003-05-08  Martin Baulig  <martin@ximian.com>

	* arch/bfdglue.c (bfd_glue_openr): New function.  We need to
	g_strdup() the arguments since bfd_openr() takes their ownership,
	but the P/Invoke wrapper would free it.

2003-05-08  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/CSharpMethod.cs: Suppress duplicate line
	numbers.

	* classes/MethodSource.cs: Re-enable the ObjectCache.

2003-05-04  Martin Baulig  <martin@ximian.com>

	* wrapper/mini-main.c: Always use MONO_OPT_SHARED.

2003-05-04  Martin Baulig  <martin@ximian.com>

	* configure.in: Dropped support for the old JIT, alwasy use Mini.

	* wrapper/main.c: Removed.

2003-04-27  Martin Baulig  <martin@ximian.com>

	Reworked the breakpoint code; we're now getting a callback from
	the JIT when a method containing a breakpoint is JITed instead of
	using the breakpoint trampoline.

	* backends/ILanguageBackend.cs (BreakpointHit): Removed.

	* backends/Debugger.cs (BreakpointHit): Removed.

	* classes/ModuleData.cs (EnableBreakpoint, DisableBreakpoint):
	Removed the ThreadGroup argument.

	* classes/BreakpointManager.cs
	(BreakpointManager.Handle): New public class.
	(InsertBreakpoint, RemoveBreakpoint, LookupBreakpoint): New public
	methods; this class is now responsible for actually inserting all
	breakpoints.

2003-04-22  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoSymbolFileTable.Reload): Don't load any referenced assemblies
	here; we already get a notification from the metadata library when
	it's loading them.

2003-04-21  Martin Baulig  <martin@ximian.com>

	Use a new libzvt based terminal widget to display the target's
	output instead of the old Gtk.TextView based one.

	* configure.in: Require libzvt-2.0.

	* widgets/sources/debuggerwidgets/debuggerterminal.[ch]: New
	files.  This is a new terminal widget using libzvt.

	* widgets/Mono.Debugger.GUI.metadata: New file.

	* frontends/gui/OutputWindow.cs: Use the new DebuggerTerminal widget.

2003-04-21  Martin Baulig  <martin@ximian.com>

	* backends/Debugger.cs (Quit): Removed.

	* frontends/scripting/ScriptingContext.cs (process_events):
	Removed, we don't need to run the glib main loop anymore to get
	the target's output.
	(PrintInferior): Call Write(), not WriteLine().

	* backends/server/i386-ptrace.c (server_ptrace_spawn): Use two
	socketpairs for the target's stdout/stderr and set them to O_ASYNC
	to receive a SIGIO when output becomes available.

	* backends/server/i386-linux-ptrace.c (do_wait): Use sigwait() to
	wait for events from the target; handle I/O.

	* backends/server/library.c (mono_debugger_server_initialize):
	Block the signals in all threads, just unblock them in sigwait()
	which is called from do_wait().

2003-04-17  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MethodAddress.ctor): Use the first and last source line as
	MethodStartAddress and MethodEndAddress, not the prolog/epilog
	data from the JIT.

	* backends/SingleSteppingEngine.cs (get_step_frame): Return a
	StepMode.SingleInstruction frame if we don't have source code, not
	just null.  This is required to handle JIT trampolines correctly
	in a managed method for which we don't have source code.

	* arch/ArchitectureI386.cs (GetCallTarget): Added support for the
	`0xff 0x10' opcodes (call *(%eax)).

2003-04-16  Martin Baulig  <martin@ximian.com>

	* frontends/gui/Parser.jay: Added `run' command to restart an
	application after it exited.

2003-04-16  Martin Baulig  <martin@ximian.com>

	* classes/ProcessStart.cs: Moved to ../backends/.

	* backends/ProcessStart.cs (ProcessStart): Make this abstract.
	(ProcessStart.Create): Take a `DebuggerOptions options' and a
	`string[] args' argument; parse the arguments here.

	* frontends/scripting/DebuggerOptions.cs: This is now part of
	../backends/ProcessStart.cs.

2003-04-15  Martin Baulig  <martin@ximian.com>

	* backends/BreakpointManager.cs: Correctly implement Dispose().

	* backends/ThreadManager.cs (Dispose): Also kill the main process.

	* backends/Process.cs (child_exited): Call Dispose().

	* backends/DaemonThreadRunner.cs, SingleSteppingEngine.cs (Dispose):
	Don't dispose the inferior here; this needs to be done by the
	daemon thread itself to avoid a race condition.

2003-04-13  Martin Baulig  <martin@ximian.com>

	* classes/StackFrame.cs (ObjectInvalidHandler): New delegate.
	(StackFrameHandler, StackFrameInvalidHandler): Removed.
	(StackFrame.FrameInvalid): Renamed to FrameInvalidEvent and use
	the new ObjectInvalidHandler.

	* classes/Backtrace.cs (BacktraceInvalidHandler): Removed, use
	ObjectInvalidHandler instead.

	* classes/TargetEvent.cs: New public class.  We're now sending a
	single `TargetEvent' instead of the FrameChanged, FrameInvalid,
	MethodChanged, MethodInvalid and StateChanged events.

	* backends/SingleSteppingEngine.cs: Send a single TargetEvent
	instead of the FrameChanged, FrameInvalid, MethodChanged,
	MethodInvalid and StateChanged events.  This makes things a lot
	easier for the gui.

	* frontends/gui/DebuggerWidget.cs, DebuggerManager.cs: Reflect
	latest SingleSteppingEngine changes.  Things are now a lot easier
	here since we're just listening to one single event.

2003-04-13  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetObject.cs (ObjectInvalidHandler): Removed.

2003-04-12  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs (TargetExitedEvent): New event.
	(Kill): Just call Dispose() here, this does everything for us.

	* backends/ThreadManager.cs (Kill): New public method.  The is the
	recommended API to kill the application being debugged.

	* backends/DaemonThreadRunner.cs, Debugger.cs, Process.cs,
	SingleSteppingEngine.cs, ThreadManager.cs (Dispose): Make this
	thread-safe.

	* frontends/scripting/Parser.jay: Make the `kill' command kill the
	whole application, not just one process.

2003-04-10  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetNotification.cs
	(TargetOutputHandler): Added `bool is_stderr' argument.
	(DebuggerOutputHandler): New public delegate.
	(TargetOutput, TargetError, DebuggerOutput, DebuggerError):
	Removed these events.

	* backends/ThreadManager.cs
	(TargetOutput): Renamed to `TargetOutputEvent'.
	(TargetError): Removed; we're now using one event for TargetOutput
	and TargetError.
	(TargetOutputEvent): Listen to this event to get the target's
	stdout and stderr.
	(DebuggerOutputEvent, DebuggerErrorEvent): New public events.

2003-04-10  Martin Baulig  <martin@ximian.com>

	* backends/server/library.c (mono_debugger_server_spawn): Return
	the error message as string, not as GError.

	* backends/ptrace/PTrace.cs (Run): Include the actual error
	message from the target in the CannotStartTargetException.

	* backends/SingleSteppingEngine.cs: Catch the exception we get if
	we cannot start / attach to the target and pass it to the caller.

2003-04-10  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoVariable.cs: Use correct scope info for
	parameters.

2003-04-10  Martin Baulig  <martin@ximian.com>

	* backends/ThreadManager.cs (TargetOuput, TargetError): New public
	events; use them to get the target's stdout and stderr instead of
	the events in Process.

2003-04-10  Martin Baulig  <martin@ximian.com>

	* frontends/gui/DebuggerGUI.cs: Don't make the "About" dialog
	modal.	

2003-04-07  Martin Baulig  <martin@ximian.com>

	* frontends/gui/ProgramToDebug.cs: Added a Gtk.Entry to specify the
	JIT optimizations.  See `mini --help' for a list of optimization
	options  [FIXME: we should add a real GUI element for this].

2003-04-07  Martin Baulig  <martin@ximian.com>

	* configure.in: Require mono and mini for the moment.

	* wrapper/Makefile.am: Build a `mono-debugger-jit-wrapper' for the
	old JIT and a `mono-debugger-mini-wrapper' for the new one.

	* wrapper/mini-main.c: New file.  This is the main.c for Mini.

	* lib/Makefile.am: Make `mono-debugger-mini-wrapper' the default;
	we're now using the new JIT in the debugger.

2003-04-07  Martin Baulig  <martin@ximian.com>

	Released version 0.3 "The White Mountains" of the Mono Debugger :-)

2003-04-06  Martin Baulig  <martin@ximian.com>

	* README.build: New file.  Please read it before compiling the
	debugger.

	* RELEASE-NOTES-0.3.txt: New file.

2003-04-05  Martin Baulig  <martin@ximian.com>

	* wrapper/thread-manager.c: Reflect latest libgc API changes.

2003-03-31  Martin Baulig  <martin@ximian.com>

	* wrapper/mono-debugger-jit-wrapper.h (MonoDebuggerThread): New
	type.  We create an instance of this type for each thread.

	* backends/ThreadManager.cs (AcquireGlobalThreadLock): Write the
	stopped thread's stack pointers into the corresponding
	MonoDebuggerThread structure so they can be accessed from the
	unmanaged code.
	
	* backends/SingleSteppingEngine.cs (AcquireThreadLock): Return the
	stopped thread's registers.

2003-03-31  Martin Baulig  <martin@ximian.com>

	* configure.in: Require the new libgc.

2003-03-30  Martin Baulig  <martin@ximian.com>

	* wrapper/thread-manager.c
	(mono_debugger_thread_manager_acquire_global_thread_lock): New
	function.  Calls ThreadManager.AcquireGlobalThreadLock() via a
	callback function.
	(mono_debugger_thread_manager_release_global_thread_lock): Release
	the lock again.

	* wrapper/icall.c
	(Mono.Debugger.Callbacks.ThreadManager::AcquireGlobalThreadLock):
	New interncalls; this is just to test the thread lock until we
	hooked it into boehm.

2003-03-30  Martin Baulig  <martin@ximian.com>

	* backends/ThreadManager.cs (mono_thread_manager): Fixed a bug to
	make this actually work; don't insert a breakpoint, but pass the
	stop address to SingleSteppingEngine.Continue() and then wait
	until it has stopped again.

2003-03-30  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs: Run the BreakpointHitHandler()
	from the ready_event_handler() because it should be run after the
	target state has changed to TargetState.STOPPED and the
	corresponding notification has been sent.

2003-03-28  Martin Baulig  <martin@ximian.com>

	* backends/ThreadManager.cs (SignalHandler): Ignore SIGPWR and
	SIGXCPU since they're used by the garbage collector.

2003-03-28  Martin Baulig  <martin@ximian.com>

	* arch/Bfd.cs: Read the dynamic symbol table and make it available
	via the ISimpleSymbolTable.  This finally gives us function names
	from shared libraries in backtraces.

2003-03-28  Martin Baulig  <martin@ximian.com>

	Use a special ISimpleSymbolTable to lookup function names in
	backtraces.  This simple symbol table may also be available if
	there's no debugging info for a module.

	* interfaces/ISymbolTable.cs
	(ISymbolLookup): Removed SimpleLookup().
	(ISimpleSymbolTable): New public interface.

	* interfaces/IDisassembler.cs (SymbolTable): Return an
	ISimpleSymbolTable, not an ISymbolTable.

	* classes/SymbolTableManager.cs (SymbolTableHandler): Added
	ISimpleSymbolTable argument to this delegate.
	(SimpleSymbolTable): New public property.

	* classes/SimpleSymbolTableCollection.cs: New public class.

	* classes/ModuleData.cs (SimpleSymbolTable): New public property.

	* classes/Module.cs (SimpleSymbolTable): New public property.

	* clases/MethodBase.cs (SimpleLookup): Removed.

2003-03-28  Martin Baulig  <martin@ximian.com>

	* arch/BfdModule.cs (SymbolsLoaded): Always return true since we
	always have at least the simple symbol table.  This is necessary
	to get function names for functions in shared libraries without
	debugging info.

2003-03-28  Martin Baulig  <martin@ximian.com>

	* wrapper/main.c: Call mono_config_parse() and mono_set_rootdir().

2003-03-25  Martin Baulig  <martin@ximian.com>

	* frontends/gui/SourceList.cs (InsertBreakpoint): Implemented.

2003-03-25  Martin Baulig  <martin@ximian.com>

	* frontends/gui/debugger.glade: Splitted locals and params display.

	* frontends/gui/VariableDisplay.cs: Started to fix this.

2003-03-25  Martin Baulig  <martin@ximian.com>

	* frontends/gui/SourceManager.cs: Use a single SourceList for all
	source files.

	* frontends/gui/SourceList.cs: Added "Duplicate View" item to the
	context menu to create another view of this source file.

2003-03-24  Martin Baulig  <martin@ximian.com>

	* frontends/gui/SourceManager.cs (CreateSourceView): Pass the full
	pathname to the SourceList's .ctor.

	* frontends/gui/SourceList.cs: We need to use the full pathname
	when searching a breakpoint location

2003-03-24  Martin Baulig  <martin@ximian.com>

	* frontends/gui/debugger.glade: Disable the popup menu in the
	code-browser-notebook.

	* frontends/gui/SourceList.cs: Embed the setting of the contents
	in BeginNotUndoableAction()/EndNotUndoableAction().	

	* frontends/gui/ProgramToDebug.cs: Don't make the dialog modal and
	don't use Dialog.Run().

2003-03-23  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/DebuggerOptions.cs (--jit-optimizations):
	New command line argument to specify the optimization flags for
	the new JIT.  This is the same than the --optimize argument of the
	new JIT.

	* wrapper/main.c (main): The second command line argument now
	contains the optimization flags.

2003-03-23  Martin Baulig  <martin@ximian.com>

	* classes/ProcessStart.cs (SetupEnvironment): Pass all environment
	variables to the target.

2003-03-23  Martin Baulig  <martin@ximian.com>

	* classes/ProcessStart.cs (CommandLine): New public property.

	* frontends/gui/DebuggerGUI.cs (StartProgram): Use just the name
	of the managed application, not the full command line including
	the wrapper in the title.

2003-03-22  Martin Baulig  <martin@ximian.com>

	* classes/ProcessStart.cs: Moved here from ../backends/.

	* backends/ProcessStart.cs: Moved to ../classes/.

	* frontends/scripting/DebuggerOptions.cs: New file.  Moved
	`MyOptions' from ScriptingContext.cs here, renamed it to
	DebuggerOptions and made it public.  This class handles the
	parsing of the command line arguments.

	* frontends/scripting/ScriptingContext.cs
	(ScriptingContext..ctor): Added DebuggerOptions argument.
	(ScriptingContext.Start): Return the ProcessStart, don't call Run().
	(ScriptingContext.ParseArguments): Removed.
	(ScriptingContext.Run): Call Initialize() here.

	* frontends/gui/DebuggerGUI.cs: Use the new DebuggerOptions class
	to parse the command line arguments.

2003-03-22  Martin Baulig  <martin@ximian.com>

	* doc/guadec-abstract.txt: Added the abstract of my GUADEC talk.

2003-03-22  Martin Baulig  <martin@ximian.com>

	* interfaces/IVariable.cs (IsValid): Renamed to CheckValid() and
	added IsAlive().

	* backends/mono-csharp/MonoVariable.cs: Only use scope and
	liveness info if we actually have it.

	* backends/mono-csharp/MonoType.cs (CheckValid): New method.
	Checks whether the location is actually valid.

	* backends/mono-csharp/MonoTargetLocation.cs (Address): Return
	TargetAddress.Null on error; don't attempt to dereference null
	pointers, just return TargetAddress.Null.

2003-03-21  Martin Baulig  <martin@ximian.com>

	* doc/FAQ.txt: Updated documentation about JIT trampolines and
	debugging interncalls.

2003-03-21  Martin Baulig  <martin@ximian.com>

	* classes/Module.cs (HasDebuggingInfo): New public property.

	* frontends/scripting/ScriptingContext.cs (ShowModules): Ignore
	modules without debugging info.

2003-03-21  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs (StepNativeInstruction):
	New public method.  Steps one machine instruction and always
	enters all method calls, including trampolines.

	* frontends/scripting/Parser.jay: Added `native stepi' command
	for it.

2003-03-16  Martin Baulig  <martin@ximian.com>

	* interfaces/IMethod.cs (GetTrampoline): New method.

	* interfaces/IDisassembler.cs (DisassembleInstruction): Added
	`IMethod method' argument.

	* classes/AssemblerMethod.cs: The BfdDisassembler now calls the
	.ctor with an array of AssemblerLine's.

	* arch/Bfd.cs: Added support for ELF jump tables.

	* arch/BfdModule.cs (Language): Return the Bfd, which now
	implements ILanguageBackend.

	* backends/ILanguageBackend.cs (Modules): Removed this property.

	* backends/Process.cs (DisassembleInstruction): Removed.

2003-03-16  Martin Baulig  <martin@ximian.com>

	* arch/DwarfReader.cs: Fixed a bug to make shared libraries work
	again.

2003-03-14  Martin Baulig  <martin@ximian.com>

	* classes/StackFrame.cs (Locals): New public property.  Returns
	just the locals which are actually accessible at the current
	location.

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs: Actually use
	the scope information from the symbol file.

2003-03-13  Martin Baulig  <martin@ximian.com>

	* test/TestLexicalScopes.cs: New tests.  The debugger should only
	display one variable called `a' at a time.

2003-03-12  Martin Baulig  <martin@ximian.com>

	* frontends/gui/DebuggerManager.cs: New file.  Do all this event
	notification stuff here instead of doing it on a per-widget level
	in DebuggerWidget.

2003-03-12  Martin Baulig  <martin@ximian.com>

	* frontends/gui/ProcessManager.cs: Removed, this was way too immature.

	* frontends/gui/LineDebugStatusbar.cs: Removed.

2003-03-12  Martin Baulig  <martin@ximian.com>

	* frontends/gui/FileOpenDialog.cs: New file.  This is a customized
	Gtk.FileSelection which has a list of all source files.

2003-03-11  Martin Baulig  <martin@ximian.com>

	* frontends/gui/DebuggerGUI.cs: Implemented "File / Open".

2003-03-11  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/SourceManager.cs: The text in the source
	buffer must always be terminated with a newline.

2003-03-11  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs (do_next): Step one instruction
	unless this is actually a call.

2003-03-11  Martin Baulig  <martin@ximian.com>

	* frontends/gui/DebuggerGUI.cs: Use Log.PrintTraceLogFunction for
	glib and gtk+ to get backtraces.

2003-03-11  Martin Baulig  <martin@ximian.com>

	* backends/Debugger.cs (FindLocation): New convenience function.
	Walks the module list and calls FindLocation() on all modules
	until finding a match - or returns null.

	* frontends/scripting/ScriptingContext.cs (FindLocation): Call
	DebuggerBackend.FindLocation() and throw the ScriptingException if
	needed.

	* frontends/gui/SourceManager.cs: Use
	DebuggerBackend.FindLocation, not ScriptingContext.FindLocation.

	* frontends/gui/DebuggerGUI.cs (Context): Removed this property.

2003-03-10  Miguel de Icaza  <miguel@ximian.com>

	* frontends/gui/SourceList.cs: Generate an informational message

2003-03-10  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine: When debugging managed code,
	don't step into methods without debugging info.

2003-03-10  Martin Baulig  <martin@ximian.com>

	* classes/SourceInfo.cs (SourceFile.Name): New property.

	* classes/MethodSource.cs (IMethodSource.Name): Return the
	SourceFile.Name, not the SourceFile.FileName.

2003-03-09  Martin Baulig  <martin@ximian.com>

	* frontends/gui/: Added .ctors which take the glade name instead
	of a widget.

2003-03-09  Martin Baulig  <martin@ximian.com>

	* frontends/gui/: Added "File / Open" menu item to open a source
	view.  Not yet implemented, though.

2003-03-09  Martin Baulig  <martin@ximian.com>

	* test/TestSourceView.cs: Small test app for the Gtk.SourceView.

2003-03-09  Martin Baulig  <martin@ximian.com>

	* frontends/command-line/Interpreter.cs (ProcessCommand): Repeat
	the last command when called with an empty string.

2003-03-09  Martin Baulig  <martin@ximian.com>

	* backends/ProcessStart.cs
	(Path_Mono, Environment_Path, Environment_LibPath): Made them
	static and writable.

	* frontends/scripting/ScriptingContext.cs (--jit-wrapper): New
	command line argument to override the ProcessStart.Path_Mono.

2003-03-09  Martin Baulig  <martin@ximian.com>

	* configure.in: Set version number to 0.2.3.  The next release
	will be 0.3 "White Montains".

2003-03-09  Martin Baulig  <martin@ximian.com>

	Released version 0.2.2 "Cambridge" of the Mono Debugger :-)

2003-03-07  Martin Baulig  <martin@ximian.com>

	* configure.in: Check whether we're compiling from CVS and only
	check for gapi_codegen.exe if we do so.

	* widgets/generator/Makefile.am (USE_GAPI_CODEGEN): New automake
	conditional; don't rebuild if it's false.

2003-03-07  Martin Baulig  <martin@ximian.com>

	* configure.in: Set version number to 0.2.2.

2003-03-05  Martin Baulig  <martin@ximian.com>

	* wrapper/wrapper.c: This file was formerly known as main.c.

	* wrapper/main.c: Moved everything but a very simple main()
	function into wrapper.c.

	* Makefile.am: Create a static libmonodebuggerwrapper.a library
	containing everything but the main().

2003-03-04  Martin Baulig  <martin@ximian.com>

	* widgets/generator/Makefile.am: Only rebuild things if we're in
	maintainer mode.

	* widgets/*/generated/: Include the generated files in the
	distribution since we aren't rebuilding them in the tarballs.
	
2003-03-04  Martin Baulig  <martin@ximian.com>

	* configure.in: Improved the gtk# check; actually check for
	gapi_codegen.exe and don't build the GUI if we can't find gtk#.

2003-03-04  Martin Baulig  <martin@ximian.com>

	* RELEASE-NOTES-0.2.2.txt: New file.  This is more or less a copy
	of the RELEASE-NOTES-0.2.0.txt.

	* NEWS: Added a few news entries.

2003-03-03  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Generator.cs (Generator.PrintHelp): New
	method.  Takes whatever the user entered after the `help' command
	as a string and prints the help.

	* frontends/scriptings/Tokenizer.cs (token): If we encounter a
	Token.HELP, consume the rest of the line and pass it to
	Generator.PrintHelp().

2003-03-03  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Generator.cs: New file.

	* frontends/scripting/Command.cs: Added a [Command] attribute to
	all commands.

	* frontends/scripting/Expression.cs: Added an [Expression]
	attribute to all expressions.

2003-03-03  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Command.cs (HelpCommand): Removed.

2003-03-03  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Parser.jay (command): Splitted into
	`generated_command', `other_command' and `assert_command' and
	removed the "help" command.

	* frontends/scripting/Expression.cs
	(ProgramArgumentsExpression): New expression.

2003-03-03  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Expression.cs
	(BreakpointNumberExpression): New expression.

2003-03-03  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Expression.cs
	(ModuleOperationListExpression): New expression.

2003-03-03  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Expression.cs
	(ModuleListExpression, SourceListExpression, ProcessListExpression):
	New expressions.

2003-03-03  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Command.cs (StepCommand): Use a separate
	class for the individual stepping commands.

2003-03-03  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/ScriptingContext.cs
	(FrameHandle, BacktraceHandle): New public classes.

	* frontends/scripting/Expression.cs
	(FrameExpression): New expression.

	* frontends/scripting/Parser.jay: Use the new FrameExpression
	instead of a ProcessExpression and a frame number.

2003-03-03  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Command.cs: Moved some stuff into the
	following three new files.

	* frontends/scripting/Expression.cs: New file.
	* frontends/scripting/VariableExpression.cs: New file.
	* frontends/scripting/AssertCommand.cs: New file.

2003-03-01  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/ScriptingContext.cs: Automatically run newly
	created threads in the background.

2003-03-01  Martin Baulig  <martin@ximian.com>

	* arch/DwarfReader.cs: Ignore line numbers from other source files
	(macros or #include'd files, for instance).

2003-03-01  Martin Baulig  <martin@ximian.com>

	* classes/SourceFileFactory.cs: Cache the file contents in an
	ObjectCache.

	* backends/Debugger.cs (SourceFileFactory): New public property.

	* interfaces/IMethod.cs (IMethodSource.SourceBuffer): Always
	return the method contents here, also when the method belongs to
	an actual source file.	

2003-02-27  Martin Baulig  <martin@ximian.com>

	* frontends/gui/SourceManager.cs (GetSourceView): Use the
	SourceFile / ISourceBuffer as hash key, not the IMethodSource.

2003-02-27  Martin Baulig  <martin@ximian.com>

	* backends/server/server.h (CommandError): Cleaned this up.

	* backends/ptrace/PTrace.cs: Throw a TargetMemoryException if
	reading from the target's memory failed.

	* classes/TargetException.cs (LocationInvalidException): Added
	.ctor which takes a TargetException.

	* backends/native/*: Pass TargetExceptions to the
	LocationInvalidException's .ctor.

	* backends/mono-csharp/*: Likewise.

2003-02-27  Martin Baulig  <martin@ximian.com>

	* backends/native/NativeStringObject.cs (ReadString): Quote
	non-printable characters in the returned string, read at most
	MaximumDynamicSize chars.

2003-02-26  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs (check_method_operation):
	Enable this for native methods as well.

2003-02-26  Martin Baulig  <martin@ximian.com>

	* backends/native/NativeStringType.cs: New file.
	* backends/native/NativeStringObject.cs: New file.

	* arch/DwarfReader.cs: Cleaned up the API a bit and added support
	for strings.

2003-02-26  Martin Baulig  <martin@ximian.com>

	* arch/DwarfReader.cs: Started to add support for native types to
	access parameters and local variables in native methods.

2003-02-26  Martin Baulig  <martin@ximian.com>

	* backends/native/: New directory.

	* backends/native/NativeFundamentalObject.cs: New file.
	* backends/native/NativeFundamentalType.cs: New file.
	* backends/native/NativeObject.cs: New file.
	* backends/native/NativeOpaqueType.cs: New file.
	* backends/native/NativeType.cs: New file.

2003-02-26  Martin Baulig  <martin@ximian.com>

	Moved MonoTargetLocation.cs, MonoRelativeTargetLocation.cs,
	MonoStackLocation.cs and MonoRegisterLocation.cs from
	backends/mono-csharp/ to backends/classes/ and put them into the
	Mono.Debugger.Backends namespace.

	* backends/classes/MonoTargetLocation.cs: Moved here.
	* backends/classes/MonoRelativeTargetLocation.cs: Moved here.
	* backends/classes/MonoStackLocation.cs: Moved here.
	* backends/classes/MonoRegisterLocation.cs: Moved here.

2003-02-25  Martin Baulig  <martin@ximian.com>

	* classes/SourceInfo.cs (SourceFile.FindMethod): Renamed the
	overloaded version which took a line into FindLine () and changed
	its return type to SourceLocation.

	* classes/Module.cs (FindMethod): Renamed the overloaded version
	which took a filename and line to FindLocation() and changed its
	return type to SourceLocation.

2003-02-24  Martin Baulig  <martin@ximian.com>

	* interfaces/IMethod.cs (IMethodSource.SourceMethod): New property.

	* classes/SourceAddress.cs (SourceLocation): New property.

2003-02-24  Martin Baulig  <martin@ximian.com>

	* interfaces/ISourceBuffer.cs (ISourceBuffer.HasContents): Removed
	this property; from now on, an ISourceBuffer always has contents.
	(ISourceBuffer.Contents): Changed the type of this property from
	`string' to `string[]'; it returns the source file splitted into
	lines (it turned out to be more useful that way).

	* interfaces/IMethod.cs (IMethodSource): Added Name, IsDynamic,
	SourceBuffer and SourceFile properties.

	* classes/SourceAddress.cs (SourceAddress.Buffer): Removed this
	property.
	(SourceAddress.MethodSource): New public property.

2003-02-24  Martin Baulig  <martin@ximian.com>

	* classes/SourceInfo.cs: Renamed `SourceInfo' into `SourceFile'
	and `SourceMethodInfo' into `SourceMethod'.

2003-02-24  Martin Baulig  <martin@ximian.com>

	* classes/SourceFileFactory.cs (SourceFileFactory.FindFile):
	Return an ISourceBuffer.
	(SourceFile): Removed.

2003-02-24  Martin Baulig  <martin@ximian.com>

	* classes/SourceLocation.cs: New public class.

	* classes/BreakpointHandle.cs (BreakpointHandleMethod): Merged all
	the functionality into `BreakpointHandle' and removed this class.

	* classes/Module.cs (Module.AddBreakpoint): Take a SourceLocation.

2003-02-24  Martin Baulig  <martin@ximian.com>

	* backends/Process.cs (Kill): Send the event and call Dispose ().

	* backends/ThreadManager.cs (process_exited): Use Process.Kill()
	to kill all processes.

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs: Unload the
	modules when the target exits.

2003-02-23  Martin Baulig  <martin@ximian.com>

	Renamed `SourceLocation' to `SourceAddress'.

	* classes/SourceAddress.cs: Formerly known as SourceLocation.

	* classes/SourceLocation.cs: Renamed into SourceAddress.

2003-02-22  Martin Baulig  <martin@ximian.com>

	* classes/SourceFileFactory.cs (SourceFile.ReadFile): Use
	`Encoding.GetEncoding (28591)' as the default encoding.  I've no
	idea why, but that's what MCS is doing in driver.cs and it's
	fixing my bug.

2003-02-22  Martin Baulig  <martin@ximian.com>

	* doc/user-manual.texi: Documented the new breakpoint code.

2003-02-22  Martin Baulig  <martin@ximian.com>

	* interfaces/IMethod.cs (IMethodSource.MethodLookup): New method.

	* backends/Debugger.cs (InsertBreakpoint): Removed the overloaded
	versions which took a method name / file name; the method lookup
	is now done by the client, we just take a SourceMethodInfo here.

	* frontends/scripting/: Completely reworked the `break' commands.
	Thread groups are now specified in `<', '>'.

2003-02-13  Miguel de Icaza  <miguel@ximian.com>

	* frontends/command-line/Main.cs: Make enter repeat the last command.

2003-02-09  Martin Baulig  <martin@ximian.com>

	* test/SymbolFileReader.cs: Moved to ../lib/.

	* lib/SymbolFileReader.cs: Added this to the build.

2003-02-08  Martin Baulig  <martin@ximian.com>

	* wrapper/main.c: Create a special command thread which is always
	stopped.  It is used by the debugger to invoke methods on the JIT,
	such as compiling a method or inserting a breakpoint.

2003-02-08  Martin Baulig  <martin@ximian.com>

	* classes/ModuleData.cs (FindMethod): New abstract method.

	* classes/Module.cs (FindMethod): Call ModuleData.FindMethod().

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoModule.FindMethod): Provide a custom implementation for this.

2003-02-07  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs: Reflect
	latest symbol writer changes.

2003-02-05  Martin Baulig  <martin@ximian.com>

	* tests/SymbolFileReader.cs: New test.  This is a nice tool which
	can dump the contents of a symbol file.

2003-02-03  Martin Baulig  <martin@ximian.com>

	* backends/server/library.c: Return the correct thread abort/restart
	signals.

	* backends/ThreadManager.cs: Make this work for native
	applications again.

2003-02-03  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/ScriptingContext.cs: Added `--prompt'
	command line argument to specify the prompt; useful when running
	the debugger inside the debugger.

2003-02-02  Martin Baulig  <martin@ximian.com>

	* test/TestInternCall.cs: New test.

2003-02-02  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs: Added support for
	PInvoke/icall wrappers.

2003-02-02  Martin Baulig  <martin@ximian.com>

	* interfaces/IMethod.cs (IsWrapper, WrapperAddress): New properties.

2003-02-02  Martin Baulig  <martin@ximian.com>

	* wrapper/icall.c: New file.
	(Mono.Debugger.Tests.TestInternCall::Test): New interncall for
	testing purposes.

2003-02-02  Martin Baulig  <martin@ximian.com>

	* frontends/gui/SourceView.cs (CreateWidget): New abstract method.
	(.ctor): Hook to the "map"/"unmap" events and don't update the
	widget while we're invisible.
	(frame_changed_event): If we're called the first time, queue an
	idle callback which scrolls to the current line.

2003-02-02  Martin Baulig  <martin@ximian.com>

	* arch/ArchitectureI386.cs (I386Register): Made this public.

2003-02-01  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/ScriptingContext.cs (Start): Splitted into
	ParseArguments() and Run().

	* backends/ProcessStart.cs (IsCoreFile, CoreFile): New properties.

	* frontends/gui/DebuggerGUI.cs (ProgramLoadedEvent): This is now
	emitted when the DebuggerBackend is created.
	(ProcessCreatedEvent): New public event which is emitted when the
	main process has been created.

	* frontends/gui/DebuggerWidget.cs (SetBackend): New protected
	virtual function; this is called before the main process is started.

2003-02-01  Martin Baulig  <martin@ximian.com>

	* frontends/gui/DebuggerGUI.cs (ProgramLoadedEvent): New public
	event.

	* frontends/gui/DebuggerWidget.cs (SetProcess): Made this
	protected; we hook to the DebuggerGUI's ProgramLoadedEvent.

2003-02-01  Martin Baulig  <martin@ximian.com>

	* frontends/gui/DebuggerWidget.cs: The `backend' is now set in
	SetProcess() and must not be used before SetProcess() has been called.

2003-02-01  Martin Baulig  <martin@ximian.com>

	* classes/ObjectCache.cs: Re-enable WeakReferences.

2003-02-01  Martin Baulig  <martin@ximian.com>

	* frontends/command-line/Interpreter.cs: The ScriptingContext is
	now created by the caller and passed to the .ctor as argument.

2003-01-26  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/: Use Mono.GetOptions.

2003-01-26  Martin Baulig  <martin@ximian.com>

	* doc/user-manual.texi: New file.  Explained thread groups and
	per-thread breakpoints there.

2003-01-26  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/: Implemented ThreadGroup support.

2003-01-26  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Parser.jay: Added `kill' command.	

2003-01-24  Martin Baulig  <martin@ximian.com>

	* wrapper/: Reflected lastest runtime changes.

2003-01-24  Martin Baulig  <martin@ximian.com>

	Made the serialization stuff actually work.  You can now save a
	debugger session - including all your breakpoints - to disk and
	read it back next time you start the debugger :-)

	* backend/ProcessStart.cs: Made this serializable.

	* backend/DebuggerBackend.cs: Made this serializable.

	* class/Module.cs: Make the serialization stuff actually work.  We
	can now serialize the module list, including all the breakpoints,
	to disk and reload it later.

2003-01-24  Martin Baulig  <martin@ximian.com>

	* classes/ModuleData.cs: Split out all the dynamic stuff from
	`Module'; this is now also the base class for `NativeModule'.

	* classes/BreakpointHandle.cs: This was formerly a nested class in
	`Module' and is now public.

	* classes/SymbolTableManager.cs: Don't use an AsyncQueue here.

	* arch/BfdModule.cs: The DwarfReader is now constructed here; we
	can also load/unload it.

2003-01-24  Martin Baulig  <martin@ximian.com>

	* wrapper/: Prefix all symbols which are accessed from the
	debugger with `MONO_DEBUGGER__' and mark them as volatile.

2003-01-23  Nick Drochak <ndrochak@gol.com>

	* frontends/gui/DebuggerGUI.cs: Hook up close button on window border.

2003-01-22  Martin Baulig  <martin@ximian.com>

	* lib/Makefile.am: Use the new wrapper instead of @MONO@.  Added
	the ${LD_LIBRARY_PATH} to the config files.

	* backends/ProcessStart: Pass the LD_LIBRARY_PATH to the target.

2003-01-22  Martin Baulig  <martin@ximian.com>

	* classes/Breakpoint.cs (BreakpointHit): Renamed to
	CheckBreakpointHit() and added BreakpointHit() which'll be called
	after the target is actually stopped and the notifications have
	been send.

2003-01-22  Martin Baulig  <martin@ximian.com>

	* backends/ThreadManager.cs: Use the new mono thread manager in
	the wrapper.

	* wrapper/: New directory.  This is an unmanaged wrapper
	application which embeds the JIT.  It is launched from the
	debugger when debugging managed applications.

	* configure.in: Set version number to 0.2.1; require Mono 0.19.1.

2003-01-19  Martin Baulig  <martin@ximian.com>

	Released version 0.2.0 "Boston" of the Mono Debugger :-)

2003-01-19  Martin Baulig  <martin@ximian.com>

	* README.FreBSD: The mono and binutils binaries are ready :-)

2003-01-19  Martin Baulig  <martin@ximian.com>

	* README.FreeBSD: Unfortunately, the binutils issue is a bit worse
	than expected on FreeBSD.  I've made a FreeBSD port, including a
	binary package; added a link to them.

2003-01-19  Martin Baulig  <martin@ximian.com>

	* arch/DwarfReader.cs: Don't make this an IDisposable.

	* classes/SymbolTableManager.cs: Catch the ThreadAbortException
	and set the events to wake up a potentially waiting caller.

2003-01-18  Martin Baulig  <martin@ximian.com>

	* interfaces/IProcess.cs (State, Disassembler): New properties.

	* backends/SingleSteppingEngine.cs: Implement IDisassembler.

	* backends/Process.cs: Some API cleanups.
	(ProcessExitedEvent): New public event.

2003-01-18  Martin Baulig  <martin@ximian.com>

	* configure.in: Set version number to 0.1.9, we're almost ready for
	the release ....

2003-01-18  Martin Baulig  <martin@ximian.com>

	* RELEASE-NOTES-0.2.0.txt: Replaced `GNU/Linux' with `Linux and
	BSD kernels' since the debugger is now working on FreeBSD.

2003-01-17  Martin Baulig  <martin@ximian.com>

	* backends/DaemonThreadRunner.cs: Make the runner thread exit when
	the target receives a SIGKILL.

2003-01-17  Martin Baulig  <martin@ximian.com>

	* classes/ObjectCache.cs: Catch and silently ignore exceptions
	when creating the WeakReference.  This makes the debugger work
	with a runtime which has no GCHandle support.

2003-01-17  Martin Baulig  <martin@ximian.com>

	* configure.in: Don't check for gthread anymore.

	* backends/server/breakpoints.c: Don't use a GStaticRecMutex here; 
	mono_debugger_breakpoint_manager_new () now takes two delegate
	arguments - a lock an an unlock function.

	* classes/BreakpointManager.cs: Create a Mutex and pass the
	unmanaged breakpoint manager to delegates to lock/unlock it.

2003-01-16  Martin Baulig  <martin@ximian.com>

	* backends/server/i386-freebsd-ptrace.c (do_wait): FreeBSD
	requires the `WLINUXCLONE' option if and only if the target is a
	thread.

	* backends/server/i386-ptrace.c (InferiorHandle): Added
	`is_thread' field; this is set to 1 by server_ptrace_attach()
	since we currently only attach to threads.

2003-01-16  Martin Baulig  <martin@ximian.com>

	* configure.in: Check whether we have a shared libbfd.so; if not,
	tell people to read the "binutils and libbfd issues" section in
	README.FreeBSD.

	* README.FreeBSD: New file.

	* doc/FAQ.txt: Also added this to the FAQ.

2003-01-16  Martin Baulig  <martin@ximian.com>

	* backends/ThreadManager.cs: Don't hardcode signal numbers.

	* backends/ptrace/PTrace.cs
	(ThreadAbortSignal, ThreadRestartSignal, ThreadDebugSignal,
	MonoThreadDebugSignal): New static properties.

2003-01-16  Martin Baulig  <martin@ximian.com>

	* backends/ThreadManager.cs: Use the new thread manager in
	mono/io-layer when debugging managed applications.

2003-01-15  Peter Williams  <peterw@ximian.com>

	* frontends/scripting/Parser.jay: Change it so that expressions
	go in parentheses, not variable_expressions.

	* frontends/scripting/Command.cs: supporting changes of
	VariableExpressionGroup -> ExpressionGroup.

2003-01-13  Peter Williams  <peterw@ximian.com>

	* frontends/scripting/Command.cs: Implement a binary operator for
	simple math in expressions. Make variable_expressions convertible
	to expressions so that we don't need PrintCommand as well as 
	PrintVariableCommand. Change the default resolution of variables
	to try and get their actual values. Make array index take an
	expression so that we can do "$array[$i]".

	* frontends/scripting/Parser.jay: Define binary operators and make
	them possible expressions. Don't make processes possible expressions.
	Remove the PrintVariable command since we don't need it anymore.

	* frontends/scripting/Tokenizer.cs: Return the binary operator tokens
	if necessary. Needs fixing to support negative numbers.

2003-01-14  Martin Baulig  <martin@ximian.com>

	* NEWS: The Debugger is now working on FreeBSD 4.7 :-)

2003-01-14  Martin Baulig  <martin@ximian.com>

	* backends/IInferior.cs (StopSignal): Removed.

	* backends/ptrace/PTrace.cs (SIGSTOP, SIGINT, SIGCHLD, SIGPROF):
	New static properties; initialize them in a static .ctor.

	* backend/ThreadManager.cs (SignalHandler): Ignore SIGPROF as well.

2003-01-14  Martin Baulig  <martin@ximian.com>

	* arch/ArchitectureI386.cs: Keep the registers in sync with
	DebuggerI386Registers in backends/server/i386-arch.h.

2003-01-14  Martin Baulig  <martin@ximian.com>

	* backends/server/i386-linux-ptrace.c: Moved the
	architecture-specific stuff into i386-arch.[ch]; moved the
	portable stuff into i386-ptrace.c, created i386-linux-ptrace.c and
	i386-freebsd-ptrace.c.

2003-01-14  Martin Baulig  <martin@ximian.com>

	* configure.in (server_sources): AC_SUBST this to
	i386-linux-ptrace.c on Linux and to nothing on other systems.

	* backends/server/library.c: If we're on Linux, #include
	"i386-linux-ptrace.c", otherwise don't read a backend at all.

2003-01-14  Martin Baulig  <martin@ximian.com>

	* arch/CoreFileElfI386.cs (get_registers): Read the registers from
	the `.reg' section to make this more portable.

	* arch/bfdglue.c (bfd_glue_core_file_elfi386_get_registers): Make
	this work on FreeBSD 4.7.

2003-01-13  Martin Baulig  <martin@ximian.com>

	* glue/mono-debugger-readline.c: Don't use a GIOChannel here, just
	read from stdin.

	* classes/GnuReadline.cs: We don't need an IOChannel anymore.

2003-01-13  Martin Baulig  <martin@ximian.com>

	* configure.in (--disable-readline): New command line argument to
	disable the use of GNU readline.

	* glue/mono-debugger-readline.c: Don't use readline if we don't
	have it.  Only set the GIOChannel flags on startup.

2003-01-13  Martin Baulig  <martin@ximian.com>

	* glue/bfdglue.c (bfd_glue_core_file_elfi386_get_registers):
	Changed the type of the `regs' argument to `gpointer *' to make it
	portable.

	* glue/bfdglue.h: Don't #include Linux-specific header files.

	* configure.in: Check whether we're actually on Linux.
	(--disable-gui): New command argument to disable building the gui.

2003-01-13  Martin Baulig  <martin@ximian.com>

	* classes/StackFrame.cs (Name): New public property.  Returns the
	method name from ISymbolLookup.SimpleLookup().

	* frontends/gui/BacktraceView.cs: Use the new StackFrame.Name
	property to get the method name.

2003-01-13  Martin Baulig  <martin@ximian.com>

	* interfaces/ISymbolTable.cs (ISymbolLookup.SimpleLookup): New
	interface method which returns just the name of the method without
	constructing the method itself.

	* arch/Bfd.cs: Read the bfd symbol table and make it available via
	the ISymbolLookup's SimpleLookup() method.

2003-01-13  Martin Baulig  <martin@ximian.com>

	* interfaces/IDisassembler.cs (DisassembleInstruction): Removed
	the version which took a `ref TargetAddress'; the other one now
	returns an AssemblerLine or null on error, it doesn't throw an
	exception any longer.

	* classes/AssemblerMethod.cs (AssemblerLine): Made this a sealed
	class, not a struct so we can pass this by reference and return null.

2003-01-13  Martin Baulig  <martin@ximian.com>

	* classes/AssemblerMethod.cs (AssemblerMethod.AppendOneLine): New
	public method to append a line at the end of the current method.

	* frontends/gui/DisassemblerView.cs: While we don't have a method,
	add all instructions we encounter here.

2003-01-12  Martin Baulig  <martin@ximian.com>

	* classes/NativeMethod.cs: Renamed to AssemblerMethod.

	* classes/AssemblerMethod.cs: New public class.  This derives from
	MethodSource, but we don't need an IMethod any longer.  The API is
	also a bit improved, you can for instance get an array of
	AssemberLines to access individual lines.

	* interfaces/IDisassembler.cs: Return an AssemblerMethod, not an
	IMethodSource.

	* frontends/gui/DisassemblerView.cs: If we don't have a method,
	just display the current instruction.

2003-01-12  Martin Baulig  <martin@ximian.com>

	* widgets/sources/debuggerwidgets/: New directory.

	* widgets/sources/debuggerwidgets/debuggerentry.[ch]: New widget.
	This is derived from GtkEntry and has "previos_line" and
	"next_line" signals which are emitted when the user presses the
	Up/Down keys.

	* frontends/gui/CurrentInstructionEntry.cs: Use the new
	DebuggerEntry widget; if the user presses the Up/Down keys,
	display the next/previous instruction.

2003-01-12  Martin Baulig  <martin@ximian.com>

	* frontends/gui/DebuggerGUI.cs: Make the "Program to Debug" menu
	item work again.

	* frontends/gui/debugger.glade: Removed the "File / Open" and
	"Debug / Restart" menu items.

2003-01-12  Martin Baulig  <martin@ximian.com>

	* frontends/gui/DebuggerWidget.cs: Removed all the method stuff;
	we only need it in the SourceManager.

	* frontends/gui/RegisterDisplay.cs (Active): New public property.
	This is set to true while the CPU view is being displayed.

2003-01-11  Martin Baulig  <martin@ximian.com>

	* classes/StackFrame.cs
	(DisassembleInstruction, DisassembleMethod): New public methods.

	* frontends/gui/DisassemblerView.cs: Use StackFrame.DisassembleMethod().

2003-01-11  Martin Baulig  <martin@ximian.com>

	* frontends/gui/SourceView.cs: Don't derive from DebuggerWidget;
	moved most of the functionality from SourceList here.

	* frontends/gui/SourceList.cs: Derive from SourceView.

	* frontends/gui/DisassemblerView.cs: Derive from SourceView.

	* frontends/gui/SourceManager.cs: Nicely integrate the DisassemblerView.

2003-01-11  Martin Baulig  <martin@ximian.com>

	* frontends/gui/SourceList.cs: Moved the SourceList class from
	SourceManager.cs into its own file.

2003-01-11  Martin Baulig  <martin@ximian.com>

	* widgets/generator/gtk-api.xml: Removed
	gtk_source_buffer_get_tag_start() and gtk_source_buffer_get_tag_end().

2003-01-11  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Parser.jay: Added `MODULE ALL module_operations'
	to do the operation on all modules.

2003-01-11  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Parser.jay: Added `SHOW MODULES' command and
	a `MODULE' command to modify modules.

2003-01-11  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs: Incremented
	MonoSymbolFileTable.DynamicVersion to 20 for the next Mono release.

2003-01-10  Peter Williams  <peterw@ximian.com>

	* lib/Makefile.in (clean): Remove *.dll on make clean as well as *.exe.
	Also add a rule to regenerate Makefile if Makefile.in changes.

2003-01-08  Peter Williams  <peterw@ximian.com>

	* frontends/scripting/Makefile.in: Make the jay rule not clobber Parser.cs
	if jay fails, and add a rule to regenerate Makefile if needed.

	* backends/ProcessStart.cs: If no directory argument is given, assume
	we're looking in the current directory.

2003-01-06  Martin Baulig  <martin@ximian.com>

	* configure.in: Set version number to 0.1.7 (this is an odd number
	which means that we're still unstable ...)

2003-01-06  Martin Baulig  <martin@ximian.com>

	* doc/debugger-status.txt: Added a "How you can help with the
	debugger" section.

2003-01-06  Martin Baulig  <martin@ximian.com>

	* doc/debugger-status.txt: Added a few notes about the current
	status here.

2003-01-06  Martin Baulig  <martin@ximian.com>

	* doc/debugger-status.txt: Updated this document.

	* doc/roadmap.txt: This one was too much outdated.  Removed.

	* RELEASE-NOTES-0.2.0.txt: Started to document all the cool new
	features here.

2003-01-06  Martin Baulig  <martin@ximian.com>

	* tests/TestManagedTypes.cmd: Added a few more test cases here.

2003-01-06  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/: It's called `accessible', not `accessable'.

2003-01-05  Martin Baulig  <martin@ximian.com>

	* NEWS: Added a new item :-)

	* RELEASE-NOTES-0.1.0.txt: Added a comment about this release
	which never really happened.

2003-01-05  Martin Baulig  <martin@ximian.com>

	* test/test.in: Added `test' target to run all the tests.

2003-01-05  Martin Baulig  <martin@ximian.com>

	* test/D.cs: Renamed to TestManagedTypes.cs.

2003-01-05  Martin Baulig  <martin@ximian.com>

	* lib/Debugger.exe.config.in: Moved here from ../test.
	* lib/Interpreter.exe.config.in: Moved here from ../test.

	* lib/: New directory.  Build everything here instead of in the
	test/ directory.

	* test/: This directory will now contain only tests.

2003-01-05  Martin Baulig  <martin@ximian.com>

	* backends/IInferior.cs (Run): Added `bool redirect_fds' argument;
	if false, we don't redirect stdout and stderr.  This is used in
	the command line interpreter.

2003-01-04  Peter Williams  <peterw@ximian.com>

	* configure.in (READLINE_DEPLIBS): Check to see if libreadline
	needs -ltermcap and if so define it here.

	* glue/Makefile.am (libmonodebuggerreadline_la_LIBADD): Use
	@READLINE_DEPLIBS@ here.

2003-01-05  Martin Baulig  <martin@ximian.com>

	* backends/ProcessStart.cs: The way how the debugger starts the
	JIT has changed; make sure to update your JIT as well.

2003-01-04  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/ScriptingContext.cs: Support non-interactive
	debugging sessions; when reading commands from a file, we don't
	print the current frame when we stop and all errors are always fatal.

2003-01-04  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Parser.jay: Added a couple of `assert'
	commands to be used in a test suite.

2003-01-04  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetObject.cs (Kind): Moved to ITargetType.

	* interfaces/ITargetType.cs (Kind): Moved this property here.

2003-01-04  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Parser.jay: Added "length ($a)",
	"upper ($a)" and "lower ($a)" where $a is an array.

2003-01-04  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Parser.jay: Added the parent expression
	"print parent ($foo)".

2003-01-04  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Parser.jay: Added the array access
	expression "print $a [5]".

2003-01-04  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Parser.jay (variable_expression): Move the
	`STAR variable_expression' rule above the struct element one.
	Added grouping expression "print (*$c.Object).Foo".

2003-01-04  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Command.cs (VariableExpression): Added
	`ResolveType' which returns an ITargetType (without accessing the
	ITargetObject if possible).

	* frontends/scripting/Parser.jay: The `show type' command now
	accepts an arbitrary `variable_expression'.

2003-01-04  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetFundamentalObject.cs: New interface.

	* interfaces/ITargetFundamentalType.cs: New interface.

	* interfaces/TargetObjectKind.cs: New enum.

	* interfaces/ITargetObject.cs (Kind): New property.
	(HasObject, Object): Removed.

	* interfaces/ITargetType.cs (HasObject): Removed.

	* backends/mono-csharp/MonoFundamentalObjectBase.cs: New abstract
	base class for ITargetFundamentalObject.

2003-01-04  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Command.cs (VariableExpression): Added
	`ResolveVariable' method which returns an ITargetObject.

	* interfaces/ITargetPointerObject.cs
	(HasDereferencedObject, DereferencedObject): New properties.

2003-01-04  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Parser.jay: Added the dereferencing
	expression "print *$a" where $a is a pointer or a Mono `object'.

2003-01-04  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Command.cs: Renamed the old
	VariableExpression to VariableReferenceExpression.
	(VariableExpression): New abstract class.

	* frontends/scripting/Parser.jay (variable_expression): This is
	now always a VariableExpression.  Added scripting variables; you
	can now say "set !foo = $b.Test" and then later reference it with
	"print !foo".

2003-01-04  Martin Baulig  <martin@ximian.com>

	* backends/IInferior.cs (Bfd): New public property.

	* backends/Debugger.cs: Create a MonoCSharpLanguageBackend for
	core files from managed applications; use a special construction
	for it, it'll only read the symbol tables once on construction.

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs: Provide a
	second .ctor which takes a CoreFile argument and immediately reads
	the symbol tables.

2003-01-04  Martin Baulig  <martin@ximian.com>

	* configure.in: Link against -liberty as well as -lbfd.

	* classes/IOChannel.cs: Put this into the namespace Mono.Debugger.

	* classes/Utils.cs: Duplicate the contents of GLib.FileUtils here;
	this was the only method which we were using from glib-sharp in
	the backend, so this dependency is now gone.

	* test/Makefile.in: Don't link against glib-sharp.dll in the backend.

2003-01-04  Martin Baulig  <martin@ximian.com>

	* classes/Backtrace.cs: Don't make this abstract; move the stack
	unwind stuff from the SingleSteppingEngine here.

2003-01-03  Martin Baulig  <martin@ximian.com>

	* interfaces/IProcess.cs: Don't implement ITargetNotification.
	(IProcess.GetMemoryMaps): New method.

	* backends/SingleSteppingEngine.cs: Implement ITargetAccess and
	IProcess.

	* backends/TargetMemoryArea.cs: Moved to ../classes.

	* classes/TargetMemoryArea.cs: Moved here from ../backends; the
	.ctor is now public.

2003-01-03  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs: Breakpoints
	in not-yet-JITed methods are finally working again :-)

2003-01-02  Martin Baulig  <martin@ximian.com>

	* frontends/command-line/Main.cs: If the user gave any command
	line arguments, immediately start the program.

	* frontends/scripting/Parser.jay: The `start' command no longer
	has any default arguments, so it doesn't accept an empty list anymore.

2003-01-02  Martin Baulig  <martin@ximian.com>

	* backends/Process.cs (Process.Inferior): Removed this property.
	The IInferior is now a private interface and is not exposed to the
	outside.

2003-01-02  Martin Baulig  <martin@ximian.com>

	* interfaces/ILanguageBackend.cs: Moved to ../backends.

	* backends/ILanguageBackend.cs: This is now an internal interface.
	(BreakpointHit, GetTrampoline): Take an IInferior, not an
	IProcess argument.

	* classes/Module.cs (Module.Language): The return type of this
	property is now `object'.

	* arch/BfdContainer.cs: Don't implement ILanguageBackend.

2003-01-02  Martin Baulig  <martin@ximian.com>

	* arch/CoreFile.cs: Don't implement IInferior, just IProcess and
	ITargetAccess.

2003-01-02  Martin Baulig  <martin@ximian.com>

	* classes/AddressDomain.cs: New global class.

	* classes/TargetAddress.cs: Use an instance of the new
	AddressDomain class as the domain instead of just an `object'.
	The AddressDomain has a name and an unique ID which is now used in
	all error messages - this helps you a lot if you're evey wondering
	why a comparision fails with an ArgumentException.

2003-01-01  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetMemoryAccess.cs (ITargetMemoryInfo): New
	interface; derives from ITargetInfo; added `AddressDomain' and
	'GlobalAddressDomain' properties.
	(ITargetMemoryAccess): Derive from ITargetMemoryInfo.

	* arch/*.cs: Don't use the IInferior here.

2003-01-01  Martin Baulig  <martin@ximian.com>

	* interfaces/ITargetMemoryAccess.cs (ITargetAccess): New
	interface; derives from ITargetMemoryAccess has has a function to
	read a register.

	* arch/ArchitectureI386.cs: The ctor now takes an ITargetAccess
	and the global address domain; we don't use the IInferior here any
	longer.

2003-01-01  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Parser.cs: Added `disassemble' and
	`disassemble method' commands.

2003-01-01  Martin Baulig  <martin@ximian.com>

	Happy New Year 2003 :-)

	* classes/Backtrace.cs: New public class; we're now using an
	instance of this class instead of a `StackFrame[]' for a backtrace.

	* classes/StackFrame.cs (Register): New public struct.
	(StackFrame.Registers): New abstract property.

	* backends/process.cs (Process.GetBacktrace): Return a Backtrace,
	not a StackFrame[].

	* arch/ArchitectureI386.cs (UnwindStack): New function to unwind
	the stack to get the registers of another stack frame.

2002-12-31  Martin Baulig  <martin@ximian.com>

	This is the end of the Year 2002.

	* frontends/scripting/Parser.jay: Implemented the `$a.Test'
	expression to access a struct/class field.

2002-12-31  Martin Baulig  <martin@ximian.com>

	* classes/StackFrame.cs: Made this class abstract.
	(Handle): Removed this property.
	(LocalsAddress, ParamsAddress): New abstract properties.
	(TargetMemoryAccess): New abstract property.

	* classes/SingleSteppingEngine.cs: Explicitly implement
	ITargetMemoryAccess; we're sending a sync_command for each
	operation.  This is used to read the target's memory.

2002-12-31  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Parser.jay: Added `print $name'.

2002-12-31  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Tokenizer.cs: Only recognize the short
	keywords at the start of the line; `$' starts an identifier, so
	don't recognize any keywords in it.

	* frontends/scripting/Parser.jay: Added `show type $name' to show
	the type of a variable/parameter.

2002-12-31  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs: The big type
	table rewrite; the JIT now allocates types in continuous memory
	areas rather than using an individually malloc()ed block for each
	type.

2002-12-30  Martin Baulig  <martin@ximian.com>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs: The big
	rewrite; we're doing all the symbol table stuff in a background
	thread when we get a notification from the JIT.

	* backends/ThreadManager.cs: If we're debugging a managed
	application, the JIT creates a special debugger thread for us;
	create a DaemonThreadRunner for this thread.

2002-12-30  Martin Baulig  <martin@ximian.com>

	* arch/Bfd.cs: Use the ThreadManager as the TargetAddress domain
	for all symbol table addresses; they must be shared between all
	the threads.

	* interfaces/ILanguageBackend.cs (GetTrampoline, BreakpointHit):
	Added IProcess argument.

	* interfaces/ITargetMemoryAccess.cs
	(ITargetMemoryReader): Added `ReadGlobalAddress'; uses the
	ThreadManager as the TargetAddress'es domain.
	(ITargetMemoryAccess): Likewise.

2002-12-30  Martin Baulig  <martin@ximian.com>

	* backends/DaemonThreadRunner.cs: New public class.

	* backends/ThreadManager.cs: Use the DaemonThreadRunner for the
	pthread library's manager thread.

	* interfaces/ITargetNotification.cs (TargetState): Added `DAEMON'
	for undebuggable daemon threads.

2002-12-30  Martin Baulig  <martin@ximian.com>

	* backends/Debugger.cs: Only create the `csharp_language' if we're
	actually debugging a managed application.

	* backends/server/i386-linux-ptrace.c (server_ptrace_kill): Use
	`kill (handle->pid, SIGKILL)', not `ptrace (PTRACE_KILL)' since
	kill() works from any thread.
	(server_ptrace_finalize): Detach from the target after killing it.

2002-12-29  Peter Williams  <peterw@ximian.com>

	* frontends/gui/DebuggerGUI.cs (Main): Any argument after a
	nonoption argument is not for us, so just add it to args.
	(LoadProgram): Pass in our environment variables to the
	child process.

2002-12-28  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Parser.jay: Transformed all the old
	Expressions into Commands.

2002-12-27  Martin Baulig  <martin@ximian.com>

	* backends/server/breakpoints.h (BreakpointManager): Use a
	GStaticRecMutex instead of a GMutex so we can call
	mono_debugger_breakpoint_manager_lock/unlock recursively from the
	same thread.

	* backends/server/i386-linux-ptrace.c (server_ptrace_read_data):
	Remove breakpoints from the returned memory area.

2002-12-26  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Parser.jay: The `break' command now takes
	an opt_process argument.

2002-12-26  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs: Correctly step over
	breakpoints in the current thread.

	* backends/IInferior.cs
	(EnableAllBreakpoints, DisableAllBreakpoints): Removed.

2002-12-26  Martin Baulig  <martin@ximian.com>

	* inferfaces/IProcess.cs: New interface.  This is implemented by
	backends/Process.cs; it's some kind of a hack because Process.cs
	is in the backends dir, but I need this in Module.cs.

	* classes/ThreadGroup.cs: New public class.  It is used to share
	information about breakpoints and signal handlers between
	different invocations of the same target.

	* classes/Module.cs (AddBreakpoint): Added ThreadGroup argument.
	(EnableBreakpoint, DisableBreakpoint): Likewise.

	* backends/classes/NativeModule.cs
	(EnableBreakpoint, DisableBreakpoint): Enable/disable the
	breakpoint on all threads in the ThreadGroup.

	* backends/SingleSteppingEngine.cs
	(InsertBreakpoint, RemoveBreakpoint): Make this work again.

	* frontends/scripting/Parser.jay: Added `break' command to insert
	a breakpoint.

2002-12-25  Martin Baulig  <martin@ximian.com>

	* arch/Bfd.cs (Bfd.GetDisassembler): Take an IInferior argument
	and actually pass that argument to the BfdDisassembler's ctor; we
	cannot share a disassembler between multiple IInferior's.

2002-12-25  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs: If we're stepping one instruction
	and receive signal which we're supposed to ignore, the stepping operation
	has already been completed and we don't need to resume the target.

2002-12-25  Martin Baulig  <martin@ximian.com>

	* frontends/gui/ProcessManager.cs: Added thread manager GUI.

2002-12-25  Martin Baulig  <martin@ximian.com>

	* classes/DebuggerTextWriter.cs: New abstract base class.

	* frontends/scripting/ScriptingContext.cs: Use two
	DebuggerTextWriter's for the debugger and inferior output.

	* frontends/gui/OutputWindow.cs: Rewrote this to use the new
	DebuggerTextWriter.  We're now using a separate output window
	for the inferior output and error output is displayed in red.

2002-12-25  Martin Baulig  <martin@ximian.com>

	* frontends/gui/DebuggerWidget.cs: Renamed SetBackend -> SetProcess;
	the DebuggerBackend can already be set in the ctor, so this only
	takes a Process argument.

2002-12-25  Martin Baulig  <martin@ximian.com>

	* classes/NativeMethod.cs: Create the ISourceBuffer in the ctor.

	* frontends/gui/SourceView.cs: Make this work again.

2002-12-24  Martin Baulig  <martin@ximian.com>

	This is my last commit for today, so merry x-mas !

2002-12-24  Martin Baulig  <martin@ximian.com>

	The Monday Night Hack of week #52 - the BreakpointManager is done.

	* backends/BreakpointManager.cs: New file.  This is just a wrapper
	around the unmanaged API in backends/server/breakpoints.[ch].

	* backends/server/breakpoints.[ch]: New files.
	* backends/server/i386-linux-ptrace.c: Use a breakpoint manager
	which is shared between all threads of the same application.

	* backends/ThreadManager.cs
	(AcquireGlobalThreadLock, ReleaseGlobalThreadLock): Don't
	lock/unlock the calling process.

	* backends/SingleSteppingEngine.cs: Breakpoints are almost working
	again; we can now safely hit a breakpoint in another thread
	(except of a few race conditions which aren't fixed yet).

2002-12-23  Martin Baulig  <martin@ximian.com>

	* frontends/gui/SourceManager.cs (SourceManager): Added events
	`MethodInvalidEvent', `MethodChangedEvent', `FrameChangedEvent'
	and `FramesInvalidEvent'.
	(SourceList): Connect these events on the SourceManager, not on
	the Process since their handlers must be called from the gtk# thread.

	* frontends/gui/DebuggerWidget.cs
	(RealMethodChanged, RealMethodInvalid): New protected virtual
	methods which may be called from any thread.
	(MethodChanged, MethodInvalid): New protected virtual methods
	which are guaranteed to be called from the gtk# thread.

2002-12-23  Martin Baulig  <martin@ximian.com>

	* frontends/gui/DebuggerWidget.cs
	(RealFrameChanged, RealFramesInvalid, RealStateChanged): New
	protected virtual methods which may be called from any thread.
	(FrameChanged, FramesInvalid, StateChanged): New protected virtual
	methods which are guaranteed to be called from the gtk# thread.

2002-12-23  Martin Baulig  <martin@ximian.com>

	* class/ThreadNotify.cs: This can now have multiple listeners
	(since file descriptors are a precious resource).

2002-12-23  Martin Baulig  <martin@ximian.com>

	* frontends/gui/DebuggerWidget.cs: Added `DebuggerGUI' argument;
	get the Glade.XML from an internal property of the gui.
	* frontends/gui/SourceManager.cs: Derive from DebuggerWidget.

2002-12-15  Martin Baulig  <martin@ximian.com>

	* frontends/gui/RegisterDisplay.cs: Make this working again.
	* frontends/gui/CurrentInstructionEntry.cs: Likewise.

2002-12-15  Martin Baulig  <martin@ximian.com>

	* frondends/command-line/Interpreter.cs: Use the new command line
	interface here.

2002-12-15  Martin Baulig  <martin@ximian.com>

	* backends/ThreadManager.cs: Added a global thread lock mechanism.

2002-12-14  Martin Baulig  <martin@ximian.com>

	* backends/SingleSteppingEngine.cs: All step commands now take an
	additional `bool synchronous' argument and return true on success;
	if the `synchronous' argument is set, the engine waits until the
	operation has been completed before returning.

2002-12-14  Martin Baulig  <martin@ximian.com>

	* backends/ThreadManager.cs: New file.

2002-12-13  Martin Baulig  <martin@ximian.com>

	* backends/server/i386-linux-ptrace.c: Added hardware breakpoints.

	* backends/SingleSteppingEngine.cs: Use a hardware breakpoint for
	the temporary breakpoints; this'll avoid some bigger headaches
	with threads.

2002-12-13  Martin Baulig  <martin@ximian.com>

	WARNING: The Debugger is currently more or less broken since I
	haven't finished all this stuff yet.

	Rewrote and redesigned the SingleSteppingEngine to do all the
	stepping in a background thread.

	* backends/server/*, backends/ptrace/PTrace.cs: Simplified this
	ugly async stuff; since we're now running in our own thread, we
	can just wait for our child.

2002-12-13  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/Parser.cs: Added `finish' command.

	* frontends/command-line/Interpreter.cs: Commented out almost
	everything in this file; it'll go away really soon.

	* classes/ThreadNotify.cs: New class; this is basically the same
	than Gtk.ThreadNotify, but we can't link against gtk in the
	backend.

	* classes/IOChannel.cs (IODataInputChannel, IODataOutputChannel):
	Added these classes for data channels.

	* backends/Process.cs, backends/Debugger.cs: Moved all
	process-specific stuff to the new `Process' class.

	* frontends/gui/DebuggerWidget.cs (DebuggerWidget.SetBackend):
	Added `Process process' argument; use the Process everywhere
	instead of the DebuggerBackend.

2002-12-11  Martin Baulig  <martin@ximian.com>

	* backends/server/i386-linux-ptrace.c: Get the registers each time
	the target stops and store them.

2002-12-11  Martin Baulig  <martin@ximian.com>

	* backends/ProcessStart.cs: New class.  Moved the argv and envp
	stuff here; this class specifies how to launch an application.

2002-12-10  Martin Baulig  <martin@ximian.com>

	* backends/Debugger.cs (DebuggerBackend.Run): This method
	now returns a new Process.
	(DebuggerBackend.ReadCoreFile): Likewise.

	* backends/Process.cs: Moved a few more things from Debugger.cs.

2002-12-10  Martin Baulig  <martin@ximian.com>

	Started to split DebuggerBackend into DebuggerBackend and Process.
	Later one, a DebuggerBackend will have a Process for each thread
	of the application being debugged.

	* backends/Process.cs: New public class.

2002-12-10  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/ScriptingContext.cs: Renamed `Process' to
	`ProcessHandle' since I'm about to create backends/Process.cs.

2002-12-08  Martin Baulig  <martin@ximian.com>

	* class/ObjectCache.cs: Use one global cleanup thread rather than
	one thread per object.

2002-12-08  Radek Doulik  <rodo@ximian.com>

	* glue/mono-debugger-readline.h: include stdio.h - fixes
	compilation on rh8, where readline .h file doesn't include it and
	FILE is then there undefined

2002-12-01  Martin Baulig  <martin@ximian.com>

	* frontends/scripting/: Added new scripting interface.

2002-11-30  Martin Baulig  <martin@ximian.com>

	* glue/mono-debugger-readline.[ch]: New files.

	* classes/GnuReadLine.cs: Added interface to GNU Readline.

2002-11-28  Martin Baulig  <martin@ximian.com>

	* frontends/command-line/Main.cs: Added new stand-alone command
	line interpreter.

	* frontends/command-line/Interpreter.cs: Improved this a bit.

2002-10-18  Martin Baulig  <martin@gnome.org>

	* RELEASE-NOTES-0.1.0.txt: Added preliminary release notes.

2002-10-17  Martin Baulig  <martin@gnome.org>

	* backends/SingleSteppingEngine.cs: Don't change the state to
	running unless the stepping operation actually succeeded.  Don't
	allow any stepping operations while sending out the event.

2002-10-17  Martin Baulig  <martin@gnome.org>

	* interfaces/ITargetLocation.cs, class/TargetLocation.cs: Removed.
	* backends/class/RelativeTargetLocation.cs: Removed.
	* backends/class/TargetStackLocation.cs: Removed.

	* interfaces/ITargetObject.cs (ITargetObject.Location): Removed
	this property, not all variables have an address.

	* backends/mono-csharp/MonoTargetLocation.cs: New class.
	* backends/mono-csharp/MonoStackLocation.cs: New class.
	* backends/mono-csharp/MonoRegisterLocation.cs: New class.
	* backends/mono-csharp/MonoRelativeTargetLocation.cs: New class.

	* backends/mono-csharp/: Use the new MonoTargetLocation code.

	* classes/StackFrame.cs (StackFrame.Level): New property.

2002-10-17  Martin Baulig  <martin@gnome.org>

	* interface/ILanguage.cs: Removed.

2002-10-15  Miguel de Icaza  <miguel@ximian.com>

	* frontends/gui/DebuggerGUI.cs: Check state of the backend before
	issuing a command, as even if we grey menu items, events can be
	queued.

	Reactivate the sensitivity code.

	Desensitize `Program to Debug' when running.

	* frontends/gui/ProgramToDebug.cs: Display the current settings,
	and allow the user to change those, instead of re-entering them. 

2002-10-14  Martin Baulig  <martin@gnome.org>

	* configure.in: We don't need to check for gdb anymore.

	* test/Debugger.exe.config.in: The configuration file is now
	finally called `Debugger.exe.config'.

2002-10-13  Martin Baulig  <martin@gnome.org>

	* class/SourceInfo.cs: Only read the methods when they're needed.

2002-10-12  Martin Baulig  <martin@gnome.org>

	Implemented a SymbolTableManager which maintains all the symbol
	tables and which uses a separate thread to update things in the
	background.

	Since reading the source list is a very CPU consuming operation
	and the source list is only needed when inserting a new breakpoint,
	it is now also read in the background thread.

	* class/SymbolTableManager.cs: This class now maintains all the
	symbol tables.  It's using a separate thread to update things in
	the background.

	* class/AsyncQueue.cs: New class.

	* class/SymbolTableCollection.cs: Added Lock() and UnLock()
	methods to avoid updates while adding several symbol tables.

	* arch/DwarfReader.cs: This class is now thread-safe.

	* interfaces/ILanguageBackend.cs (ILanguageBackend.SymbolTable):
	Removed, the SymbolTableManager now holds all the symbol tables.

	* backends/Debugger.cs: Use the SymbolTableManager.

2002-10-12  Martin Baulig  <martin@gnome.org>

	* class/Module.cs: Added property to get the ISymbolTable.

	* backends/Debugger.cs: Do all the symbol table handling here
	based on the module list.  Modifying the Module.StepInto property
	of shared libraries will now actually work.

	* backends/BfdModule.cs: Only report the symbols being loaded if
	we have a DwarfReader.

2002-10-11  Martin Baulig  <martin@gnome.org>

	* backends/server/i386-linux-ptrace.c: If the target received a
	signal, remember it and pass it to the target the next time it is
	resumed.  Also added a function to modify/clear the signal.

	* backends/Debugger.cs (DebuggerBackend.ClearSignal): New method
	to clear the signal.

2002-10-11  Martin Baulig  <martin@gnome.org>

	* arch/CoreFile.cs (CoreFile.GetMemoryMaps): New method to get a
	TargetMemoryArea[] for the core file's sections.

	* frontends/gui/MemoryMapsDisplay.cs: Added memory map display.

2002-10-11  Martin Baulig  <martin@gnome.org>

	* backends/TargetMemoryArea.cs: New struct.

	* backends/IInferior.cs (IInferior.GetMemoryMaps): New method to
	get the memory maps as an array of TargetMemoryArea's.

	* frontends/gui/HexEditor.cs: Use the memory maps to ensure that
	we're only accessing mapped memory, allow editing of the memory.
	You need a new Gtk# for this.

2002-10-11  Martin Baulig  <martin@gnome.org>

	* frontends/gui/HexEditor.cs: Added hex editor.

2002-10-11  Martin Baulig  <martin@gnome.org>

	* frontends/gui/ModuleDisplay.cs: Added module display.

2002-10-10  Martin Baulig  <martin@gnome.org>

	Improved core file support.

	* backends/IInferior.cs (IInferior.UpdateModules): New method to
	reload the modules.

	* backends/Debugger.cs (Backend.CurrentFrame, Backend.CurrentMethod,
	Backend.GetBacktrace): Don't use the SingleSteppingEngine if this
	is a core file.

	* arch/Bfd.cs: Improved support for core files and shared libraries.

2002-10-09  Miguel de Icaza  <miguel@ximian.com>

	* frontends/gui/VariableDisplay.cs: Add a few GUI touchups to the
	variable display.

2002-10-08  Martin Baulig  <martin@gnome.org>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoCSharpLanguageBackend): Don't derive from SymbolTable but use
	a separate symbol table. This allows us to release the symbol
	table completely when the target exits.

	* backends/Debugger.cs (InferiorStateNotify): Removed this event,
	use the StateChanged event instead.

2002-10-05  Martin Baulig  <martin@gnome.org>

	* frontends/gui/: Display the SourceStatusbar while the source
	code is visible and the TargetStatusbar while the CPU view is
	visible.

2002-10-05  Martin Baulig  <martin@gnome.org>

	* frontends/gui/SourceView.cs: Made this class abstract.

	* frontends/gui/SourceManager.cs: Use Gtk.SourceView.

2002-10-03  Miguel de Icaza  <miguel@ximian.com>

	* frontends/gui/DebuggerGUI.cs: Hook up the signal and show an
	error message.

2002-10-02  Miguel de Icaza  <miguel@ximian.com>

	* frontends/gui/SourceManager.cs: Add code to switch to a newly
	loaded file by default.

	* frontends/gui/RegisterDisplay.cs: Allow values to be changed,
	rewrite code to minimize duplicated code.

	Turn off advanced mode, so segment registers are not shown

	* backends/IInferior.cs: New property to tell if we can update the
	registers or not.
	
	* frontends/gui/Report.cs: New file, requires an updated Gtk#
	
	* arch/ArchitectureI386.cs: Add TOP constant.

2002-10-02  Martin Baulig  <martin@gnome.org>

	* interfaces/ITargetNotification.cs
	(ITargetNotification.DebuggerOutput): New event to emit diagnostic
	messages and errors.
	(ITargetNotification.DebuggerError): New event to emit non-fatal
	exceptions.

	* backends/Debugger.cs: Improved error handling a bit, we emit a
	`DebuggerError' event if we could not load the symbol table
	instead of throwing an exception.

2002-10-02  Martin Baulig  <martin@gnome.org>

	* backends/IInferior.cs (IInferior.SetRegister, SetRegisters):
	New methods to set registers.

	* backends/Debugger.cs (DebuggerBackend.SetRegister, SetRegisters):
	New methods to set registers.

2002-10-02  Martin Baulig  <martin@gnome.org>

	* interfaces/ITargetStructType.cs (ITargetStructType.Methods):
	New property to get the methods.
	(ITargetMethodInfo): New interface to represent a method.

	* interfaces/ITargetStructObject.cs (ITargetStructObject.PrintObject):
	New method to call a method in the target to print the object.

2002-10-01  Miguel de Icaza  <miguel@ximian.com>

	* frontends/command-line/Interpreter.cs: Update online help.

	* frontends/gui/RegisterDisplay.cs: Love touch ups, it now works
	as intended.

	* backends/Debugger.cs: Add a new event to notify when the
	inferior is set/reset.
	
	* frontends/gui/RegisterDisplay.cs: Use a custom view for the x386
	view of the register, so we can modify the flags at some point,
	and also to encourage the creation of target-specific register
	views that make sense for that particular target. 

	* frontends/gui/Utils.cs: Bug fix.

2002-10-01  Martin Baulig  <martin@gnome.org>

	* backends/mono-csharp/: Make "boxing" of non-valuetypes actually
	work.  Added exception support to the properties.

2002-10-01  Martin Baulig  <martin@gnome.org>

	Reworked the module stuff, implemented breakpoints and start to
	add support for properties.

	* interfaces/IModule.cs: Removed, has been replaced with class/Module.cs.

	* class/Module.cs: New public class, replaces IModule.  This class
	maintains all the breakpoints.

	* interfaces/ISymbolTable.cs (ISymbol): Removed this interface.

	* class/SingleSteppingEngine.cs: Moved the single-stepping engine
	into its own class.  This is now also doing all the method lookups.

2002-09-27  Martin Baulig  <martin@gnome.org>

	* arch/BfdContainer.cs: New class to hold all Bfd instances of the
	DebuggerBackend.  It also maintains the module table and allows it
	to be shared across different invocations of the target.

	* interfaces/ISymbolTable.cs: Started to work on lookup-by-name.
	(ISymbol): New interface.
	(ISymbolLookup): Added `ISymbol Lookup (string name)'.
	(ISymbolTable): Added HasSymbols and Symbols properties.

2002-09-27  Martin Baulig  <martin@gnome.org>

	* interfaces/IModule.cs (IModule.StepInto): New property to
	specify whether to enter methods in this module while
	single-stepping.

	* interfaces/IMethod.cs (IMethod.Language): Removed.
	(IMethod.Module): Added.

	* backends/ptrace/PTrace.cs (PTraceInferior.Step): Don't enter a
	method if it's IModule.StepInto is false.

2002-09-27  Martin Baulig  <martin@gnome.org>

	* interfaces/IModule.cs: New interface.

	* backends/Debugger.cs (DebuggerBackend.Modules): New property to get a
	list of loaded modules.
	(DebuggerBackend.ModulesChangedEvent): New event.

2002-09-27  Martin Baulig  <martin@gnome.org>

	* class/MethodBase.cs: Don't implement IMethodSource, added
	protected SetSource() method to set the IMethodSource.

2002-09-27  Martin Baulig  <martin@gnome.org>

	* backends/*, arch/*: Removed the SourceFileFactory argument everywhere.

2002-09-27  Martin Baulig  <martin@gnome.org>

	* frontends/gui/SourceManager.cs: If ISourceBuffer.HasContents is false,
	ISourceBuffer.Name is a filename which we need to load.

	* backends/mono-csharp/CSharpMethod.cs: Don't lookup source files.
	* arch/DwarfReader.cs: Likewise.

2002-09-27  Miguel de Icaza  <miguel@ximian.com>

	* frontends/gui/SourceManager.cs: New file, it will hold the
	source code manager, and currently also hosts the source listing
	widget (it will replace the old code in the future, but I have
	ketp it for compatibility reasons).

2002-09-27  Martin Baulig  <martin@gnome.org>

	* interfaces/IArchitecture.cs (IArchitecture.GetBreakpointTrampolineData):
	New method to read the data from a JIT breakpoint trampoline.

	* inferfaces/ILanguageBackends.cs (ILanguageBackend.BreakpointHit): New
	method.  The language backend may decide to continue the target if hit
	a breakpoint.

	* backends/ptrace/PTrace.cs (PTraceInferior.Continue): Don't check
	the `until' address, this is now done in DebuggerBackend.
	* backends/Debugger.cs (DebuggerBackend.Continue): Moved the check
	here.

	* backends/Debugger.cs (DebuggerBackend.frame_changed): If we hit
	a breakpoint and the language backend told us to continue, do so.

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs
	(MonoCSharpLanguageBackend.BreakpointHit): If we're in the
	breakpoint trampoline, get its data but ignore the breakpoint for
	the moment.

	* backends/server/i386-linux-ptrace.c (server_ptrace_child_stopped):
	Send a `(MESSAGE_CHILD_HIT_BREAKPOINT, 0)' if we hit an unknown
	breakpoint, ie. there was an `int 3' in the code which we did not insert.

2002-09-26  Martin Baulig  <martin@gnome.org>

	* classes/ILDisassembler.cs: Removed.  We use the .il which has
	been created by the JIT as source code.

2002-09-26  Martin Baulig  <martin@gnome.org>

	* backends/Debugger.cs (DebuggerBackend.LoadNativeSymbolTable): New public
	property.  Only load the native symbol table if this is set.
	
2002-09-26  Martin Baulig  <martin@gnome.org>

	* interfaces/ISourceBuffer.cs (ISourceBuffer.HasContents): New property.

	* backends/Debugger.cs: Make the source factory optional and
	create an ISourceBuffer without contents if we don't have it.

2002-09-23  Martin Baulig  <martin@gnome.org>

	* interfaces/ITargetArray.cs: New interface.

	* interfaces/ITargetObject.cs: Replaced location with type, added HasObject
	and Object.

	* interfaces/ITargetType.cs (ITargetType.GetObject): Removed.

	* backends/classes/RelativeTargetLocation.cs: New class.

	* backends/mono-csharp/: Improved the type system; we're now supporting
	strings and arrays.

2002-09-21  Martin Baulig  <martin@gnome.org>

	* README: Added information about the directory layout.

	* NEWS: Started to maintain a NEWS file :-)

2002-09-21  Martin Baulig  <martin@gnome.org>

	* backends/classes/: New directory.
	* backends/classes/TargetReader.cs: Moved here.
	* backends/classes/TargetStackLocation.cs: Moved here.

2002-09-21  Martin Baulig  <martin@gnome.org>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs (SymbolTableException):
	This exception already exists in class/SymbolTableException.cs.

2002-09-21  Martin Baulig  <martin@gnome.org>

	* backends/StepFrame.cs: Moved StepFrame here and made it `public sealed'.

	* backends/IInferior.cs (IStepFrame): We don't need this interface.

2002-09-21  Martin Baulig  <martin@gnome.org>

	* backends/Debugger.cs (TargetAsyncResult): Make this a private nested class
	inside PTraceInferior.

	* backends/TargetReader.cs: Moved TargetInfo and TargetReader here.

	* backends/ptrace/PTrace.cs: Renamed the class to PTraceInferior.

2002-09-21  Martin Baulig  <martin@gnome.org>

	* arch/Bfd.cs, BfdDisassembler.cs, DwarfReader.cs: Made these classes internal.

2002-09-21  Martin Baulig  <martin@gnome.org>

	* classes/StackFrame.cs: Moved here and made `public sealed'.

2002-09-21  Martin Baulig  <martin@gnome.org>

	* interfaces/ISourceLocation.cs: Removed.
	* classes/SourceLocation.cs: This is the only implementation.

2002-09-21  Martin Baulig  <martin@gnome.org>

	* interfaces/IBreakPoint.cs: Killed.

2002-09-21  Martin Baulig  <martin@gnome.org>

	* interfaces/ISourceFile.cs: Removed.
	* classes/SourceFileFactory.cs: This is the only implementation.

2002-09-21  Martin Baulig  <martin@gnome.org>

	* interfaces/ISymbolTable.cs (ISymbolTableCollection): Removed this interface.
	* classes/SymbolTableCollection.cs: This is the only implementation.

2002-09-21  Martin Baulig  <martin@gnome.org>

	* interfaces/IDebuggerBackend.cs: Removed.
	* interfaces/IStackFrame.cs: Removed.
	* interfaces/IInferior.cs: Moved to ../backends/.

	* classes/IOChannel.cs: Moved here from ../backends/ptrace/ and made public.

	* classes/Variable.cs: Removed.

	* backends/StackFrame.cs: Moved the StackFrame class here and made it public.
	* backends/IInferior.cs: Moved here from ../interfaces/.
	* backends/TargetStackLocation.cs: Moved here from ../classes/.
	* backends/Debugger.cs: It's now called `DebuggerBackend'.

	* test/Makefile.in: Create Mono.Debugger.dll and Mono.Debugger.Backend.dll.

2002-09-21  Martin Baulig  <martin@gnome.org>

	* interfaces/ILanguageCSharp.cs: Killed.

2002-09-21  Martin Baulig  <martin@gnome.org>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs: Make this
	work with the new symbol table format.

	* arch/CoreFile.cs, CoreFileElfI1386.cs: Reading memory and
	getting a backtrace works.

2002-09-21  Martin Baulig  <martin@gnome.org>

	* interfaces/IMethod.cs (IMethod.Locals): New property.

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs (MonoMethod):
	Added support for local variables.

2002-09-20  Martin Baulig  <martin@gnome.org>

	* interfaces/IStackFrame.cs (IStackFrame.GetLocalVariableLocation): Removed.
	(IStackFrame.GetParameterLocation): Removed.
	(IStackFrame.TargetMemoryAccess): New property.

	* interfaces/ITargetObject.cs: New interface.

2002-09-20  Martin Baulig  <martin@gnome.org>

	* interfaces/IInferior.cs (IInferiorStackFrame.Inferior): New property.

	* interfaces/ITargetLocation.cs (ITargetLocation.ReValidate): Removed.
	(ITargetLocation.Handle): New property.

	* interfaces/ITargetMemoryAccess.cs
	(ITargetMemoryReader.Size): New property.
	(ITargetMemoryReader.Contents): New property.
	(ITargetMemoryAccess.GetMemoryStream): Removed.

	* backends/mono-csharp/MonoVariable.cs: We can now read a parameter as a blob.
	
2002-09-20  Martin Baulig  <martin@gnome.org>

	Started to add support for variables.

	* interfaces/ITargetType.cs: New public interface.

	* interfaces/IVariable.cs: New public interface.

	* interfaces/IMethod.cs (IMethod.Parameters): New property.

2002-09-20  Martin Baulig  <martin@gnome.org>

	* backends/mono-csharp/MonoCSharpLanguageBackend.cs (MonoMethod):
	Set IMethod.MethodHandle to the method's Reflection.MethodBase.
	
2002-09-20  Martin Baulig  <martin@gnome.org>

	Started to add support for core files.

	* interfaces/IDebuggerBackend.cs (IDebuggerBackend.ReadCoreFile):
	New method to read a core file.

	* interfaces/ITargetNotification.cs (ITargetNotification): Added
	TargetExited event.
	(TargetState): Added CORE_FILE.

	* arch/CoreFile.cs: New abstract class to read core files.

	* arch/CoreFileElfI386.cs: Core file reader for ELF files on the i386.

	* frontends/gui/DebuggerGUI.cs (.ctor): Create the interpreter
	here since otherwise the `Quit' command won't work.
	(LoadProgram): HACK: if the first argument is `core' read a core
	file `thecore' in the current directory.

2002-09-19  Martin Baulig  <martin@gnome.org>

	* interfaces/ITargetNotification.cs: New file. Moved TargetState
	and ITargetNotification here.

	* interfaces/IInferior.cs: Put this into the Mono.Debugger.Backends
	namespace.

2002-09-19  Martin Baulig  <martin@gnome.org>

	* backends/Debugger.cs: Only dispose the current stack frame if it
	has actually changed.

2002-09-19  Martin Baulig  <martin@gnome.org>

	* interfaces/ITargetLocation.cs: Make this work again.

	* classes/TargetLocation.cs: This is now an abstract base class.

	* classes/TargetStackLocation.cs: New class to represent an
	address on the stack.

	* interfaces/IMethod.cs: Added HasMethodBounds, MethodStartAddress
	and MethodEndAddress.

	* interfaces/IStackFrame.cs: Added GetLocalVariableLocation and
	GetParameterLocation.

2002-09-18  Martin Baulig  <martin@gnome.org>

	* interface/IStackFrame.cs: Added FrameInvalid event.

	* interface/IDebuggerBackend.cs (IDebuggerBackend.GetBackTrace):
	Removed all arguments; this method will cache the return value and
	emit the FrameInvalid event on each of the returned frames.

	* interface/IInferior.cs (IInferior.GetBackTrace): Return an array
	of IInternalBackTrace's;  this is an internal interface and should
	not be used outside of Debugger.cs.

2002-09-18  Martin Baulig  <martin@gnome.org>

	* interface/IInferior.cs, IDebuggerBackend.cs: Added Stop() method.

2002-09-18  Martin Baulig  <martin@gnome.org>

	* interface/IArchitecture.cs: Made this interface public.

	* interface/IDebugerBackend.cs (IDebuggerBackend.Inferior): Removed
	this property, the IInferior interface is a private interface.
	You implement it when writing a new debugger backend, but it
	shouldn't be used outside of Debugger.cs.

2002-09-18  Martin Baulig  <martin@gnome.org>

	* interfaces/IDebuggerBackend.cs: Added properties to specify the
	application to debug, its command line arguments, environment and
	current working directory.

	* backend/Debugger.cs: The ctor no longer needs command line
	arguments and application name, they're set with the properties.

	* frontends/gui/DebuggerGUI.cs: Create a Debugger instance on
	startup and use the new properties to set the application.

2002-09-18  Martin Baulig  <martin@gnome.org>

	* frontends/gui/DebuggerGUI.cs (DebuggerGUI.LoadProgram): Call
	SetBackend() on the source_view.

2002-09-18  Martin Baulig  <martin@gnome.org>

	* class/ObjectCache.cs: New public class.  Keeps a hard reference
	to an object and transforms the hard reference into a weak
	reference after a timeout.

	* class/DwarfReader.cs, SymbolTable.cs, MethodBase.cs, MethodSource.cs:
	Use the new ObjectCache.

2002-09-18  Martin Baulig  <martin@gnome.org>

	* class/TargetException (TargetException): Made this abstract.

	* class/InternalError.cs: New exception class.

2002-09-18  Martin Baulig  <martin@gnome.org>

	* interfaces/ITargetMemoryAccess.cs (ITargetMemoryReader.BinaryReader):
	Return a TargetBinaryReader instead of a BinaryReader.

	* backends/debugger.cs (TargetReader): Derive from TargetBinaryReader.

	* class/TargetBinaryReader.cs: New public class.  Moved most of
	DwarfReader.DwarfBinaryReader's functionality here.  Implement the
	Mono.CSharp.Debugger.IMonoBinaryReader interface so that we can
	pass an instance of this class to the symbol reader.

	* backends/gdb/*: Removed, nothing useful there anymore.

2002-09-18  Miguel de Icaza  <miguel@ximian.com>

	* frontends/gui/DebuggerGUI.cs: Rework the bootstrap phase for the
	program, now it is posisble to specify the program and arguments
	from a dialog box, or to pass them on the command line.

	Now it guesses the kind of program (managed/unmanaged) without
	having to use the `native' prefix.

	Added a few more event hooks to the UI.

	* frontend/gui/Everything that depends on DebuggerWidget: It no
	longer takes a backend argument.  The backend is now configured by
	a SetBackend virtual method.  If you want to hook up to this, you
	have to override the method, and extend it.

	* frontend/gui/debugger.glade: New user interface similar to
	the VisualStudio debugger.

2002-09-17  Miguel de Icaza  <miguel@ximian.com>

	* frontends/gui/DebuggerGUI.cs: Use embeded debugger.glade
	resource instead of loading from the configuration data.

	* test/Makefile.in: Embed debugger.glade.

