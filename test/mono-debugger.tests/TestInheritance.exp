#!/usr/bin/expect -f
#

source $srcdir/mdb.exp

set file $srcdir/TestInheritance.cs
mdb_start "TestInheritance.exe"
mdb_expect_frame 0 "X.Main()" $file 119
mdb_send "break 123"
set breakpoint [mdb_expect_breakpoint]
mdb_send "continue"
mdb_expect_stopped 0 "X.Main()" $file 123
mdb_send "print d.Test ()"
mdb_expect "(System.String) \"Hello World\""
mdb_send "print a.Test ()"
mdb_expect "(System.String) \"Hello World\""
mdb_send "print a.ToString ()"
mdb_expect "(System.String) \"5\""
mdb_send "print (A) a"
mdb_expect "(A) { a = 5, Hello = \"Hello World\" }"
mdb_send "print (B) a"
mdb_expect "ERROR: Cannot cast from A to B."
mdb_send "print d"
mdb_expect "(D) { e = 500 }"
mdb_send "print (C) d"
mdb_expect "(C) { f = 3.14 }"
mdb_send "print (B) d"
mdb_expect "(B) { a = 8, Hello = \"Hello World\" }"
mdb_send "print (A) d"
mdb_expect "ERROR: Cannot cast from D to A."
mdb_send "print (D) d"
mdb_expect "(D) { e = 500 }"
mdb_send "print ((D) d)"
mdb_expect "(D) { e = 500 }"
mdb_send "print (((D) d))"
mdb_expect "(D) { e = 500 }"
mdb_send "print ((B) d).Test ()"
mdb_expect "(System.String) \"Hello World\""
mdb_send "print ((C) d).Test ()"
mdb_expect "(System.String) \"Hello World\""
mdb_send "print (((D) d).Test ())"
mdb_expect "(System.String) \"Hello World\""
mdb_send "print d.Hello ()"
mdb_expect "ERROR: Method `d.Hello ()' doesn't return a value."
mdb_send "print d.Virtual ()"
mdb_expect "(System.Int32) 2"
mdb_send "print ((C) d).Virtual ()"
mdb_expect "(System.Int32) 2"
mdb_send "print a.Hello"
mdb_expect "(System.String) \"Hello World\""
mdb_send "print a.Boston"
mdb_expect "(System.String) \"Boston\""
mdb_send "print a.StaticTest ()"
mdb_expect "(System.String) \"Boston\""
mdb_send "print a.Property"
mdb_expect "(System.String) \"Hello World\""
mdb_send "print a.StaticProperty"
mdb_expect "(System.String) \"Boston\""
mdb_send "print A.StaticTest ()"
mdb_expect "(System.String) \"Boston\""
mdb_send "print A.StaticProperty"
mdb_expect "(System.String) \"Boston\""
mdb_send "print ((B) d).Hello"
mdb_expect "(System.String) \"Hello World\""
mdb_send "print ((B) d).Boston"
mdb_expect "(System.String) \"Boston\""
mdb_send "print ((B) d).StaticTest ()"
mdb_expect "(System.String) \"Boston\""
mdb_send "print ((B) d).Property"
mdb_expect "(System.String) \"Hello World\""
mdb_send "print ((B) d).StaticProperty"
mdb_expect "(System.String) \"Boston\""
mdb_send "print B.StaticTest ()"
mdb_expect "(System.String) \"Boston\""
mdb_send "print B.StaticProperty"
mdb_expect "(System.String) \"Boston\""
mdb_send "break 90"
set breakpoint [mdb_expect_breakpoint]
mdb_send "continue"
mdb_expect_stopped 0 "C.Hello()" $file 90
mdb_send "print this"
mdb_expect "(C) { f = 3.14 }"
mdb_send "print f"
mdb_expect "(System.Single) 3.14"
mdb_send "print base.a"
mdb_expect "(System.Int32) 8"
mdb_send "print base.Hello"
mdb_expect "(System.String) \"Hello World\""
mdb_send "print base.Boston"
mdb_expect "(System.String) \"Boston\""
mdb_send "print Virtual ()"
mdb_expect "(System.Int32) 2"
mdb_send "continue"
mdb_expect_line "Process @4 terminated normally."
mdb_expect_prompt
mdb_send "quit"
