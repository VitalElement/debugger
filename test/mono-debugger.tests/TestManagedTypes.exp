#!/usr/bin/expect -f
#

source $srcdir/mdb.exp

set file $srcdir/TestManagedTypes.cs
mdb_start "TestManagedTypes.exe"
mdb_expect_frame 0 "X.Main()" $file 218
mdb_send "break 120"
set breakpoint [mdb_expect_breakpoint]
mdb_send "continue"
mdb_expect_stopped 0 "X.Simple()" $file 120
mdb_send "dump -mode object a"
mdb_expect "object:True:-1:System.Int32:True:4:Fundamental System.Int32"
mdb_send "ptype a"
mdb_expect "System.Int32"
mdb_send "print a"
mdb_expect "(System.Int32) 5"
mdb_send "dump -mode object b"
mdb_expect "object:True:-1:System.Int64:True:8:Fundamental System.Int64"
mdb_send "ptype b"
mdb_expect "System.Int64"
mdb_send "print b"
mdb_expect "(System.Int64) 7"
mdb_send "dump -mode object f"
mdb_expect "object:True:-1:System.Single:True:4:Fundamental System.Single"
mdb_send "ptype f"
mdb_expect "System.Single"
mdb_send "print f"
mdb_expect "(System.Single) 0.7142857"
# mdb_send "dump -mode object hello"
# mdb_expect "object:True:22:System.String:False:16:Fundamental System.String"
mdb_send "ptype hello"
mdb_expect "System.String"
mdb_send "print hello"
mdb_expect "(System.String) \"Hello World\""
mdb_send "continue"
mdb_expect_line "5"
mdb_expect_line "7"
mdb_expect_line "0.7142857"
mdb_expect_line "Hello World"
mdb_expect_line "5"
mdb_expect_line "5"
mdb_expect_line "Hello World"
mdb_expect_line "Hello World"
mdb_expect_line "5"
mdb_expect_line "11"
mdb_expect_line "System.String\[\]"
mdb_expect_line "System.String\[,\]"
mdb_expect_line "51.2"
mdb_expect_line "Hello World"
mdb_expect_line "A"
mdb_expect_line "5"
mdb_expect_line "3.14"
mdb_expect_line "B"
mdb_expect_line "8"
mdb_expect_line "5"
mdb_expect_line "Eintracht Trier"
mdb_expect_line "9"
mdb_expect_prompt
mdb_send "quit"
