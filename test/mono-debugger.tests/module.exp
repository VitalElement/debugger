#!/usr/bin/expect -f
#

load_lib mdb.exp

set file [pwd]/module.c
set foo [pwd]/foo.c

mdb_start "module" "main"
mdb_expect_frame 0 "main" $file 11
mdb_send "library [pwd]/libfoo.so"
mdb_expect "Loaded library [pwd]/libfoo.so."
# FIXME: Wait until the debugger reloaded the symtabs
sleep 5
mdb_send "break hello"
mdb_expect_breakpoint
mdb_send "continue"
mdb_expect_stopped 0 "hello" $foo 9
